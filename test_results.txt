
> schach9x9@1.0.0 test
> vitest --run


[1m[46m RUN [49m[22m [36mv4.0.17 [39m[90m/home/tobber/.gemini/antigravity/scratch/schach[39m

 [31mâ¯[39m tests/modes/campaignMode.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 29[2mms[22m[39m
       [32mâœ“[39m should warn if no currentLevelId is set[32m 8[2mms[22m[39m
       [32mâœ“[39m should not warn if currentLevelId is set[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle level not found[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should setup level_1 with fixed board[39m[32m 8[2mms[22m[39m
[31m       [31mÃ—[31m should setup level_2 with fixed board[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should setup budget level with setup phase[32m 1[2mms[22m[39m
       [32mâœ“[39m should show intro modal with level info[32m 2[2mms[22m[39m
       [32mâœ“[39m should delegate to setupStrategy for budget levels[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle play phase for fixed levels[32m 0[2mms[22m[39m
       [32mâœ“[39m should return false for unknown levels[32m 0[2mms[22m[39m
       [32mâœ“[39m should return false if handlePlayClick is missing[32m 0[2mms[22m[39m
       [32mâœ“[39m should delegate to setupStrategy for budget levels[32m 0[2mms[22m[39m
       [32mâœ“[39m should do nothing for fixed levels[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle unknown levels gracefully[32m 0[2mms[22m[39m
 [31mâ¯[39m tests/analysis.test.js [2m([22m[2m6 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 18[2mms[22m[39m
     [32mâœ“[39m should toggle states correctly[32m 3[2mms[22m[39m
[31m     [31mÃ—[31m should generate threat arrows correctly[39m[32m 6[2mms[22m[39m
     [32mâœ“[39m should generate best move arrow correctly[32m 2[2mms[22m[39m
[31m     [31mÃ—[31m should only show serious threats[39m[32m 3[2mms[22m[39m
     [32mâœ“[39m should generate opportunity arrows for high severity patterns (fork)[32m 2[2mms[22m[39m
     [32mâœ“[39m should generate opportunity arrows for high severity patterns (pin)[32m 1[2mms[22m[39m
[90mstdout[2m | tests/controllers.coverage.test.js
[22m[39m[INFO] 17:59:35.258 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould initialize correctly
[22m[39m[INFO] 17:59:35.451 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould initialize correctly
[22m[39m[INFO] 17:59:35.453 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould initialize correctly
[22m[39m[INFO] 17:59:35.498 3D skin changed to: classic
[INFO] 17:59:35.498 3D scene setup complete

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle init failure with zero dimensions
[22m[39m[INFO] 17:59:35.590 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle init failure with zero dimensions
[22m[39m[INFO] 17:59:35.591 Setting up 3D scene...
[ERROR] 17:59:35.592 Container has zero dimensions!

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould boardToWorld correctly
[22m[39m[INFO] 17:59:35.701 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/moveController.test.js[2m > [22m[2mMoveController[2m > [22m[2mshould handle promotion
[22m[39m[MoveExecutor] Triggering Promotion UI

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould updateFromGameState
[22m[39m[INFO] 17:59:35.780 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mtickClock should handle white timeout
[22m[39m[INFO] 17:59:35.801 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould updateFromGameState
[22m[39m[INFO] 17:59:35.782 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould updateFromGameState
[22m[39m[INFO] 17:59:35.803 3D skin changed to: classic
[INFO] 17:59:35.803 3D scene setup complete

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould updateFromGameState
[22m[39m[DEBUG] 17:59:35.804 [PieceManager3D] updateFromGameState started
[DEBUG] 17:59:35.804 [PieceManager3D] Existing pieces cleared
[INFO] 17:59:35.804 [PieceManager3D] Created 1 pieces in 0.21ms

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mtickClock should handle white timeout
[22m[39m[WARN] 17:59:35.808 Game start time not set, skipping statistics save

[90mstdout[2m | tests/moveController.test.js[2m > [22m[2mMoveController[2m > [22m[2mshould correctly undo promotion
[22m[39m[MoveExecutor] Triggering Promotion UI

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould highlightMoves
[22m[39m[INFO] 17:59:35.884 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould highlightMoves
[22m[39m[INFO] 17:59:35.886 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould highlightMoves
[22m[39m[INFO] 17:59:35.904 3D skin changed to: classic
[INFO] 17:59:35.905 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mtickClock should handle black timeout
[22m[39m[INFO] 17:59:35.923 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mtickClock should handle black timeout
[22m[39m[WARN] 17:59:35.924 Game start time not set, skipping statistics save

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould toggle enabled state
[22m[39m[INFO] 17:59:35.980 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould toggle enabled state
[22m[39m[INFO] 17:59:35.983 Setting up 3D scene...
[INFO] 17:59:36.021 3D mode enabled
[INFO] 17:59:36.022 3D mode disabled
[INFO] 17:59:36.022 3D skin changed to: classic
[INFO] 17:59:36.022 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mresign should handle black resigning
[22m[39m[INFO] 17:59:36.029 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mresign should handle black resigning
[22m[39m[WARN] 17:59:36.031 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould dispose correctly
[22m[39m[INFO] 17:59:36.100 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould dispose correctly
[22m[39m[INFO] 17:59:36.105 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould dispose correctly
[22m[39m[INFO] 17:59:36.120 3D skin changed to: classic
[INFO] 17:59:36.120 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mhandleCellClick should do nothing in GAME_OVER
[22m[39m[INFO] 17:59:36.119 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mhandleCellClick should do nothing in GAME_OVER
[22m[39m[GameController] handleCellClick called: row=0, col=0, phase=GAME_OVER

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mofferDraw should handle human offer
[22m[39m[INFO] 17:59:36.196 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould setTheme
[22m[39m[INFO] 17:59:36.212 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould setTheme
[22m[39m[INFO] 17:59:36.216 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould setTheme
[22m[39m[INFO] 17:59:36.228 3D skin changed to: classic
[INFO] 17:59:36.229 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2macceptDraw should end game
[22m[39m[INFO] 17:59:36.269 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2macceptDraw should end game
[22m[39m[WARN] 17:59:36.271 Game start time not set, skipping statistics save

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould setSkin
[22m[39m[INFO] 17:59:36.330 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould setSkin
[22m[39m[INFO] 17:59:36.334 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould setSkin
[22m[39m[INFO] 17:59:36.346 3D skin changed to: classic
[INFO] 17:59:36.347 3D scene setup complete

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould setSkin
[22m[39m[INFO] 17:59:36.347 3D skin changed to: neon

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2msaveGame should call storageManager
[22m[39m[INFO] 17:59:36.353 StatisticsManager initialized

[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints[2m > [22m[2mshould return empty array when no legal moves
[22m[39m[INFO] 17:59:36.420 [WasmBridge] Initializing Wasm AI Engine...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould animateMove
[22m[39m[INFO] 17:59:36.418 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould animateMove
[22m[39m[INFO] 17:59:36.423 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould animateMove
[22m[39m[INFO] 17:59:36.438 3D skin changed to: neon
[INFO] 17:59:36.438 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mGameController[2m > [22m[2mloadGame should handle successful load
[22m[39m[INFO] 17:59:36.449 StatisticsManager initialized

[90mstderr[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints[2m > [22m[2mshould return empty array when no legal moves
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle onClick
[22m[39m[INFO] 17:59:36.507 [3D] BattleChess3D instance created (Modular)

 [31mâ¯[39m tests/snapshots.test.js [2m([22m[2m4 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 1100[2mms[22m[39m
[31m     [31mÃ—[31m Initial setup phase snapshot[39m[33m 485[2mms[22m[39m
     [33m[2mâœ“[22m[39m Play phase board snapshot [33m 403[2mms[22m[39m
[31m     [31mÃ—[31m Game over overlay snapshot[39m[32m 97[2mms[22m[39m
[31m     [31mÃ—[31m Shop panel snapshot[39m[32m 112[2mms[22m[39m
[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints[2m > [22m[2mshould return empty array when no legal moves
[22m[39m[INFO] 17:59:36.524 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle onClick
[22m[39m[INFO] 17:59:36.515 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle onClick
[22m[39m[INFO] 17:59:36.527 3D skin changed to: neon
[INFO] 17:59:36.527 3D scene setup complete

[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints[2m > [22m[2mshould return empty array when no legal moves
[22m[39m[DEBUG] 17:59:36.530 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2maiEvaluateDrawOffer should accept if losing
[22m[39m[INFO] 17:59:36.544 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2maiShouldOfferDraw should return true if slightly losing
[22m[39m[INFO] 17:59:36.627 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle onWindowResize
[22m[39m[INFO] 17:59:36.644 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle onWindowResize
[22m[39m[INFO] 17:59:36.649 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould handle onWindowResize
[22m[39m[INFO] 17:59:36.665 3D skin changed to: neon
[INFO] 17:59:36.665 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2maiShouldResign should return true if losing badly
[22m[39m[INFO] 17:59:36.694 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould playBattleSequence
[22m[39m[INFO] 17:59:36.738 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2manalyzePosition should create worker and send message
[22m[39m[INFO] 17:59:36.749 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2manalyzePosition should create worker and send message
[22m[39m[DEBUG] 17:59:36.751 [AI] Initializing pool with 4 workers

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2manalyzePosition should create worker and send message
[22m[39m[INFO] 17:59:36.759 [AIController] Opening book loaded successfully. Positions: 0

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould playBattleSequence
[22m[39m[INFO] 17:59:36.745 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould playBattleSequence
[22m[39m[INFO] 17:59:36.784 3D skin changed to: neon
[INFO] 17:59:36.785 3D scene setup complete

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould playBattleSequence
[22m[39m[INFO] 17:59:36.785 Playing battle sequence: q vs p

[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints[2m > [22m[2mshould return hints for positions with pieces
[22m[39m[DEBUG] 17:59:36.813 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2maiMove should evaluate draw offer if pending
[22m[39m[INFO] 17:59:36.863 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mAIController[2m > [22m[2maiMove should evaluate draw offer if pending
[22m[39m[INFO] 17:59:36.866 [AI] Starting aiMove...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set camera
[22m[39m[INFO] 17:59:36.916 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mTutorController[2m > [22m[2mcheckBlunder should trigger modal on large eval drop
[22m[39m[INFO] 17:59:36.922 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set camera
[22m[39m[INFO] 17:59:36.923 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set camera
[22m[39m[INFO] 17:59:36.936 3D skin changed to: neon
[INFO] 17:59:36.937 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mTutorController[2m > [22m[2mdetectTacticalPatterns should detect fork
[22m[39m[INFO] 17:59:36.976 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set renderer
[22m[39m[INFO] 17:59:36.989 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set renderer
[22m[39m[INFO] 17:59:36.995 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set renderer
[22m[39m[INFO] 17:59:37.008 3D skin changed to: neon
[INFO] 17:59:37.008 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mTutorController[2m > [22m[2mdetectPins should identify a pinned piece
[22m[39m[INFO] 17:59:37.048 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set controls
[22m[39m[INFO] 17:59:37.065 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints[2m > [22m[2mshould include move notation in hints
[22m[39m[DEBUG] 17:59:37.073 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set controls
[22m[39m[INFO] 17:59:37.073 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set controls
[22m[39m[INFO] 17:59:37.085 3D skin changed to: neon
[INFO] 17:59:37.085 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mTutorController[2m > [22m[2manalyzeStrategicValue should detect center control
[22m[39m[INFO] 17:59:37.152 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set battleAnimator
[22m[39m[INFO] 17:59:37.152 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set battleAnimator
[22m[39m[INFO] 17:59:37.160 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set battleAnimator
[22m[39m[INFO] 17:59:37.174 3D skin changed to: neon
[INFO] 17:59:37.174 3D scene setup complete

[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints[2m > [22m[2mshould prioritize capture moves
[22m[39m[DEBUG] 17:59:37.206 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should transition from WHITE_PIECES to WHITE_UPGRADES
[22m[39m[INFO] 17:59:37.227 StatisticsManager initialized

[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints - Advanced Scenarios[2m > [22m[2mshould handle checkmate position
[22m[39m[DEBUG] 17:59:37.246 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set pieces
[22m[39m[INFO] 17:59:37.255 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set pieces
[22m[39m[INFO] 17:59:37.262 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set pieces
[22m[39m[INFO] 17:59:37.271 3D skin changed to: neon
[INFO] 17:59:37.272 3D scene setup complete

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set currentSkin
[22m[39m[INFO] 17:59:37.327 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set currentSkin
[22m[39m[INFO] 17:59:37.335 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set currentSkin
[22m[39m[INFO] 17:59:37.346 3D skin changed to: neon
[INFO] 17:59:37.346 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should transition from WHITE_PIECES to WHITE_UPGRADES
[22m[39m[INFO] 17:59:37.229 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:37.436 Game initialized with [33m25[39m points in mode: setup

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set currentTheme
[22m[39m[INFO] 17:59:37.420 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set currentTheme
[22m[39m[INFO] 17:59:37.450 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould set currentTheme
[22m[39m[INFO] 17:59:37.468 3D skin changed to: neon
[INFO] 17:59:37.469 3D scene setup complete

 [32mâœ“[39m tests/tutorial.test.js [2m([22m[2m28 tests[22m[2m)[22m[33m 2278[2mms[22m[39m
[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould toggle with existing scene (re-enable)
[22m[39m[INFO] 17:59:37.532 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould toggle with existing scene (re-enable)
[22m[39m[INFO] 17:59:37.543 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould toggle with existing scene (re-enable)
[22m[39m[INFO] 17:59:37.554 3D skin changed to: neon
[INFO] 17:59:37.554 3D scene setup complete

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould toggle with existing scene (re-enable)
[22m[39m[INFO] 17:59:37.554 3D mode disabled
[INFO] 17:59:37.554 3D mode enabled

[90mstdout[2m | tests/moveController.test.js[2m > [22m[2mMoveController[2m > [22m[2mSave and Load Game[2m > [22m[2mshould successfully load a saved game
[22m[39mTest Verify: {"board":[[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null]],"phase":"PLAY","turn":"black","points":{"white":10,"black":10},"moveHistory":[],"capturedPieces":{"white":[],"black":[]},"isAI":false,"difficulty":"medium"}

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should transition from WHITE_UPGRADES to BLACK_PIECES in setup mode
[22m[39m[INFO] 17:59:37.571 StatisticsManager initialized

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould clear highlights
[22m[39m[INFO] 17:59:37.610 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould clear highlights
[22m[39m[INFO] 17:59:37.623 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould clear highlights
[22m[39m[INFO] 17:59:37.644 3D skin changed to: neon
[INFO] 17:59:37.644 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should transition from WHITE_UPGRADES to BLACK_PIECES in setup mode
[22m[39m[INFO] 17:59:37.574 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:37.688 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould add and remove pieces
[22m[39m[INFO] 17:59:37.708 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould add and remove pieces
[22m[39m[INFO] 17:59:37.732 Setting up 3D scene...

[90mstdout[2m | tests/battleChess3D.boost.test.js[2m > [22m[2mBattleChess3D Class[2m > [22m[2mshould add and remove pieces
[22m[39m[INFO] 17:59:37.742 3D skin changed to: neon
[INFO] 17:59:37.743 3D scene setup complete

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should transition from WHITE_UPGRADES to BLACK_UPGRADES in upgrade mode
[22m[39m[INFO] 17:59:37.748 StatisticsManager initialized

 [32mâœ“[39m tests/battleChess3D.boost.test.js [2m([22m[2m23 tests[22m[2m)[22m[33m 2504[2mms[22m[39m
[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should transition from WHITE_UPGRADES to BLACK_UPGRADES in upgrade mode
[22m[39m[INFO] 17:59:37.749 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:37.835 Game initialized with [33m25[39m points in mode: upgrade

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should show modal if points remains
[22m[39m[INFO] 17:59:37.892 StatisticsManager initialized

[90mstdout[2m | tests/controllers.coverage.test.js[2m > [22m[2mControllers Coverage Expansion[2m > [22m[2mPhase Transitions[2m > [22m[2mfinishSetupPhase should show modal if points remains
[22m[39m[INFO] 17:59:37.896 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:37.940 Game initialized with [33m25[39m points in mode: setup

[90mstdout[2m | tests/boardRenderer.unit.test.js[2m > [22m[2mBoardRenderer Full Coverage[2m > [22m[2mInteraction: Click calls handleCellClick
[22m[39m[BoardRenderer] Cell click: row=0, col=0, phase=play

 [32mâœ“[39m tests/controllers.coverage.test.js [2m([22m[2m21 tests[22m[2m)[22m[33m 2391[2mms[22m[39m
[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints - Advanced Scenarios[2m > [22m[2mshould limit hints to maximum of 3
[22m[39m[DEBUG] 17:59:38.221 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/tutorController.test.js[2m > [22m[2mTutorController[2m > [22m[2mgetTutorHints - Advanced Scenarios[2m > [22m[2mshould properly evaluate tactical moves
[22m[39m[DEBUG] 17:59:38.365 [AiEngine] Using Wasm Engine Result (Main Thread)

 [32mâœ“[39m tests/ui.test.js [2m([22m[2m10 tests[22m[2m)[22m[33m 2262[2mms[22m[39m
       [33m[2mâœ“[22m[39m should initialize board with coordinate labels [33m 419[2mms[22m[39m
       [33m[2mâœ“[22m[39m should highlight selectable corridors in setup phase [33m 509[2mms[22m[39m
       [33m[2mâœ“[22m[39m should highlight threatened pieces [33m 396[2mms[22m[39m
       [33m[2mâœ“[22m[39m should show promotion UI and handle choice [33m 392[2mms[22m[39m
[90mstdout[2m | tests/tutorController.test.js
[22m[39m[DEBUG] 17:59:38.646 [AiEngine] Using Wasm Engine Result (Main Thread)

 [32mâœ“[39m tests/tutorController.test.js [2m([22m[2m37 tests[22m[2m)[22m[33m 1960[2mms[22m[39m
       [33m[2mâœ“[22m[39m should limit hints to maximum of 3 [33m 974[2mms[22m[39m
[90mstdout[2m | tests/coverage-boost.test.js[2m > [22m[2mCoverage Boost Tests[2m > [22m[2mUI Modals and Toasts[2m > [22m[2mshowModal and closeModal should interact with DOM
[22m[39m[OverlayManager] Showing modal: Title
[OverlayManager] Modal visibility set to flex
[OverlayManager] Modal closed
[OverlayManager] Modal closed

 [32mâœ“[39m tests/boardRenderer.unit.test.js [2m([22m[2m17 tests[22m[2m)[22m[33m 1189[2mms[22m[39m
     [33m[2mâœ“[22m[39m renderBoard highlights [33m 353[2mms[22m[39m
[90mstdout[2m | tests/gameFlow.integration.test.js
[22m[39m[INFO] 17:59:39.112 StatisticsManager initialized

[90mstderr[2m | tests/moveController.test.js[2m > [22m[2mMoveController[2m > [22m[2mLoad Game[2m > [22m[2mshould handle corrupt save data
[22m[39mFehler beim Laden: SyntaxError: Unexpected token 'i', "invalid-json" is not valid JSON
    at JSON.parse (<anonymous>)
    at Module.loadGame [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/move/GameStateManager.ts:307:24[90m)[39m
    at MoveController.loadGame [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/moveController.ts:232:38[90m)[39m
    at [90m/home/tobber/.gemini/antigravity/scratch/schach/[39mtests/moveController.test.js:1065:38
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mAuto-Save Trigger Integration[2m > [22m[2mshould trigger save exactly every 5 moves
[22m[39m[INFO] 17:59:39.401 StatisticsManager initialized

[90mstdout[2m | tests/coverage-boost.test.js[2m > [22m[2mCoverage Boost Tests[2m > [22m[2mfinishSetupPhase should cycle through setup stages
[22m[39m[INFO] 17:59:39.159 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:39.160 Game initialized with [33m15[39m points in mode: setup
[DEBUG] 17:59:39.384 Removed all corridor highlighting for PLAY phase

[90mstdout[2m | tests/coverage-boost.test.js[2m > [22m[2mCoverage Boost Tests[2m > [22m[2mGameController edge cases and additional features[2m > [22m[2mtickClock should handle timeout for white
[22m[39m[WARN] 17:59:39.532 Game start time not set, skipping statistics save

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mAuto-Save Trigger Integration[2m > [22m[2mshould trigger save exactly every 5 moves
[22m[39m[INFO] 17:59:39.560 [Storage] Game saved to schach9x9_save_autosave (3022 bytes)

[90mstdout[2m | tests/coverage-boost.test.js[2m > [22m[2mCoverage Boost Tests[2m > [22m[2mGameController edge cases and additional features[2m > [22m[2mresign should end game
[22m[39m[WARN] 17:59:39.567 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'black'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

[90mstdout[2m | tests/coverage-boost.test.js[2m > [22m[2mCoverage Boost Tests[2m > [22m[2mGameController edge cases and additional features[2m > [22m[2mofferDraw, acceptDraw, declineDraw
[22m[39m[WARN] 17:59:39.604 Game start time not set, skipping statistics save

 [32mâœ“[39m tests/moveController.test.js [2m([22m[2m59 tests[22m[2m)[22m[33m 4260[2mms[22m[39m
[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mAuto-Save Trigger Integration[2m > [22m[2mshould trigger save exactly every 5 moves
[22m[39m[INFO] 17:59:39.624 [Storage] Game saved to schach9x9_save_autosave (3737 bytes)

[90mstdout[2m | tests/coverage-boost.test.js[2m > [22m[2mCoverage Boost Tests[2m > [22m[2mGameController edge cases and additional features[2m > [22m[2msaveGameToStatistics outcomes
[22m[39m[INFO] 17:59:39.657 Game saved to statistics: win vs AI-Schwer
[INFO] 17:59:39.658 Game saved to statistics: loss vs AI-Schwer

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mSpecial Moves Integration[2m > [22m[2mshould handle castling and update state correctly
[22m[39m[INFO] 17:59:39.723 StatisticsManager initialized

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mSpecial Moves Integration[2m > [22m[2mshould handle pawn promotion through UI flow
[22m[39m[INFO] 17:59:39.836 StatisticsManager initialized

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mSpecial Moves Integration[2m > [22m[2mshould handle pawn promotion through UI flow
[22m[39m[MoveExecutor] Triggering Promotion UI

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mSpecial Moves Integration[2m > [22m[2mshould handle pawn promotion through UI flow
[22m[39m[WARN] 17:59:39.850 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

[90mstdout[2m | tests/coverage-boost.test.js[2m > [22m[2mCoverage Boost Tests[2m > [22m[2mGameController edge cases and additional features[2m > [22m[2minitGame should setup initial state
[22m[39m[INFO] 17:59:39.889 SetupModeStrategy initialized with [33m20[39m points
[INFO] 17:59:39.889 Game initialized with [33m20[39m points in mode: setup

 [32mâœ“[39m tests/coverage-boost.test.js [2m([22m[2m20 tests[22m[2m)[22m[33m 1161[2mms[22m[39m
     [33m[2mâœ“[22m[39m finishSetupPhase should cycle through setup stages [33m 547[2mms[22m[39m
 [32mâœ“[39m tests/keyboard.test.js [2m([22m[2m8 tests[22m[2m)[22m[33m 899[2mms[22m[39m
[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mPuzzle Mode Lifecycle[2m > [22m[2mshould transition to puzzle mode and solve a simple puzzle
[22m[39m[INFO] 17:59:39.951 StatisticsManager initialized

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mPuzzle Mode Lifecycle[2m > [22m[2mshould transition to puzzle mode and solve a simple puzzle
[22m[39m[WARN] 17:59:40.016 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mSpecial Pieces Integration[2m > [22m[2mshould allow Chancellor (C) to move like Rook + Knight
[22m[39m[INFO] 17:59:40.087 StatisticsManager initialized

[90mstdout[2m | tests/fullGame.test.js
[22m[39m[INFO] 17:59:40.109 StatisticsManager initialized

[90mstdout[2m | tests/gameFlow.integration.test.js[2m > [22m[2mComprehensive Game Flow Integration Tests[2m > [22m[2mSpecial Pieces Integration[2m > [22m[2mshould allow Archbishop (A) to move like Bishop + Knight
[22m[39m[INFO] 17:59:40.193 StatisticsManager initialized

 [32mâœ“[39m tests/gameFlow.integration.test.js [2m([22m[2m6 tests[22m[2m)[22m[33m 1049[2mms[22m[39m
       [33m[2mâœ“[22m[39m should trigger save exactly every 5 moves [33m 449[2mms[22m[39m
 [32mâœ“[39m tests/puzzleGenerator.test.js [2m([22m[2m3 tests[22m[2m)[22m[33m 813[2mms[22m[39m
     [33m[2mâœ“[22m[39m should find Mate in 2 [33m 802[2mms[22m[39m
[90mstdout[2m | tests/fullGame.test.js[2m > [22m[2mFull-Game Integration Test[2m > [22m[2mSetup phase transitions and initial move
[22m[39m[INFO] 17:59:40.451 StatisticsManager initialized
[INFO] 17:59:40.453 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:40.611 Game initialized with [33m15[39m points in mode: setup

 [32mâœ“[39m tests/tutorial.full.test.js [2m([22m[2m8 tests[22m[2m)[22m[33m 870[2mms[22m[39m
[90mstdout[2m | tests/fullGame.test.js[2m > [22m[2mFull-Game Integration Test[2m > [22m[2mSetup phase transitions and initial move
[22m[39m[GameController] handleCellClick called: row=8, col=4, phase=SETUP_WHITE_KING
[SetupMode] Placing King
[GameController] handleCellClick called: row=0, col=4, phase=SETUP_BLACK_KING
[GameController] handleCellClick called: row=6, col=4, phase=SETUP_WHITE_PIECES
[GameController] handleCellClick called: row=6, col=6, phase=SETUP_WHITE_PIECES
[GameController] handleCellClick called: row=6, col=5, phase=SETUP_WHITE_PIECES
[GameController] handleCellClick called: row=8, col=4, phase=PLAY
[GameController] handleCellClick called: row=6, col=4, phase=PLAY
[GameController] handleCellClick called: row=6, col=5, phase=PLAY
[GameController] handleCellClick called: row=6, col=4, phase=PLAY
[GameController] handleCellClick called: row=5, col=4, phase=PLAY

[90mstdout[2m | tests/fullGame.test.js[2m > [22m[2mFull-Game Integration Test[2m > [22m[2mSetup phase transitions and initial move
[22m[39m[INFO] 17:59:40.677 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/fullGame.test.js[2m > [22m[2mFull-Game Integration Test[2m > [22m[2mSetup phase transitions and initial move
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/fullGame.test.js[2m > [22m[2mFull-Game Integration Test[2m > [22m[2mSetup phase transitions and initial move
[22m[39m[INFO] 17:59:40.723 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/fullGame.test.js[2m > [22m[2mFull-Game Integration Test[2m > [22m[2mResignation flow in mid-game
[22m[39m[INFO] 17:59:40.878 StatisticsManager initialized
[INFO] 17:59:40.879 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:40.967 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/fullGame.test.js[2m > [22m[2mFull-Game Integration Test[2m > [22m[2mResignation flow in mid-game
[22m[39m[WARN] 17:59:40.970 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'black'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

 [32mâœ“[39m tests/fullGame.test.js [2m([22m[2m2 tests[22m[2m)[22m[33m 806[2mms[22m[39m
     [33m[2mâœ“[22m[39m Setup phase transitions and initial move [33m 563[2mms[22m[39m
[90mstdout[2m | tests/ui/TutorUI.test.js[2m > [22m[2mTutorUI Component[2m > [22m[2mshowTutorSuggestions[2m > [22m[2mshould log in overlay mode if no hints available
[22m[39m[TutorUI] No hints available yet.

 [32mâœ“[39m tests/ui/AnalysisUI.test.js [2m([22m[2m8 tests[22m[2m)[22m[33m 802[2mms[22m[39m
[90mstdout[2m | tests/domHandler.test.js[2m > [22m[2mDOMHandler[2m > [22m[2mshould initialize and wire up points selection
[22m[39m[DOMHandler] Clicked points button: HTMLButtonElement {
  [32mSymbol(SameObject caches)[39m: [Object: null prototype] {
    classList: DOMTokenList {},
    dataset: DOMStringMap {}
  }
} Points: 15
[DOMHandler] Overlay hidden

 [32mâœ“[39m tests/ui/BoardRenderer.test.js [2m([22m[2m4 tests[22m[2m)[22m[33m 523[2mms[22m[39m
     [33m[2mâœ“[22m[39m should initialize and render board correctly [33m 311[2mms[22m[39m
 [32mâœ“[39m tests/ui/TutorUI.test.js [2m([22m[2m23 tests[22m[2m)[22m[33m 562[2mms[22m[39m
 [32mâœ“[39m tests/domHandler.test.js [2m([22m[2m32 tests[22m[2m)[22m[33m 599[2mms[22m[39m
 [32mâœ“[39m tests/ui.advanced.test.js [2m([22m[2m10 tests[22m[2m)[22m[33m 518[2mms[22m[39m
 [32mâœ“[39m tests/effects.test.js [2m([22m[2m5 tests[22m[2m)[22m[33m 433[2mms[22m[39m
 [32mâœ“[39m tests/ui.settings.test.js [2m([22m[2m2 tests[22m[2m)[22m[33m 521[2mms[22m[39m
     [33m[2mâœ“[22m[39m Skin selector should update skin and force render [33m 395[2mms[22m[39m
[90mstdout[2m | tests/scenarios/gameplay.test.js
[22m[39m[INFO] 17:59:42.833 StatisticsManager initialized

[90mstdout[2m | tests/fuzz/fuzz.test.ts[2m > [22m[2mRules Engine Fuzz Test[2m > [22m[2mshould run 500 random moves without inconsistency
[22m[39mStarting Fuzz Test: 500 iterations
Fuzz Test complete: No inconsistencies found.

 [32mâœ“[39m tests/fuzz/fuzz.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 486[2mms[22m[39m
     [33m[2mâœ“[22m[39m should run 500 random moves without inconsistency [33m 484[2mms[22m[39m
 [32mâœ“[39m tests/boardRenderer.isolated.test.js [2m([22m[2m1 test[22m[2m)[22m[33m 419[2mms[22m[39m
     [33m[2mâœ“[22m[39m touch events find piece-svg [33m 416[2mms[22m[39m
[90mstdout[2m | tests/scenarios/gameplay.test.js[2m > [22m[2mGameplay Scenarios[2m > [22m[2mMock Game Sequence: Scholar Mate attempt
[22m[39m[INFO] 17:59:42.908 StatisticsManager initialized
[INFO] 17:59:42.910 ClassicModeStrategy initialized
[INFO] 17:59:43.332 Game initialized with [33m10[39m points in mode: classic

[90mstdout[2m | tests/gameController.test.js
[22m[39m[INFO] 17:59:43.344 StatisticsManager initialized

[90mstdout[2m | tests/scenarios/gameplay.test.js[2m > [22m[2mGameplay Scenarios[2m > [22m[2mMock Game Sequence: Scholar Mate attempt
[22m[39m[GameController] handleCellClick called: row=7, col=4, phase=PLAY
[GameController] handleCellClick called: row=5, col=4, phase=PLAY

[90mstdout[2m | tests/scenarios/gameplay.test.js[2m > [22m[2mGameplay Scenarios[2m > [22m[2mMock Game Sequence: Scholar Mate attempt
[22m[39m[INFO] 17:59:43.348 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/scenarios/gameplay.test.js[2m > [22m[2mGameplay Scenarios[2m > [22m[2mMock Game Sequence: Scholar Mate attempt
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/scenarios/gameplay.test.js[2m > [22m[2mGameplay Scenarios[2m > [22m[2mMock Game Sequence: Scholar Mate attempt
[22m[39m[INFO] 17:59:43.404 [WasmBridge] Wasm AI Engine initialized successfully.

 [32mâœ“[39m tests/scenarios/gameplay.test.js [2m([22m[2m1 test[22m[2m)[22m[33m 533[2mms[22m[39m
     [33m[2mâœ“[22m[39m Mock Game Sequence: Scholar Mate attempt [33m 529[2mms[22m[39m
[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mGeneral Logic and Statistics[2m > [22m[2mshould save game statistics on game over
[22m[39m[INFO] 17:59:43.486 StatisticsManager initialized
[INFO] 17:59:43.489 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.489 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mGeneral Logic and Statistics[2m > [22m[2mshould save game statistics on game over
[22m[39m[DEBUG] 17:59:43.491 Game history saved to storage
[INFO] 17:59:43.491 Game saved: win vs AI-Mittel (0 moves)
[INFO] 17:59:43.491 Game saved to statistics: win vs AI-Mittel

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mGeneral Logic and Statistics[2m > [22m[2mshould skip statistics if gameStartTime not set
[22m[39m[INFO] 17:59:43.492 StatisticsManager initialized
[INFO] 17:59:43.497 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.497 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mGeneral Logic and Statistics[2m > [22m[2mshould skip statistics if gameStartTime not set
[22m[39m[WARN] 17:59:43.500 Game start time not set, skipping statistics save

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mGeneral Logic and Statistics[2m > [22m[2mshould handle corridor placement calculation
[22m[39m[INFO] 17:59:43.502 StatisticsManager initialized
[INFO] 17:59:43.506 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.506 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mKing Placement[2m > [22m[2mshould place white king in valid corridor
[22m[39m[INFO] 17:59:43.512 StatisticsManager initialized
[INFO] 17:59:43.518 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.518 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mKing Placement[2m > [22m[2mshould reject king placement outside corridor
[22m[39m[INFO] 17:59:43.521 StatisticsManager initialized
[INFO] 17:59:43.526 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.526 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mShop and Piece Management[2m > [22m[2mshould select piece if player has enough points
[22m[39m[INFO] 17:59:43.530 StatisticsManager initialized
[INFO] 17:59:43.538 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.538 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mShop and Piece Management[2m > [22m[2mshould refund points when removing piece from corridor
[22m[39m[INFO] 17:59:43.544 StatisticsManager initialized
[INFO] 17:59:43.549 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.549 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mShop and Piece Management[2m > [22m[2mshould clear selectedShopPiece after placing a piece
[22m[39m[INFO] 17:59:43.551 StatisticsManager initialized
[INFO] 17:59:43.557 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.558 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mShop and Piece Management[2m > [22m[2mshould reject piece selection without shop piece
[22m[39m[INFO] 17:59:43.559 StatisticsManager initialized
[INFO] 17:59:43.565 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.565 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mCell Click Handling[2m > [22m[2mshould handle clicks during setup phases
[22m[39m[INFO] 17:59:43.568 StatisticsManager initialized
[INFO] 17:59:43.571 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.571 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mCell Click Handling[2m > [22m[2mshould handle clicks during setup phases
[22m[39m[GameController] handleCellClick called: row=7, col=4, phase=SETUP_WHITE_KING
[SetupMode] Placing King

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mCell Click Handling[2m > [22m[2mshould block clicks during animation
[22m[39m[INFO] 17:59:43.579 StatisticsManager initialized
[INFO] 17:59:43.585 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.585 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mCell Click Handling[2m > [22m[2mshould block clicks during animation
[22m[39m[GameController] handleCellClick called: row=4, col=4, phase=PLAY
[GameController] Blocked: animating

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mCell Click Handling[2m > [22m[2mshould block clicks in replay mode
[22m[39m[INFO] 17:59:43.588 StatisticsManager initialized
[INFO] 17:59:43.595 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.595 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/angelPromotion.test.js[2m > [22m[2mAngel Piece and Promotion[2m > [22m[2mPawn should automatically promote to Angel
[22m[39m[MoveExecutor] Triggering Promotion UI

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mCell Click Handling[2m > [22m[2mshould block clicks in replay mode
[22m[39m[GameController] handleCellClick called: row=4, col=4, phase=PLAY
[GameController] Blocked: replay mode

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should not select AI piece during strict setup
[22m[39m[INFO] 17:59:43.599 StatisticsManager initialized
[INFO] 17:59:43.606 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.608 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should not select AI piece during strict setup
[22m[39m[GameController] handleCellClick called: row=0, col=0, phase=PLAY
[GameController] Blocked: AI turn

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should select piece in PLAY phase
[22m[39m[INFO] 17:59:43.610 StatisticsManager initialized
[INFO] 17:59:43.617 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.618 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should select piece in PLAY phase
[22m[39m[GameController] handleCellClick called: row=7, col=4, phase=PLAY

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should select piece in PLAY phase
[22m[39m[GameController] handleCellClick called: row=4, col=4, phase=PLAY

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should execute move if valid
[22m[39m[INFO] 17:59:43.624 StatisticsManager initialized
[INFO] 17:59:43.633 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.633 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should execute move if valid
[22m[39m[GameController] handleCellClick called: row=6, col=4, phase=PLAY

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should execute move if valid
[22m[39m[GameController] handleCellClick called: row=5, col=4, phase=PLAY

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should place king in setup
[22m[39m[INFO] 17:59:43.638 StatisticsManager initialized
[INFO] 17:59:43.648 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.648 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAI and Game State[2m > [22m[2mhandleCellClick should place king in setup
[22m[39m[GameController] handleCellClick called: row=8, col=4, phase=SETUP_WHITE_KING
[SetupMode] Placing King

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mClock Management[2m > [22m[2mshould stop clock when not in PLAY phase
[22m[39m[INFO] 17:59:43.650 StatisticsManager initialized
[INFO] 17:59:43.654 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.654 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAnalysis Mode[2m > [22m[2mshould delegate enterAnalysisMode to AnalysisController
[22m[39m[INFO] 17:59:43.656 StatisticsManager initialized
[INFO] 17:59:43.659 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.659 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mAnalysis Mode[2m > [22m[2mshould delegate exitAnalysisMode to AnalysisController
[22m[39m[INFO] 17:59:43.661 StatisticsManager initialized
[INFO] 17:59:43.664 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.664 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mSave and Load[2m > [22m[2mshould handle corrupt save data
[22m[39m[INFO] 17:59:43.665 StatisticsManager initialized
[INFO] 17:59:43.669 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.669 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mSave and Load[2m > [22m[2mshould handle corrupt save data
[22m[39m[ERROR] 17:59:43.670 [Storage] Failed to parse save game: SyntaxError: Unexpected token 'i', "invalid" is not valid JSON
    at JSON.parse (<anonymous>)
    at StorageManager.loadGame [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/storage.ts:97:26[90m)[39m
    at GameController.loadGame [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/gameController.ts:461:30[90m)[39m
    at [90m/home/tobber/.gemini/antigravity/scratch/schach/[39mtests/gameController.test.js:354:22
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mResignation[2m > [22m[2mshould allow resignation in PLAY phase
[22m[39m[INFO] 17:59:43.690 StatisticsManager initialized
[INFO] 17:59:43.695 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.696 Game initialized with [33m15[39m points in mode: setup

 [32mâœ“[39m tests/ui/AnalysisUI.test.ts [2m([22m[2m25 tests[22m[2m)[22m[32m 246[2mms[22m[39m
[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mResignation[2m > [22m[2mshould allow resignation in PLAY phase
[22m[39m[WARN] 17:59:43.696 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'black'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

[90mstdout[2m | tests/angelPromotion.test.js[2m > [22m[2mAngel Piece and Promotion[2m > [22m[2mAngel Performance and Move Generation[2m > [22m[2mMultiple promotions to Angel in same game
[22m[39m[MoveExecutor] Triggering Promotion UI

[90mstdout[2m | tests/angelPromotion.test.js[2m > [22m[2mAngel Piece and Promotion[2m > [22m[2mAngel Performance and Move Generation[2m > [22m[2mMultiple promotions to Angel in same game
[22m[39m[MoveExecutor] Triggering Promotion UI

 [32mâœ“[39m tests/angelPromotion.test.js [2m([22m[2m21 tests[22m[2m)[22m[32m 265[2mms[22m[39m
[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mResignation[2m > [22m[2mshould prevent resignation in non-PLAY phase
[22m[39m[INFO] 17:59:43.706 StatisticsManager initialized
[INFO] 17:59:43.753 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.754 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mDraw Offers[2m > [22m[2mshould handle draw offer
[22m[39m[INFO] 17:59:43.757 StatisticsManager initialized
[INFO] 17:59:43.759 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.763 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mDraw Offers[2m > [22m[2mshould accept draw
[22m[39m[INFO] 17:59:43.765 StatisticsManager initialized
[INFO] 17:59:43.774 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.775 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mDraw Offers[2m > [22m[2mshould accept draw
[22m[39m[WARN] 17:59:43.775 Game start time not set, skipping statistics save

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mDraw Offers[2m > [22m[2mshould decline draw
[22m[39m[INFO] 17:59:43.777 StatisticsManager initialized
[INFO] 17:59:43.784 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.784 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/gameController.test.js[2m > [22m[2mGameController[2m > [22m[2mCampaign Level[2m > [22m[2mshould handle invalid level ID gracefully
[22m[39m[INFO] 17:59:43.785 StatisticsManager initialized
[INFO] 17:59:43.791 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:43.791 Game initialized with [33m15[39m points in mode: setup

 [32mâœ“[39m tests/gameController.test.js [2m([22m[2m26 tests[22m[2m)[22m[33m 314[2mms[22m[39m
[90mstdout[2m | tests/ui/OverlayManager.test.js[2m > [22m[2mOverlayManager[2m > [22m[2mshowModal / closeModal[2m > [22m[2mshowModal displays modal with title and message
[22m[39m[OverlayManager] Showing modal: Test Title
[OverlayManager] Modal visibility set to flex

[90mstdout[2m | tests/ui/OverlayManager.test.js[2m > [22m[2mOverlayManager[2m > [22m[2mshowModal / closeModal[2m > [22m[2mshowModal adds action buttons
[22m[39m[OverlayManager] Showing modal: Title
[OverlayManager] Modal visibility set to flex
[OverlayManager] Modal closed

[90mstdout[2m | tests/ui/OverlayManager.test.js[2m > [22m[2mOverlayManager[2m > [22m[2mshowModal / closeModal[2m > [22m[2mcloseModal hides modal
[22m[39m[OverlayManager] Showing modal: Title
[OverlayManager] Modal visibility set to flex
[OverlayManager] Modal closed

[90mstdout[2m | tests/ui/OverlayManager.test.js[2m > [22m[2mOverlayManager[2m > [22m[2mshowModal / closeModal[2m > [22m[2mshowModal returns early if elements missing
[22m[39m[OverlayManager] Missing elements: { modal: [33mfalse[39m, titleEl: [33mfalse[39m, messageEl: [33mfalse[39m, actionsEl: [33mfalse[39m }

[90mstderr[2m | tests/ui/OverlayManager.test.js[2m > [22m[2mOverlayManager[2m > [22m[2mshowPromotionUI[2m > [22m[2mreturns early if overlay missing
[22m[39m[OverlayManager] Error: Promotion overlay or options container not found!

 [32mâœ“[39m tests/ui/OverlayManager.test.js [2m([22m[2m15 tests[22m[2m)[22m[32m 278[2mms[22m[39m
 [32mâœ“[39m tests/ui/GameStatusUI.test.js [2m([22m[2m8 tests[22m[2m)[22m[32m 167[2mms[22m[39m
 [32mâœ“[39m tests/gameStateManager.test.js [2m([22m[2m23 tests[22m[2m)[22m[32m 170[2mms[22m[39m
 [32mâœ“[39m tests/modes/standardMode.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 94[2mms[22m[39m
 [32mâœ“[39m tests/ui.touch.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 154[2mms[22m[39m
[90mstdout[2m | tests/integration.test.js
[22m[39m[INFO] 17:59:45.290 StatisticsManager initialized

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mFull Game Setup Flow[2m > [22m[2mshould complete full setup: white king â†’ black king â†’ pieces â†’ play
[22m[39m[INFO] 17:59:45.370 StatisticsManager initialized
[INFO] 17:59:45.371 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.392 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mFull Game Setup Flow[2m > [22m[2mshould complete full setup: white king â†’ black king â†’ pieces â†’ play
[22m[39m[INFO] 17:59:45.426 [Storage] Game saved to schach9x9_save_autosave (893 bytes)
[DEBUG] 17:59:45.426 Auto-saved game
[DEBUG] 17:59:45.427 Removed all corridor highlighting for PLAY phase
[INFO] 17:59:45.428 [Storage] Game saved to schach9x9_save_autosave (960 bytes)
[DEBUG] 17:59:45.428 Auto-saved game

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mFull Game Setup Flow[2m > [22m[2mshould handle classic mode initialization
[22m[39m[INFO] 17:59:45.432 StatisticsManager initialized
[INFO] 17:59:45.433 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.438 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mFull Game Setup Flow[2m > [22m[2mshould handle classic mode initialization
[22m[39m[INFO] 17:59:45.441 StatisticsManager initialized

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mSave/Load Round Trip[2m > [22m[2mshould save and load game state correctly
[22m[39m[INFO] 17:59:45.448 StatisticsManager initialized
[INFO] 17:59:45.450 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.456 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mSave/Load Round Trip[2m > [22m[2mshould save and load game state correctly
[22m[39m[INFO] 17:59:45.457 StatisticsManager initialized

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mSave/Load Round Trip[2m > [22m[2mshould save and load game state correctly
[22m[39m[INFO] 17:59:45.460 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mSave/Load Round Trip[2m > [22m[2mshould save and load game state correctly
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mSave/Load Round Trip[2m > [22m[2mshould save and load game state correctly
[22m[39m[INFO] 17:59:45.472 [WasmBridge] Wasm AI Engine initialized successfully.

 [32mâœ“[39m tests/setupPhase.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 123[2mms[22m[39m
[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mSave/Load Round Trip[2m > [22m[2mshould save and load game state correctly
[22m[39m[INFO] 17:59:45.478 [Storage] Game saved to schach9x9_save_autosave (2452 bytes)
[INFO] 17:59:45.481 StatisticsManager initialized
[INFO] 17:59:45.482 [Storage] Game loaded from schach9x9_save_autosave

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mMove Execution and Undo[2m > [22m[2mshould execute move â†’ undo â†’ redo correctly
[22m[39m[INFO] 17:59:45.483 StatisticsManager initialized
[INFO] 17:59:45.484 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.487 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mMove Execution and Undo[2m > [22m[2mshould execute move â†’ undo â†’ redo correctly
[22m[39m[INFO] 17:59:45.487 StatisticsManager initialized

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mGame End Scenarios[2m > [22m[2mshould handle resignation
[22m[39m[INFO] 17:59:45.494 StatisticsManager initialized
[INFO] 17:59:45.495 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.499 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mGame End Scenarios[2m > [22m[2mshould handle resignation
[22m[39m[INFO] 17:59:45.500 StatisticsManager initialized
[WARN] 17:59:45.503 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'black'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mGame End Scenarios[2m > [22m[2mshould handle draw offer and acceptance
[22m[39m[INFO] 17:59:45.505 StatisticsManager initialized
[INFO] 17:59:45.507 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.510 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mGame End Scenarios[2m > [22m[2mshould handle draw offer and acceptance
[22m[39m[INFO] 17:59:45.512 StatisticsManager initialized
[WARN] 17:59:45.514 Game start time not set, skipping statistics save

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mTime Control Integration[2m > [22m[2mshould handle time running out
[22m[39m[INFO] 17:59:45.515 StatisticsManager initialized
[INFO] 17:59:45.516 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.521 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mTime Control Integration[2m > [22m[2mshould handle time running out
[22m[39m[INFO] 17:59:45.523 StatisticsManager initialized
[WARN] 17:59:45.524 Game start time not set, skipping statistics save

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mAI Integration[2m > [22m[2mshould handle AI game setup
[22m[39m[INFO] 17:59:45.526 StatisticsManager initialized
[INFO] 17:59:45.526 SetupModeStrategy initialized with [33m15[39m points
[INFO] 17:59:45.532 Game initialized with [33m15[39m points in mode: setup

[90mstdout[2m | tests/integration.test.js[2m > [22m[2mIntegration Tests[2m > [22m[2mAI Integration[2m > [22m[2mshould handle AI game setup
[22m[39m[INFO] 17:59:45.532 StatisticsManager initialized

 [32mâœ“[39m tests/integration.test.js [2m([22m[2m8 tests[22m[2m)[22m[32m 169[2mms[22m[39m
 [32mâœ“[39m tests/arrows.test.js [2m([22m[2m9 tests[22m[2m)[22m[32m 141[2mms[22m[39m
 [32mâœ“[39m tests/notificationUI.test.js [2m([22m[2m8 tests[22m[2m)[22m[32m 95[2mms[22m[39m
[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Start Position Depth 4
[22m[39m[INFO] 17:59:45.965 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Start Position Depth 4
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Start Position Depth 4
[22m[39m[INFO] 17:59:45.982 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Start Position Depth 4
[22m[39m[DEBUG] 17:59:45.989 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Start Position Depth 4
[22m[39m[Benchmark] Depth 4 took 0.02s

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Complex Midgame Depth 4
[22m[39m[DEBUG] 17:59:46.047 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Complex Midgame Depth 4
[22m[39m[Benchmark] Complex Midgame Depth 4 took 0.06s

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mConsistency: Score stability across depths
[22m[39m[DEBUG] 17:59:46.050 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mConsistency: Score stability across depths
[22m[39m[DEBUG] 17:59:46.051 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mConsistency: Score stability across depths
[22m[39m[Stability] Eval: 350, D2: 350, D4: 350

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Depth 5 Search (Target < 5s)
[22m[39m[DEBUG] 17:59:46.054 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/aiBenchmarks.test.ts[2m > [22m[2mAI Performance Benchmarks[2m > [22m[2mBenchmark: Depth 5 Search (Target < 5s)
[22m[39m[Benchmark] Depth 5 took 0.00s

 [32mâœ“[39m tests/ai/aiBenchmarks.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 93[2mms[22m[39m
 [32mâœ“[39m tests/property.test.js [2m([22m[2m2 tests[22m[2m)[22m[32m 224[2mms[22m[39m
 [32mâœ“[39m tests/ui/PuzzleMenu.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 87[2mms[22m[39m
 [32mâœ“[39m tests/app.features.test.js [2m([22m[2m20 tests[22m[2m)[22m[32m 187[2mms[22m[39m
[90mstdout[2m | tests/shop/shopManager.test.ts[2m > [22m[2mShopManager[2m > [22m[2mupgradePiece()[2m > [22m[2mshould execute upgrade and deduct cost
[22m[39m[ShopManager] performUpgrade called: { r: [33m6[39m, c: [33m4[39m, targetType: [32m'n'[39m }
[ShopManager] Deducting points and updating piece type

[90mstdout[2m | tests/shop/shopManager.test.ts[2m > [22m[2mShopManager[2m > [22m[2mupgradePiece()[2m > [22m[2mshould call 3D board remove/add if enabled
[22m[39m[ShopManager] performUpgrade called: { r: [33m6[39m, c: [33m4[39m, targetType: [32m'n'[39m }
[ShopManager] Deducting points and updating piece type

[90mstdout[2m | tests/shop/shopManager.test.ts[2m > [22m[2mShopManager[2m > [22m[2mupgradePiece()[2m > [22m[2mshould fail if cannot afford cost
[22m[39m[ShopManager] performUpgrade called: { r: [33m6[39m, c: [33m4[39m, targetType: [32m'e'[39m }

[90mstderr[2m | tests/shop/shopManager.test.ts[2m > [22m[2mShopManager[2m > [22m[2mupgradePiece()[2m > [22m[2mshould fail if cannot afford cost
[22m[39m[ShopManager] Not enough points: [33m1[39m < [33m11[39m

[90mstdout[2m | tests/shop/shopManager.test.ts[2m > [22m[2mShopManager[2m > [22m[2maiPerformUpgrades()[2m > [22m[2mshould spend points on upgrades
[22m[39m[ShopManager] performUpgrade called: { r: [33m0[39m, c: [33m4[39m, targetType: [32m'q'[39m }
[ShopManager] Deducting points and updating piece type

 [32mâœ“[39m tests/shop/shopManager.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 164[2mms[22m[39m
[90mstderr[2m | tests/errorManager.test.js[2m > [22m[2mErrorManager[2m > [22m[2mshould handle critical errors by showing overlay
[22m[39mFull Stack: Error: Critical Failure
    at /home/tobber/.gemini/antigravity/scratch/schach/tests/errorManager.test.js:25:19
    at file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///home/tobber/.gemini/antigravity/scratch/schach/node_modules/@vitest/runner/dist/index.js:1653:12)

 [32mâœ“[39m tests/errorManager.test.js [2m([22m[2m7 tests[22m[2m)[22m[32m 94[2mms[22m[39m
[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[INFO] 17:59:47.439 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[INFO] 17:59:47.449 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.453 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.506 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.512 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.515 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.521 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.525 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.538 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.540 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.545 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/AIController.test.js[2m > [22m[2mAI Integration: Self-Play[2m > [22m[2mSelf-Play: 10 Moves without crash
[22m[39m[DEBUG] 17:59:47.546 [AiEngine] Using Wasm Engine Result (Main Thread)

 [32mâœ“[39m tests/ai/AIController.test.js [2m([22m[2m1 test[22m[2m)[22m[32m 134[2mms[22m[39m
 [32mâœ“[39m tests/moveController.enhanced.test.js [2m([22m[2m18 tests[22m[2m)[22m[32m 127[2mms[22m[39m
 [32mâœ“[39m tests/battleChess3D.test.js [2m([22m[2m16 tests[22m[2m)[22m[32m 76[2mms[22m[39m
[90mstdout[2m | tests/moveExecutor.unit.test.js[2m > [22m[2mMoveExecutor Integration Tests[2m > [22m[2mPromotion: Pawn promotes to Angel at row 0
[22m[39m[MoveExecutor] Triggering Promotion UI

 [32mâœ“[39m tests/moveExecutor.unit.test.js [2m([22m[2m13 tests[22m[2m)[22m[32m 121[2mms[22m[39m
 [32mâœ“[39m tests/evalBar.test.js [2m([22m[2m6 tests[22m[2m)[22m[32m 123[2mms[22m[39m
[90mstdout[2m | tests/campaignIntegration.test.js
[22m[39m[INFO] 17:59:48.521 StatisticsManager initialized

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mstartCampaignLevel should initialize level_1 (fixed)
[22m[39m[INFO] 17:59:48.588 StatisticsManager initialized

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mstartCampaignLevel should initialize level_1 (fixed)
[22m[39m[INFO] 17:59:48.592 Started Campaign Level: Aufstand

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mhandleGameEnd should complete level on victory
[22m[39m[INFO] 17:59:48.607 StatisticsManager initialized

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mhandleGameEnd should complete level on victory
[22m[39m[INFO] 17:59:48.608 Started Campaign Level: Aufstand
[WARN] 17:59:48.608 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [33mtrue[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [32m'white'[39m,
  levelId: [32m'level_1'[39m
}
[GameController] Triggering Campaign Victory

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mhandleGameEnd should unlock level_2 after level_1 win
[22m[39m[INFO] 17:59:48.629 StatisticsManager initialized

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mhandleGameEnd should unlock level_2 after level_1 win
[22m[39m[INFO] 17:59:48.631 Started Campaign Level: Aufstand
[WARN] 17:59:48.632 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [33mtrue[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [32m'white'[39m,
  levelId: [32m'level_1'[39m
}
[GameController] Triggering Campaign Victory

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mshould unlock level_3 after level_2 win and persistent rewards
[22m[39m[INFO] 17:59:48.640 StatisticsManager initialized

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mshould unlock level_3 after level_2 win and persistent rewards
[22m[39m[INFO] 17:59:48.641 Started Campaign Level: Aufstand
[WARN] 17:59:48.641 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [33mtrue[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [32m'white'[39m,
  levelId: [32m'level_1'[39m
}
[GameController] Triggering Campaign Victory
[INFO] 17:59:48.645 Started Campaign Level: Level 2
[WARN] 17:59:48.645 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [33mtrue[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [32m'white'[39m,
  levelId: [32m'level_2'[39m
}
[GameController] Triggering Campaign Victory
[INFO] 17:59:48.649 Started Campaign Level: Level 3
[WARN] 17:59:48.649 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [33mtrue[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [32m'white'[39m,
  levelId: [32m'level_3'[39m
}
[GameController] Triggering Campaign Victory
[Campaign] Unlocked Reward: angel

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mresetState should clear all progress for testing isolation
[22m[39m[INFO] 17:59:48.661 StatisticsManager initialized

[90mstdout[2m | tests/campaignIntegration.test.js[2m > [22m[2mCampaign Integration[2m > [22m[2mresetState should clear all progress for testing isolation
[22m[39m[INFO] 17:59:48.662 Started Campaign Level: Aufstand
[WARN] 17:59:48.662 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [33mtrue[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [32m'white'[39m,
  levelId: [32m'level_1'[39m
}
[GameController] Triggering Campaign Victory

 [32mâœ“[39m tests/campaignIntegration.test.js [2m([22m[2m5 tests[22m[2m)[22m[32m 90[2mms[22m[39m
 [32mâœ“[39m tests/moveValidator.unit.test.js [2m([22m[2m10 tests[22m[2m)[22m[32m 141[2mms[22m[39m
[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[INFO] 17:59:48.926 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[INFO] 17:59:48.939 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.942 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.943 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.943 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.943 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.944 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.945 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.945 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.946 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.946 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.947 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.947 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.947 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.947 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.947 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.949 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.950 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.950 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.950 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.950 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.950 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.950 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.950 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.951 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.951 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should show evaluation noise
[22m[39m[DEBUG] 17:59:48.951 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloScaling.test.js[2m > [22m[2mAI Elo Scaling & Noise[2m > [22m[2m800 Elo should occasionally blunder material
[22m[39m[DEBUG] 17:59:48.953 [AiEngine] Using Wasm Engine Result (Main Thread)

 [32mâœ“[39m tests/ai/EloScaling.test.js [2m([22m[2m2 tests[22m[2m)[22m[32m 45[2mms[22m[39m
 [32mâœ“[39m tests/ui/TooltipManager.test.js [2m([22m[2m7 tests[22m[2m)[22m[32m 149[2mms[22m[39m
 [32mâœ“[39m tests/shopUI.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 117[2mms[22m[39m
[90mstdout[2m | tests/repro_bug.test.js[2m > [22m[2mBug Reproduction: Rook transforming into King[2m > [22m[2mshould correctly undo kingside castling without transforming rook
[22m[39m[INFO] 17:59:50.107 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/pgnGenerator.test.js[2m > [22m[2mPGNGenerator[2m > [22m[2mClipboard and Download[2m > [22m[2mshould return false on clipboard error
[22m[39mFailed to copy PGN: Error: fail
    at [90m/home/tobber/.gemini/antigravity/scratch/schach/[39mtests/pgnGenerator.test.js:306:59
[90m    at processTicksAndRejections (node:internal/process/task_queues:103:5)[39m
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | tests/repro_bug.test.js[2m > [22m[2mBug Reproduction: Rook transforming into King[2m > [22m[2mshould correctly undo kingside castling without transforming rook
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/repro_bug.test.js[2m > [22m[2mBug Reproduction: Rook transforming into King[2m > [22m[2mshould correctly undo kingside castling without transforming rook
[22m[39m[INFO] 17:59:50.128 [WasmBridge] Wasm AI Engine initialized successfully.

 [32mâœ“[39m tests/pgnGenerator.test.js [2m([22m[2m23 tests[22m[2m)[22m[32m 37[2mms[22m[39m
 [32mâœ“[39m tests/repro_bug.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 40[2mms[22m[39m
[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mAGGRESSIVE personality should reward forward pieces more
[22m[39m[INFO] 17:59:50.226 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mAGGRESSIVE personality should reward forward pieces more
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mAGGRESSIVE personality should reward forward pieces more
[22m[39m[INFO] 17:59:50.240 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mAGGRESSIVE personality should reward forward pieces more
[22m[39m[DEBUG] 17:59:50.243 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mAGGRESSIVE personality should reward forward pieces more
[22m[39m[DEBUG] 17:59:50.247 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mSOLID personality should reward pawn structure more
[22m[39m[DEBUG] 17:59:50.251 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mSOLID personality should reward pawn structure more
[22m[39m[DEBUG] 17:59:50.251 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mSOLID personality should penalize exposed kings more
[22m[39m[DEBUG] 17:59:50.252 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/ai/EloPersonalities.test.js[2m > [22m[2mAI Elo Personalities[2m > [22m[2mSOLID personality should penalize exposed kings more
[22m[39m[DEBUG] 17:59:50.256 [AiEngine] Using Wasm Engine Result (Main Thread)

 [32mâœ“[39m tests/ai/EloPersonalities.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 35[2mms[22m[39m
 [32mâœ“[39m tests/ui/3d/PieceManager3D.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 47[2mms[22m[39m
[90mstdout[2m | tests/undo_redo_repro.test.js[2m > [22m[2mUndo/Redo System Reproduction Tests[2m > [22m[2mPromotion Undo/Redo Issue
[22m[39m[MoveExecutor] Triggering Promotion UI

[90mstdout[2m | tests/undo_redo_repro.test.js[2m > [22m[2mUndo/Redo System Reproduction Tests[2m > [22m[2mPromotion Undo/Redo Issue
[22m[39m[MoveExecutor] Triggering Promotion UI

 [32mâœ“[39m tests/undo_redo_repro.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 30[2mms[22m[39m
 [32mâœ“[39m tests/debugConsole.test.js [2m([22m[2m18 tests[22m[2m)[22m[32m 37[2mms[22m[39m
 [32mâœ“[39m tests/chess-pieces.test.js [2m([22m[2m16 tests[22m[2m)[22m[32m 27[2mms[22m[39m
[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mevaluatePosition[2m > [22m[2mshould return tempo bonus for empty board
[22m[39m[INFO] 17:59:51.386 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mevaluatePosition[2m > [22m[2mshould return tempo bonus for empty board
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mevaluatePosition[2m > [22m[2mshould return tempo bonus for empty board
[22m[39m[INFO] 17:59:51.405 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mgetBestMove[2m > [22m[2mshould find a simple capture
[22m[39m[DEBUG] 17:59:51.420 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mgetBestMove[2m > [22m[2mshould avoid immediate capture
[22m[39m[DEBUG] 17:59:51.426 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mAdvanced AI Scenarios[2m > [22m[2mshould find Mate in 1
[22m[39m[DEBUG] 17:59:51.428 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mAdvanced AI Scenarios[2m > [22m[2mshould avoid Stalemate when winning
[22m[39m[DEBUG] 17:59:51.433 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mAdvanced AI Scenarios[2m > [22m[2mshould use Quiescence Search to see capture chains
[22m[39m[DEBUG] 17:59:51.434 [AiEngine] Using Wasm Engine Result (Main Thread)

[90mstdout[2m | tests/aiEngine.test.js[2m > [22m[2mAI Engine[2m > [22m[2mDifficulty Levels and Randomized Behavior[2m > [22m[2measy should prefer captures
[22m[39m[DEBUG] 17:59:51.444 [AiEngine] Using Wasm Engine Result (Main Thread)

 [32mâœ“[39m tests/aiEngine.test.js [2m([22m[2m17 tests[22m[2m)[22m[32m 62[2mms[22m[39m
[90mstderr[2m | tests/keyboardManager.test.js[2m > [22m[2mKeyboardManager[2m > [22m[2mshould trigger emergency recovery on Ctrl+Shift+F12
[22m[39m[RECOVERY] Previous turn: undefined, isAnimating was reset, spinner hidden

[90mstderr[2m | tests/keyboardManager.test.js[2m > [22m[2mKeyboardManager[2m > [22m[2mshould perform emergency recovery correctly
[22m[39m[RECOVERY] Previous turn: black, isAnimating was reset, spinner hidden

 [32mâœ“[39m tests/keyboardManager.test.js [2m([22m[2m30 tests[22m[2m)[22m[32m 90[2mms[22m[39m
[90mstdout[2m | tests/statisticsManager.test.js
[22m[39m[INFO] 17:59:51.523 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mInitialization[2m > [22m[2mshould initialize with empty data
[22m[39m[INFO] 17:59:51.537 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mInitialization[2m > [22m[2mshould load existing data from localStorage
[22m[39m[INFO] 17:59:51.539 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mInitialization[2m > [22m[2mshould load existing data from localStorage
[22m[39m[INFO] 17:59:51.540 Loaded 1 games from storage
[INFO] 17:59:51.540 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2msaveGame[2m > [22m[2mshould save a game and update statistics
[22m[39m[INFO] 17:59:51.542 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2msaveGame[2m > [22m[2mshould save a game and update statistics
[22m[39m[DEBUG] 17:59:51.543 Game history saved to storage
[INFO] 17:59:51.543 Game saved: win vs AI-Beginner (2 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2msaveGame[2m > [22m[2mshould calculate win rate correctly
[22m[39m[INFO] 17:59:51.544 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2msaveGame[2m > [22m[2mshould calculate win rate correctly
[22m[39m[DEBUG] 17:59:51.544 Game history saved to storage
[INFO] 17:59:51.544 Game saved: win vs Unknown (0 moves)
[DEBUG] 17:59:51.544 Game history saved to storage
[INFO] 17:59:51.544 Game saved: loss vs Unknown (0 moves)
[DEBUG] 17:59:51.544 Game history saved to storage
[INFO] 17:59:51.544 Game saved: draw vs Unknown (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2msaveGame[2m > [22m[2mshould persist data to localStorage
[22m[39m[INFO] 17:59:51.545 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2msaveGame[2m > [22m[2mshould persist data to localStorage
[22m[39m[DEBUG] 17:59:51.545 Game history saved to storage
[INFO] 17:59:51.545 Game saved: win vs Unknown (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould return all games by default
[22m[39m[INFO] 17:59:51.546 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould return all games by default
[22m[39m[DEBUG] 17:59:51.546 Game history saved to storage
[INFO] 17:59:51.546 Game saved: win vs AI-Easy (0 moves)
[DEBUG] 17:59:51.546 Game history saved to storage
[INFO] 17:59:51.546 Game saved: loss vs AI-Hard (0 moves)
[DEBUG] 17:59:51.546 Game history saved to storage
[INFO] 17:59:51.546 Game saved: draw vs AI-Easy (0 moves)
[DEBUG] 17:59:51.546 Game history saved to storage
[INFO] 17:59:51.546 Game saved: win vs AI-Hard (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould filter by result
[22m[39m[INFO] 17:59:51.547 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould filter by result
[22m[39m[DEBUG] 17:59:51.547 Game history saved to storage
[INFO] 17:59:51.547 Game saved: win vs AI-Easy (0 moves)
[DEBUG] 17:59:51.547 Game history saved to storage
[INFO] 17:59:51.547 Game saved: loss vs AI-Hard (0 moves)
[DEBUG] 17:59:51.547 Game history saved to storage
[INFO] 17:59:51.547 Game saved: draw vs AI-Easy (0 moves)
[DEBUG] 17:59:51.547 Game history saved to storage
[INFO] 17:59:51.547 Game saved: win vs AI-Hard (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould filter by opponent
[22m[39m[INFO] 17:59:51.548 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould filter by opponent
[22m[39m[DEBUG] 17:59:51.548 Game history saved to storage
[INFO] 17:59:51.548 Game saved: win vs AI-Easy (0 moves)
[DEBUG] 17:59:51.548 Game history saved to storage
[INFO] 17:59:51.548 Game saved: loss vs AI-Hard (0 moves)
[DEBUG] 17:59:51.548 Game history saved to storage
[INFO] 17:59:51.548 Game saved: draw vs AI-Easy (0 moves)
[DEBUG] 17:59:51.548 Game history saved to storage
[INFO] 17:59:51.548 Game saved: win vs AI-Hard (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould limit results
[22m[39m[INFO] 17:59:51.548 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould limit results
[22m[39m[DEBUG] 17:59:51.549 Game history saved to storage
[INFO] 17:59:51.549 Game saved: win vs AI-Easy (0 moves)
[DEBUG] 17:59:51.549 Game history saved to storage
[INFO] 17:59:51.549 Game saved: loss vs AI-Hard (0 moves)
[DEBUG] 17:59:51.549 Game history saved to storage
[INFO] 17:59:51.549 Game saved: draw vs AI-Easy (0 moves)
[DEBUG] 17:59:51.549 Game history saved to storage
[INFO] 17:59:51.549 Game saved: win vs AI-Hard (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould sort by date (newest first)
[22m[39m[INFO] 17:59:51.549 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameHistory[2m > [22m[2mshould sort by date (newest first)
[22m[39m[DEBUG] 17:59:51.549 Game history saved to storage
[INFO] 17:59:51.549 Game saved: win vs AI-Easy (0 moves)
[DEBUG] 17:59:51.549 Game history saved to storage
[INFO] 17:59:51.549 Game saved: loss vs AI-Hard (0 moves)
[DEBUG] 17:59:51.549 Game history saved to storage
[INFO] 17:59:51.549 Game saved: draw vs AI-Easy (0 moves)
[DEBUG] 17:59:51.550 Game history saved to storage
[INFO] 17:59:51.550 Game saved: win vs AI-Hard (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameById[2m > [22m[2mshould return game by ID
[22m[39m[INFO] 17:59:51.550 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameById[2m > [22m[2mshould return game by ID
[22m[39m[DEBUG] 17:59:51.551 Game history saved to storage
[INFO] 17:59:51.551 Game saved: win vs Unknown (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetGameById[2m > [22m[2mshould return null for non-existent ID
[22m[39m[INFO] 17:59:51.551 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mexportGames[2m > [22m[2mshould export games as JSON string
[22m[39m[INFO] 17:59:51.551 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mexportGames[2m > [22m[2mshould export games as JSON string
[22m[39m[DEBUG] 17:59:51.552 Game history saved to storage
[INFO] 17:59:51.552 Game saved: win vs Unknown (0 moves)
[DEBUG] 17:59:51.552 Game history saved to storage
[INFO] 17:59:51.552 Game saved: loss vs Unknown (0 moves)
[INFO] 17:59:51.552 Exported 2 games

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould import games (merge mode)
[22m[39m[INFO] 17:59:51.552 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould import games (merge mode)
[22m[39m[DEBUG] 17:59:51.552 Game history saved to storage
[INFO] 17:59:51.552 Game saved: win vs Original (0 moves)
[INFO] 17:59:51.553 Imported 1 new games (merged)
[DEBUG] 17:59:51.553 Game history saved to storage

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould import games (replace mode)
[22m[39m[INFO] 17:59:51.553 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould import games (replace mode)
[22m[39m[DEBUG] 17:59:51.554 Game history saved to storage
[INFO] 17:59:51.554 Game saved: win vs Unknown (0 moves)
[INFO] 17:59:51.554 Imported 1 games (replaced)
[DEBUG] 17:59:51.554 Game history saved to storage

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould handle invalid import data
[22m[39m[INFO] 17:59:51.554 StatisticsManager initialized

[90mstderr[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould handle invalid import data
[22m[39mJSON Parse Error: SyntaxError: Unexpected token 'i', "invalid json" is not valid JSON
    at JSON.parse (<anonymous>)
    at safeJSONParse [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/utils.ts:44:17[90m)[39m
    at StatisticsManager.importGames [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/statisticsManager.ts:236:26[90m)[39m
    at [90m/home/tobber/.gemini/antigravity/scratch/schach/[39mtests/statisticsManager.test.js:225:31
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould avoid duplicate IDs when merging
[22m[39m[INFO] 17:59:51.571 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames[2m > [22m[2mshould avoid duplicate IDs when merging
[22m[39m[DEBUG] 17:59:51.571 Game history saved to storage
[INFO] 17:59:51.571 Game saved: win vs Unknown (0 moves)
[INFO] 17:59:51.571 Imported 0 new games (merged)
[DEBUG] 17:59:51.571 Game history saved to storage

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mclearHistory[2m > [22m[2mshould not clear without confirmation
[22m[39m[INFO] 17:59:51.572 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mclearHistory[2m > [22m[2mshould not clear without confirmation
[22m[39m[DEBUG] 17:59:51.572 Game history saved to storage
[INFO] 17:59:51.572 Game saved: win vs Unknown (0 moves)
[WARN] 17:59:51.572 clearHistory called without confirmation

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mclearHistory[2m > [22m[2mshould clear all history with confirmation
[22m[39m[INFO] 17:59:51.572 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mclearHistory[2m > [22m[2mshould clear all history with confirmation
[22m[39m[DEBUG] 17:59:51.572 Game history saved to storage
[INFO] 17:59:51.572 Game saved: win vs Unknown (0 moves)
[DEBUG] 17:59:51.573 Game history saved to storage
[INFO] 17:59:51.573 Game saved: loss vs Unknown (0 moves)
[DEBUG] 17:59:51.573 Game history saved to storage
[INFO] 17:59:51.573 Game history cleared

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetRecentStats[2m > [22m[2mshould get stats for recent games
[22m[39m[INFO] 17:59:51.573 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetRecentStats[2m > [22m[2mshould get stats for recent games
[22m[39m[DEBUG] 17:59:51.574 Game history saved to storage
[INFO] 17:59:51.574 Game saved: win vs Unknown (0 moves)
[DEBUG] 17:59:51.574 Game history saved to storage
[INFO] 17:59:51.574 Game saved: win vs Unknown (0 moves)
[DEBUG] 17:59:51.574 Game history saved to storage
[INFO] 17:59:51.574 Game saved: loss vs Unknown (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetStatsByOpponent[2m > [22m[2mshould group statistics by opponent
[22m[39m[INFO] 17:59:51.575 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mgetStatsByOpponent[2m > [22m[2mshould group statistics by opponent
[22m[39m[DEBUG] 17:59:51.576 Game history saved to storage
[INFO] 17:59:51.576 Game saved: win vs AI-Easy (0 moves)
[DEBUG] 17:59:51.576 Game history saved to storage
[INFO] 17:59:51.576 Game saved: win vs AI-Easy (0 moves)
[DEBUG] 17:59:51.576 Game history saved to storage
[INFO] 17:59:51.576 Game saved: loss vs AI-Easy (0 moves)
[DEBUG] 17:59:51.576 Game history saved to storage
[INFO] 17:59:51.576 Game saved: win vs AI-Hard (0 moves)
[DEBUG] 17:59:51.576 Game history saved to storage
[INFO] 17:59:51.576 Game saved: loss vs AI-Hard (0 moves)

[90mstdout[2m | tests/statisticsManager.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mrecalculateStats[2m > [22m[2mshould recalculate statistics from game history
[22m[39m[INFO] 17:59:51.577 StatisticsManager initialized

 [32mâœ“[39m tests/statisticsManager.test.js [2m([22m[2m22 tests[22m[2m)[22m[32m 43[2mms[22m[39m
[90mstdout[2m | tests/aiEngine.integration.test.js[2m > [22m[2mAIEngine Integration[2m > [22m[2mgetBestMove re-export functionality
[22m[39m[INFO] 17:59:51.606 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/aiEngine.integration.test.js[2m > [22m[2mAIEngine Integration[2m > [22m[2mgetBestMove re-export functionality
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/aiEngine.integration.test.js[2m > [22m[2mAIEngine Integration[2m > [22m[2mgetBestMove re-export functionality
[22m[39m[INFO] 17:59:51.615 [WasmBridge] Wasm AI Engine initialized successfully.

[90mstdout[2m | tests/aiEngine.integration.test.js[2m > [22m[2mAIEngine Integration[2m > [22m[2mgetBestMove re-export functionality
[22m[39m[DEBUG] 17:59:51.623 [AiEngine] Using Wasm Engine Result (Main Thread)

 [32mâœ“[39m tests/aiEngine.integration.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 30[2mms[22m[39m
 [32mâœ“[39m tests/hintGenerator.unit.test.js [2m([22m[2m18 tests[22m[2m)[22m[32m 57[2mms[22m[39m
 [32mâœ“[39m tests/Nightrider.test.js [2m([22m[2m9 tests[22m[2m)[22m[32m 14[2mms[22m[39m
[90mstdout[2m | tests/storage.test.js[2m > [22m[2mStorageManager[2m > [22m[2mshould save game state correctly
[22m[39m[INFO] 17:59:52.409 [Storage] Game saved to schach9x9_save_test-slot (796 bytes)

[90mstdout[2m | tests/storage.test.js[2m > [22m[2mStorageManager[2m > [22m[2mshould load game state correctly
[22m[39m[INFO] 17:59:52.414 [Storage] Game saved to schach9x9_save_test-slot (796 bytes)
[INFO] 17:59:52.414 [Storage] Game loaded from schach9x9_save_test-slot

[90mstdout[2m | tests/storage.test.js[2m > [22m[2mStorageManager[2m > [22m[2mshould return null if no save exists
[22m[39m[WARN] 17:59:52.415 [Storage] No save found for schach9x9_save_non-existent

[90mstdout[2m | tests/storage.test.js[2m > [22m[2mStorageManager[2m > [22m[2mshould check if save exists
[22m[39m[INFO] 17:59:52.416 [Storage] Game saved to schach9x9_save_test-slot (796 bytes)

[90mstdout[2m | tests/storage.test.js[2m > [22m[2mStorageManager[2m > [22m[2mshould load state into game object
[22m[39m[INFO] 17:59:52.418 [Storage] Game saved to schach9x9_save_test-slot (796 bytes)
[INFO] 17:59:52.418 [Storage] Game loaded from schach9x9_save_test-slot

[90mstdout[2m | tests/storage.test.js[2m > [22m[2mStorageManager[2m > [22m[2mshould handle autosave default slot
[22m[39m[INFO] 17:59:52.419 [Storage] Game saved to schach9x9_save_autosave (796 bytes)

 [32mâœ“[39m tests/storage.test.js [2m([22m[2m6 tests[22m[2m)[22m[32m 22[2mms[22m[39m
[90mstdout[2m | tests/aiPersonality.test.js[2m > [22m[2mAI Personality System[2m > [22m[2mevaluatePosition with personalities[2m > [22m[2mshould accept config parameter
[22m[39m[INFO] 17:59:52.757 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/aiPersonality.test.js[2m > [22m[2mAI Personality System[2m > [22m[2mevaluatePosition with personalities[2m > [22m[2mshould accept config parameter
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/aiPersonality.test.js[2m > [22m[2mAI Personality System[2m > [22m[2mevaluatePosition with personalities[2m > [22m[2mshould accept config parameter
[22m[39m[INFO] 17:59:52.781 [WasmBridge] Wasm AI Engine initialized successfully.

 [32mâœ“[39m tests/aiPersonality.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 42[2mms[22m[39m
[90mstdout[2m | tests/aiEngine.eval_boost.test.js[2m > [22m[2mAI Engine - Evaluation Boost[2m > [22m[2mKing Safety: King Zone Attacks
[22m[39m[INFO] 17:59:52.889 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/aiEngine.eval_boost.test.js[2m > [22m[2mAI Engine - Evaluation Boost[2m > [22m[2mKing Safety: King Zone Attacks
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/aiEngine.eval_boost.test.js[2m > [22m[2mAI Engine - Evaluation Boost[2m > [22m[2mKing Safety: King Zone Attacks
[22m[39m[INFO] 17:59:52.903 [WasmBridge] Wasm AI Engine initialized successfully.

 [32mâœ“[39m tests/aiEngine.eval_boost.test.js [2m([22m[2m2 tests[22m[2m)[22m[32m 21[2mms[22m[39m
[90mstdout[2m | tests/shop.test.js
[22m[39m[INFO] 17:59:52.922 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPoint Deduction[2m > [22m[2mshould deduct correct points when placing a pawn
[22m[39m[INFO] 17:59:52.982 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPoint Deduction[2m > [22m[2mshould deduct correct points when placing a queen
[22m[39m[INFO] 17:59:53.000 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPoint Deduction[2m > [22m[2mshould deduct correct points for Angel piece
[22m[39m[INFO] 17:59:53.001 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPoint Deduction[2m > [22m[2mshould NOT place piece if insufficient points
[22m[39m[INFO] 17:59:53.006 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPoint Deduction[2m > [22m[2mshould allow multiple purchases with remaining points
[22m[39m[INFO] 17:59:53.010 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPiece Placement Validation[2m > [22m[2mshould only allow placement in own corridor
[22m[39m[INFO] 17:59:53.011 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPiece Placement Validation[2m > [22m[2mshould NOT allow placement on occupied square
[22m[39m[INFO] 17:59:53.019 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPiece Placement Validation[2m > [22m[2mshould place piece for black during black setup phase
[22m[39m[INFO] 17:59:53.027 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPiece Removal and Refund[2m > [22m[2mshould refund points when removing own piece
[22m[39m[INFO] 17:59:53.030 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mPiece Removal and Refund[2m > [22m[2mshould NOT remove king piece
[22m[39m[INFO] 17:59:53.031 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mAI Purchase Logic[2m > [22m[2mshould use correct piece symbols when purchasing
[22m[39m[INFO] 17:59:53.037 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mAI Purchase Logic[2m > [22m[2mAI should stay within point budget
[22m[39m[INFO] 17:59:53.040 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mSelection Logic[2m > [22m[2mshould not select piece if cost exceeds points
[22m[39m[INFO] 17:59:53.041 StatisticsManager initialized

[90mstdout[2m | tests/shop.test.js[2m > [22m[2mShop System[2m > [22m[2mSelection Logic[2m > [22m[2mshould select piece if cost is affordable
[22m[39m[INFO] 17:59:53.042 StatisticsManager initialized

 [32mâœ“[39m tests/shop.test.js [2m([22m[2m14 tests[22m[2m)[22m[32m 65[2mms[22m[39m
 [32mâœ“[39m tests/ai/wasmBridge.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 27[2mms[22m[39m
 [32mâœ“[39m tests/pieces3D.test.js [2m([22m[2m6 tests[22m[2m)[22m[32m 43[2mms[22m[39m
 [32mâœ“[39m tests/ui/AnalysisUI.unit.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 98[2mms[22m[39m
 [32mâœ“[39m tests/gameEngine.rules.test.js [2m([22m[2m16 tests[22m[2m)[22m[32m 32[2mms[22m[39m
 [32mâœ“[39m tests/logger.enhanced.test.js [2m([22m[2m17 tests[22m[2m)[22m[32m 18[2mms[22m[39m
 [32mâœ“[39m tests/puzzle_repro.test.js [2m([22m[2m2 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m tests/sounds.test.js [2m([22m[2m11 tests[22m[2m)[22m[32m 28[2mms[22m[39m
[90mstdout[2m | tests/modes/upgradeMode.test.js
[22m[39m[INFO] 17:59:55.139 StatisticsManager initialized

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mInitial State should be correct
[22m[39m[INFO] 17:59:55.213 StatisticsManager initialized
[INFO] 17:59:55.213 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:55.224 Game initialized with [33m25[39m points in mode: upgrade

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mWhite Player can upgrade pieces
[22m[39m[INFO] 17:59:55.229 StatisticsManager initialized
[INFO] 17:59:55.229 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:55.229 Game initialized with [33m25[39m points in mode: upgrade

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mWhite Player can upgrade pieces
[22m[39m[ShopManager] performUpgrade called: { r: [33m7[39m, c: [33m4[39m, targetType: [32m'n'[39m }
[ShopManager] Deducting points and updating piece type

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mTransition to Black Setup works
[22m[39m[INFO] 17:59:55.234 StatisticsManager initialized
[INFO] 17:59:55.235 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:55.235 Game initialized with [33m25[39m points in mode: upgrade

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mAI Upgrades triggering
[22m[39m[INFO] 17:59:55.253 StatisticsManager initialized
[INFO] 17:59:55.253 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:55.253 Game initialized with [33m25[39m points in mode: upgrade

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mAI Upgrades triggering
[22m[39m[ShopManager] performUpgrade called: { r: [33m0[39m, c: [33m0[39m, targetType: [32m'c'[39m }
[ShopManager] Deducting points and updating piece type
[ShopManager] performUpgrade called: { r: [33m0[39m, c: [33m6[39m, targetType: [32m'a'[39m }
[ShopManager] Deducting points and updating piece type
[ShopManager] performUpgrade called: { r: [33m0[39m, c: [33m2[39m, targetType: [32m'a'[39m }
[ShopManager] Deducting points and updating piece type
[ShopManager] performUpgrade called: { r: [33m0[39m, c: [33m7[39m, targetType: [32m'e'[39m }
[ShopManager] Deducting points and updating piece type
[ShopManager] performUpgrade called: { r: [33m1[39m, c: [33m6[39m, targetType: [32m'j'[39m }
[ShopManager] Deducting points and updating piece type

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mPlay Phase transition
[22m[39m[INFO] 17:59:55.264 StatisticsManager initialized
[INFO] 17:59:55.264 SetupModeStrategy initialized with [33m25[39m points
[INFO] 17:59:55.265 Game initialized with [33m25[39m points in mode: upgrade

[90mstdout[2m | tests/modes/upgradeMode.test.js[2m > [22m[2mTroop Upgrade Mode[2m > [22m[2mPlay Phase transition
[22m[39m[DEBUG] 17:59:55.279 Removed all corridor highlighting for PLAY phase
[INFO] 17:59:55.287 [Storage] Game saved to schach9x9_save_autosave (2193 bytes)
[DEBUG] 17:59:55.287 Auto-saved game

 [32mâœ“[39m tests/modes/upgradeMode.test.js [2m([22m[2m5 tests[22m[2m)[22m[32m 82[2mms[22m[39m
[90mstderr[2m | tests/pgnParser.test.js[2m > [22m[2mPGNParser[2m > [22m[2mreplayGame()[2m > [22m[2mshould handle invalid moves gracefully
[22m[39mCould not parse move: Qxd8 for turn white

 [32mâœ“[39m tests/pgnParser.test.js [2m([22m[2m19 tests[22m[2m)[22m[32m 30[2mms[22m[39m
 [32mâœ“[39m tests/gameEngine.additional.test.js [2m([22m[2m9 tests[22m[2m)[22m[32m 15[2mms[22m[39m
[90mstdout[2m | tests/controller.logic.test.js
[22m[39m[INFO] 17:59:55.608 StatisticsManager initialized

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mClock Mechanics[2m > [22m[2mshould decrement clock and timeout
[22m[39m[INFO] 17:59:55.854 StatisticsManager initialized

 [32mâœ“[39m tests/utils.test.js [2m([22m[2m20 tests[22m[2m)[22m[32m 88[2mms[22m[39m
[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mClock Mechanics[2m > [22m[2mshould decrement clock and timeout
[22m[39m[WARN] 17:59:56.954 Game start time not set, skipping statistics save

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mClock Mechanics[2m > [22m[2mshould switch clocks on turn change
[22m[39m[INFO] 17:59:55.866 StatisticsManager initialized

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mState Persistence (Save/Load)[2m > [22m[2mshould save and load state correctly via localStorage
[22m[39m[INFO] 17:59:55.876 StatisticsManager initialized

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mState Persistence (Save/Load)[2m > [22m[2mshould save and load state correctly via localStorage
[22m[39m[INFO] 17:59:55.876 [Storage] Game saved to schach9x9_save_autosave (2192 bytes)
[INFO] 17:59:55.876 [Storage] Game loaded from schach9x9_save_autosave

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mMove Controller Logical Execution[2m > [22m[2mshould execute pawn promotion (automatic to Angel)
[22m[39m[INFO] 17:59:55.888 StatisticsManager initialized

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mMove Controller Logical Execution[2m > [22m[2mshould execute pawn promotion (automatic to Angel)
[22m[39m[MoveExecutor] Triggering Promotion UI

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mMove Controller Logical Execution[2m > [22m[2mshould execute pawn promotion (automatic to Angel)
[22m[39m[WARN] 17:59:55.888 Game start time not set, skipping statistics save
[GameController] handleGameEnd check: {
  campaignMode: [90mundefined[39m,
  result: [32m'win'[39m,
  winnerColor: [32m'white'[39m,
  playerColor: [90mundefined[39m,
  levelId: [90mundefined[39m
}

[90mstdout[2m | tests/controller.logic.test.js[2m > [22m[2mController Logic Deep Dive[2m > [22m[2mMove Controller Logical Execution[2m > [22m[2mshould execute queenside castling
[22m[39m[INFO] 17:59:55.894 StatisticsManager initialized

 [32mâœ“[39m tests/controller.logic.test.js [2m([22m[2m5 tests[22m[2m)[22m[32m 49[2mms[22m[39m
[90mstdout[2m | tests/battleAnimations.test.js[2m > [22m[2mBattleAnimator Class[2m > [22m[2mshould playBattle sequence
[22m[39m[INFO] 17:59:55.946 Battle: q vs p

 [32mâœ“[39m tests/battleAnimations.test.js [2m([22m[2m8 tests[22m[2m)[22m[32m 66[2mms[22m[39m
[90mstdout[2m | tests/aiEngine.extra.test.js[2m > [22m[2mAIEngine Extra Coverage[2m > [22m[2mevaluatePosition for various pieces
[22m[39m[INFO] 17:59:56.370 [WasmBridge] Initializing Wasm AI Engine...

 [32mâœ“[39m tests/aiEngine.extra.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 19[2mms[22m[39m
[90mstdout[2m | tests/aiEngine.eval.test.js[2m > [22m[2mAIEngine Deep Evaluation[2m > [22m[2mTapered Evaluation: material balance (Midgame vs Endgame)
[22m[39m[INFO] 17:59:56.740 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/aiEngine.eval.test.js[2m > [22m[2mAIEngine Deep Evaluation[2m > [22m[2mTapered Evaluation: material balance (Midgame vs Endgame)
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/aiEngine.eval.test.js[2m > [22m[2mAIEngine Deep Evaluation[2m > [22m[2mTapered Evaluation: material balance (Midgame vs Endgame)
[22m[39m[INFO] 17:59:56.754 [WasmBridge] Wasm AI Engine initialized successfully.

 [32mâœ“[39m tests/aiEngine.eval.test.js [2m([22m[2m5 tests[22m[2m)[22m[32m 28[2mms[22m[39m
[90mstdout[2m | tests/battleChess3D.coords.test.js[2m > [22m[2mBattleChess3D Debug Tests[2m > [22m[2mplayBattleSequence should convert board coords to world coords
[22m[39m[INFO] 17:59:56.961 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.coords.test.js[2m > [22m[2mBattleChess3D Debug Tests[2m > [22m[2mplayBattleSequence should convert board coords to world coords
[22m[39m[INFO] 17:59:56.964 Playing battle sequence: p vs p

 [32mâœ“[39m tests/battleChess3D.coords.test.js [2m([22m[2m1 test[22m[2m)[22m[32m 26[2mms[22m[39m
[90mstderr[2m | tests/statistics.test.js[2m > [22m[2mStatisticsManager[2m > [22m[2mimportGames should handle invalid JSON
[22m[39mJSON Parse Error: SyntaxError: Unexpected token 'i', "invalid-json" is not valid JSON
    at JSON.parse (<anonymous>)
    at safeJSONParse [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/utils.ts:44:17[90m)[39m
    at StatisticsManager.importGames [90m(/home/tobber/.gemini/antigravity/scratch/schach/[39mjs/statisticsManager.ts:236:26[90m)[39m
    at [90m/home/tobber/.gemini/antigravity/scratch/schach/[39mtests/statistics.test.js:122:27
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///home/tobber/.gemini/antigravity/scratch/schach/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

 [32mâœ“[39m tests/statistics.test.js [2m([22m[2m14 tests[22m[2m)[22m[32m 26[2mms[22m[39m
 [32mâœ“[39m tests/tutor.extra.test.js [2m([22m[2m7 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mâœ“[39m tests/logger.test.js [2m([22m[2m22 tests[22m[2m)[22m[32m 18[2mms[22m[39m
 [32mâœ“[39m tests/tutor/TacticsDetector.dynamic.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 13[2mms[22m[39m
[90mstdout[2m | tests/aiController.extra.test.js[2m > [22m[2mAIController Ultimate Precision V5 - Updated[2m > [22m[2maiMove - should resign based on material and score
[22m[39m[INFO] 17:59:57.724 [AI] Starting aiMove...

 [32mâœ“[39m tests/aiController.extra.test.js [2m([22m[2m2 tests[22m[2m)[22m[32m 10[2mms[22m[39m
[90mstdout[2m | tests/ai/aiEngine_coverage.test.ts[2m > [22m[2mAIEngine Coverage Boost[2m > [22m[2mgetBestMove - success path
[22m[39m[INFO] 17:59:58.168 [AiEngine] AI Worker initialized

[90mstdout[2m | tests/ai/aiEngine_coverage.test.ts[2m > [22m[2mAIEngine Coverage Boost[2m > [22m[2mgetBestMove - success path
[22m[39m[DEBUG] 17:59:58.170 [AiEngine] Received worker message: type=bestMove id=0

[90mstdout[2m | tests/ai/aiEngine_coverage.test.ts[2m > [22m[2mAIEngine Coverage Boost[2m > [22m[2mgetBestMove - success path
[22m[39m[DEBUG] 17:59:58.171 [AiEngine] Using Wasm Worker Result

[90mstdout[2m | tests/ai/aiEngine_coverage.test.ts[2m > [22m[2mAIEngine Coverage Boost[2m > [22m[2mgetBestMoveDetailed with Elo config
[22m[39m[DEBUG] 17:59:58.175 [AiEngine] Received worker message: type=bestMove id=1

[90mstdout[2m | tests/ai/aiEngine_coverage.test.ts[2m > [22m[2mAIEngine Coverage Boost[2m > [22m[2mgetBestMoveDetailed with Elo config
[22m[39m[DEBUG] 17:59:58.176 [AiEngine] Using Wasm Worker Result

 [32mâœ“[39m tests/ai/aiEngine_coverage.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m tests/postGameAnalysis.test.js [2m([22m[2m16 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m tests/aiWorker.test.js [2m([22m[2m1 test[22m[2m)[22m[32m 26[2mms[22m[39m
 [32mâœ“[39m tests/puzzle.test.js [2m([22m[2m9 tests[22m[2m)[22m[32m 16[2mms[22m[39m
[90mstdout[2m | tests/battleChess3D.dynamic.test.js[2m > [22m[2mBattleChess3D Dynamic Board Size[2m > [22m[2mShould calculate 9x9 coordinates correctly
[22m[39m[INFO] 17:59:58.594 [3D] BattleChess3D instance created (Modular)

[90mstdout[2m | tests/battleChess3D.dynamic.test.js[2m > [22m[2mBattleChess3D Dynamic Board Size[2m > [22m[2mShould calculate 9x9 coordinates correctly
[22m[39m[INFO] 17:59:58.597 Setting up 3D scene...
[ERROR] 17:59:58.597 Container has zero dimensions!

[90mstdout[2m | tests/battleChess3D.dynamic.test.js[2m > [22m[2mBattleChess3D Dynamic Board Size[2m > [22m[2mShould calculate 8x8 coordinates correctly
[22m[39m[INFO] 17:59:58.604 [3D] BattleChess3D instance created (Modular)

 [32mâœ“[39m tests/battleChess3D.dynamic.test.js [2m([22m[2m2 tests[22m[2m)[22m[32m 26[2mms[22m[39m
[90mstdout[2m | tests/campaignManager.test.js[2m > [22m[2mCampaignManager[2m > [22m[2mshould unlock rewards upon completion
[22m[39m[Campaign] Unlocked Reward: angel

[90mstdout[2m | tests/campaignManager.test.js[2m > [22m[2mCampaignManager[2m > [22m[2misRewardUnlocked should work correctly
[22m[39m[Campaign] Unlocked Reward: medal

 [32mâœ“[39m tests/campaignManager.test.js [2m([22m[2m5 tests[22m[2m)[22m[32m 20[2mms[22m[39m
[90mstdout[2m | tests/ai.advanced.test.js[2m > [22m[2mAI Advanced Evaluation Tests[2m > [22m[2mBishop Pair: should reward having two bishops
[22m[39m[INFO] 17:59:59.037 [WasmBridge] Initializing Wasm AI Engine...

[90mstderr[2m | tests/ai.advanced.test.js[2m > [22m[2mAI Advanced Evaluation Tests[2m > [22m[2mBishop Pair: should reward having two bishops
[22m[39musing deprecated parameters for the initialization function; pass a single object instead

[90mstdout[2m | tests/ai.advanced.test.js[2m > [22m[2mAI Advanced Evaluation Tests[2m > [22m[2mBishop Pair: should reward having two bishops
[22m[39m[INFO] 17:59:59.057 [WasmBridge] Wasm AI Engine initialized successfully.

 [32mâœ“[39m tests/ai.advanced.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 28[2mms[22m[39m
 [32mâœ“[39m tests/ai/OpeningDatabase.unit.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 7[2mms[22m[39m
[90mstdout[2m | tests/shopManager.test.js[2m > [22m[2mShopManager[2m > [22m[2mperformUpgrade[2m > [22m[2mshould upgrade knight to nightrider and deduct correct points
[22m[39m[ShopManager] performUpgrade called: { r: [33m7[39m, c: [33m4[39m, targetType: [32m'j'[39m }
[ShopManager] Deducting points and updating piece type

[90mstdout[2m | tests/shopManager.test.js[2m > [22m[2mShopManager[2m > [22m[2mperformUpgrade[2m > [22m[2mshould allow chain upgrade: Knight -> Nightrider -> Chancellor
[22m[39m[ShopManager] performUpgrade called: { r: [33m7[39m, c: [33m4[39m, targetType: [32m'j'[39m }
[ShopManager] Deducting points and updating piece type
[ShopManager] performUpgrade called: { r: [33m7[39m, c: [33m4[39m, targetType: [32m'c'[39m }
[ShopManager] Deducting points and updating piece type

 [32mâœ“[39m tests/shopManager.test.js [2m([22m[2m14 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m tests/gameEngine.pieces.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m tests/puzzleManager.test.js [2m([22m[2m14 tests[22m[2m)[22m[32m 19[2mms[22m[39m
[90mstdout[2m | tests/modes/upgrade8x8Mode.test.js
[22m[39m[INFO] 18:00:00.036 StatisticsManager initialized

[90mstdout[2m | tests/modes/upgrade8x8Mode.test.js[2m > [22m[2m8x8 Upgrade Mode[2m > [22m[2mInitial State should have 15 points and 8x8 setup
[22m[39m[INFO] 18:00:00.093 StatisticsManager initialized
[INFO] 18:00:00.094 StandardModeStrategy initialized with [33m15[39m points
[INFO] 18:00:00.098 Game initialized with [33m15[39m points in mode: upgrade8x8

[90mstdout[2m | tests/modes/upgrade8x8Mode.test.js[2m > [22m[2m8x8 Upgrade Mode[2m > [22m[2mTransitions correctly using 15 points
[22m[39m[INFO] 18:00:00.103 StatisticsManager initialized
[INFO] 18:00:00.103 StandardModeStrategy initialized with [33m15[39m points
[INFO] 18:00:00.103 Game initialized with [33m15[39m points in mode: upgrade8x8

[90mstdout[2m | tests/modes/upgrade8x8Mode.test.js[2m > [22m[2m8x8 Upgrade Mode[2m > [22m[2mTransitions correctly using 15 points
[22m[39m[INFO] 18:00:00.106 [Storage] Game saved to schach9x9_save_autosave (1961 bytes)
[DEBUG] 18:00:00.106 Auto-saved game

 [32mâœ“[39m tests/modes/upgrade8x8Mode.test.js [2m([22m[2m2 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m tests/proceduralGenerator.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 27[2mms[22m[39m
 [32mâœ“[39m tests/AnalysisController.test.js [2m([22m[2m14 tests[22m[2m)[22m[32m 46[2mms[22m[39m
 [32mâœ“[39m tests/moveAnalyzer.test.js [2m([22m[2m22 tests[22m[2m)[22m[32m 33[2mms[22m[39m
 [32mâœ“[39m tests/timeManager.test.js [2m([22m[2m9 tests[22m[2m)[22m[32m 33[2mms[22m[39m
 [32mâœ“[39m tests/gameEngine.classic.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 21[2mms[22m[39m
 [32mâœ“[39m tests/gameEngine.edge.test.js [2m([22m[2m7 tests[22m[2m)[22m[32m 36[2mms[22m[39m
[90mstdout[2m | tests/upgradeMode.unit.test.js[2m > [22m[2mTroop Upgrade Mode - Unit Tests[2m > [22m[2mshould upgrade piece and deduct points
[22m[39m[ShopManager] performUpgrade called: { r: [33m7[39m, c: [33m4[39m, targetType: [32m'e'[39m }
[ShopManager] Deducting points and updating piece type

[90mstdout[2m | tests/upgradeMode.unit.test.js[2m > [22m[2mTroop Upgrade Mode - Unit Tests[2m > [22m[2mshould not upgrade if points are insufficient
[22m[39m[ShopManager] performUpgrade called: { r: [33m7[39m, c: [33m4[39m, targetType: [32m'e'[39m }

[90mstderr[2m | tests/upgradeMode.unit.test.js[2m > [22m[2mTroop Upgrade Mode - Unit Tests[2m > [22m[2mshould not upgrade if points are insufficient
[22m[39m[ShopManager] Not enough points: [33m2[39m < [33m3[39m

 [32mâœ“[39m tests/upgradeMode.unit.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m tests/tutorController.unit.test.js [2m([22m[2m12 tests[22m[2m)[22m[32m 17[2mms[22m[39m
 [32mâœ“[39m tests/ai/aiStrategy.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m tests/moveAnalyzer.unit.test.js [2m([22m[2m4 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m tests/openingBook.test.js [2m([22m[2m6 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m tests/swarm_and_ai_fix.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m tests/ai/SEE.unit.test.js [2m([22m[2m6 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m tests/tutorImprovements.test.js [2m([22m[2m5 tests[22m[2m)[22m[32m 8[2mms[22m[39m
[90mstdout[2m | tests/statisticsManager.tutor.test.js
[22m[39m[INFO] 18:00:03.690 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.tutor.test.js[2m > [22m[2mStatisticsManager - Tutor Points[2m > [22m[2mshould return 0 tutor points by default
[22m[39m[INFO] 18:00:03.701 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.tutor.test.js[2m > [22m[2mStatisticsManager - Tutor Points[2m > [22m[2mshould save and load tutor points
[22m[39m[INFO] 18:00:03.704 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.tutor.test.js[2m > [22m[2mStatisticsManager - Tutor Points[2m > [22m[2mshould save and load tutor points
[22m[39m[DEBUG] 18:00:03.705 Game history saved to storage
[DEBUG] 18:00:03.705 Tutor points saved: 150
[INFO] 18:00:03.706 Loaded 0 games from storage
[INFO] 18:00:03.706 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.tutor.test.js[2m > [22m[2mStatisticsManager - Tutor Points[2m > [22m[2mshould persist in default data structure
[22m[39m[INFO] 18:00:03.706 StatisticsManager initialized

[90mstdout[2m | tests/statisticsManager.tutor.test.js[2m > [22m[2mStatisticsManager - Tutor Points[2m > [22m[2mshould persist in default data structure
[22m[39m[DEBUG] 18:00:03.707 Game history saved to storage
[INFO] 18:00:03.707 Game history cleared

 [32mâœ“[39m tests/statisticsManager.tutor.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m tests/ai/perft.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m tests/aiEngine.structure.test.js [2m([22m[2m5 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m tests/BoardFactory.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 5[2mms[22m[39m
[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2manalyzePosition - starts workers if needed
[22m[39m[DEBUG] 18:00:04.392 [AI] Initializing pool with 4 workers

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2manalyzePosition - starts workers if needed
[22m[39m[INFO] 18:00:04.393 [AIController] Opening book loaded successfully. Positions: 0

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2maiMove - handles successful worker results
[22m[39m[DEBUG] 18:00:04.419 [AI] Initializing pool with 4 workers
[INFO] 18:00:04.420 [AI] Starting aiMove...
[DEBUG] MockWorker emit: message
[DEBUG] MockWorker calling onmessage

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2maiMove - handles successful worker results
[22m[39m[INFO] 18:00:04.420 [AIController] Opening book loaded successfully. Positions: 0

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2maiMove - handles successful worker results
[22m[39m[DEBUG] 18:00:04.422 [AI] Difficulty medium: using depth 3
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:04.422 [AI] Dispatching search to worker 0
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:04.423 [AI] Dispatching search to worker 1
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:04.423 [AI] Dispatching search to worker 2
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:04.423 [AI] Dispatching search to worker 3

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2maiMove - fallback on timeout
[22m[39m[INFO] 18:00:09.437 [AI] Starting aiMove...

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2maiMove - fallback on timeout
[22m[39m[DEBUG] 18:00:09.437 [AI] Initializing pool with 4 workers
[DEBUG] 18:00:09.437 [AI] Difficulty medium: using depth 3
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:09.437 [AI] Dispatching search to worker 0
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:09.437 [AI] Dispatching search to worker 1
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:09.437 [AI] Dispatching search to worker 2
[DEBUG] MockWorker addEventListener: message
[DEBUG] 18:00:09.437 [AI] Dispatching search to worker 3

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2maiMove - fallback on timeout
[22m[39m[INFO] 18:00:09.437 [AIController] Opening book loaded successfully. Positions: 0

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2maiMove - fallback on timeout
[22m[39m[ERROR] 18:00:39.437 [AI] Worker timeout after 30 seconds! Making fallback move.

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2mtoggleAnalysisMode - toggles active state
[22m[39m[DEBUG] 18:00:09.450 [AI] Initializing pool with 4 workers

[90mstdout[2m | tests/ai/AIController_coverage.test.ts[2m > [22m[2mAIController Coverage Boost[2m > [22m[2mtoggleAnalysisMode - toggles active state
[22m[39m[INFO] 18:00:09.451 [AIController] Opening book loaded successfully. Positions: 0


<--- Last few GCs --->

[287006:0x2fca9000]    29012 ms: Scavenge (interleaved) 4032.7 (4051.3) -> 4019.4 (4052.8) MB, pooled: 0 MB, 3.65 / 0.00 ms  (average mu = 0.276, current mu = 0.231) allocation failure; 
[287006:0x2fca9000]    30647 ms: Mark-Compact (reduce) 4053.3 (4072.0) -> 4026.4 (4030.5) MB, pooled: 0 MB, 29.66 / 0.00 ms  (+ 1546.2 ms in 296 steps since start of marking, biggest step 25.2 ms, walltime since start of marking 1629 ms) (average mu = 0.2
FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory
----- Native stack trace -----

 1: 0x72ded8 node::OOMErrorHandler(char const*, v8::OOMDetails const&) [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 2: 0xba1870  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 3: 0xba195f  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 4: 0xe3a495  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 5: 0xe3a4c2  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 6: 0xe3a7ba  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 7: 0xe4acda  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 8: 0xe4f080  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]
 9: 0x18e2041  [/home/tobber/.nvm/versions/node/v24.12.0/bin/node]

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Tests 8 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m tests/analysis.test.js[2m > [22mAnalysisManager[2m > [22mshould generate threat arrows correctly
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m tests/analysis.test.js:[2m58:27[22m[39m
    [90m 56| [39m    [35mconst[39m arrows [33m=[39m analysisManager[33m.[39m[34mgetThreatArrows[39m()[33m;[39m
    [90m 57| [39m
    [90m 58| [39m    [34mexpect[39m(arrows[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m 59| [39m    [34mexpect[39m(arrows[[34m0[39m])[33m.[39m[34mtoMatchObject[39m({
    [90m 60| [39m      fromR[33m:[39m [34m0[39m[33m,[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/8]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m tests/analysis.test.js[2m > [22mAnalysisManager[2m > [22mshould only show serious threats
[31m[1mAssertionError[22m: expected +0 to be 1 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 0[39m

[36m [2mâ¯[22m tests/analysis.test.js:[2m109:27[22m[39m
    [90m107| [39m    mockGame[33m.[39mboard[[34m8[39m][[34m6[39m] [33m=[39m [35mnull[39m[33m;[39m
    [90m108| [39m    arrows [33m=[39m analysisManager[33m.[39m[34mgetThreatArrows[39m()[33m;[39m
    [90m109| [39m    [34mexpect[39m(arrows[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m1[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m110| [39m  })[33m;[39m
    [90m111| [39m  test('should generate opportunity arrows for high severity patterns â€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/8]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m tests/snapshots.test.js[2m > [22mVisual DOM Snapshot Tests[2m > [22mInitial setup phase snapshot
[31m[1mError[22m: Snapshot `Visual DOM Snapshot Tests > Initial setup phase snapshot 1` mismatched[39m

[32m- Expected[39m
[31m+ Received[39m

[2m  "[22m

[32m-   [39m
[32m-     <meta charset="UTF-8">[39m
[32m-     <meta name="viewport" content="width=device-width, initial-scale=1.0">[39m
[32m-     <meta name="description" content="Ein Schachspiel auf einem 9x9 Brett mit neuen Figuren und Regeln.">[39m
[32m-     <meta name="theme-color" content="#0a0e27">[39m
[32m-     <title>Schach 9x9</title>[39m
[32m-     <link rel="manifest" href="manifest.json">[39m
[32m-     <link rel="icon" type="image/png" href="icon-192.png">[39m
[32m-     <link rel="stylesheet" href="style.css">[39m
[32m-     <!-- Google Fonts -->[39m
[32m-     <link rel="preconnect" href="https://fonts.googleapis.com">[39m
[32m-     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">[39m
[32m-     <link rel="stylesheet" href="css/notifications.css">[39m
[32m-     <link rel="stylesheet" href="css/menu.css">[39m
[32m-     <link rel="stylesheet" href="css/tutorial.css">[39m
[32m-     <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&amp;display=swap" rel="stylesheet">[39m
[31m+[39m
[31m+[39m
[31m+   <meta charset="UTF-8">[39m
[31m+   <meta name="viewport" content="width=device-width, initial-scale=1.0">[39m
[31m+   <meta name="description" content="Ein Schachspiel auf einem 9x9 Brett mit neuen Figuren und Regeln.">[39m
[31m+   <meta name="theme-color" content="#0a0e27">[39m
[31m+   <title>Schach 9x9</title>[39m
[31m+   <link rel="manifest" href="manifest.json">[39m
[31m+   <link rel="icon" type="image/png" href="icon-192.png">[39m
[31m+   <link rel="stylesheet" href="style.css">[39m
[31m+   <!-- Google Fonts -->[39m
[31m+   <link rel="preconnect" href="https://fonts.googleapis.com">[39m
[31m+   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">[39m
[31m+   <link rel="stylesheet" href="css/notifications.css">[39m
[31m+   <link rel="stylesheet" href="css/menu.css">[39m
[31m+   <link rel="stylesheet" href="css/tutorial.css">[39m
[31m+   <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&amp;display=swap" rel="stylesheet">[39m

[32m-     <!-- Import Map for Three.js (using jsDelivr CDN for better reliability) -->[39m
[32m-     <script type="importmap">[39m
[31m+   <!-- Import Map for Three.js (using jsDelivr CDN for better reliability) -->[39m
[31m+   <script type="importmap">[39m
[2m        {[22m
[2m          "imports": {[22m
[2m            "three": "https://cdn.jsdelivr.net/npm/three@0.160.1/build/three.module.js",[22m
[2m            "three/examples/jsm/controls/OrbitControls.js": "https://cdn.jsdelivr.net/npm/three@0.160.1/examples/jsm/controls/OrbitControls.js"[22m
[2m          }[22m
[2m        }[22m
[2m      </script>[22m
[32m-   [39m
[31m+[39m

[32m-   [39m
[32m-     <!-- Hidden H1 for Accessibility -->[39m
[32m-     <h1 class="hidden">Schach 9x9</h1>[39m
[32m-     <!-- TOP LAYER: System-level notifications, errors, and loading -->[39m
[32m-     <div id="top-layer">[39m
[32m-       <!-- Toast Notifications Container -->[39m
[32m-       <div id="toast-container"></div>[39m
[31m+[39m
[31m+   <!-- Hidden H1 for Accessibility -->[39m
[31m+   <h1 class="hidden">Schach 9x9</h1>[39m
[31m+   <!-- TOP LAYER: System-level notifications, errors, and loading -->[39m
[31m+   <div id="top-layer">[39m
[31m+     <!-- Toast Notifications Container -->[39m
[31m+     <div id="toast-container"></div>[39m

[32m-       <!-- Spinner Overlay -->[39m
[32m-       <div id="spinner-overlay" class="modal-overlay hidden">[39m
[32m-         <div class="ai-thinking-panel">[39m
[32m-           <div class="spinner"></div>[39m
[32m-           <div style="margin-top: 16px; font-size: 1.2em; font-weight: 600">KI denkt nach...</div>[39m
[32m-           <div class="ai-status">[39m
[32m-             <div id="ai-depth">Calculating...</div>[39m
[32m-             <div id="ai-nodes">0 Positionen</div>[39m
[32m-             <div id="ai-best-move"></div>[39m
[32m-           </div>[39m
[32m-           <div class="progress-bar-container">[39m
[32m-             <div id="progress-fill"></div>[39m
[32m-           </div>[39m
[31m+     <!-- Spinner Overlay -->[39m
[31m+     <div id="spinner-overlay" class="modal-overlay hidden">[39m
[31m+       <div class="ai-thinking-panel">[39m
[31m+         <div class="spinner"></div>[39m
[31m+         <div style="margin-top: 16px; font-size: 1.2em; font-weight: 600">KI denkt nach...</div>[39m
[31m+         <div class="ai-status">[39m
[31m+           <div id="ai-depth">Calculating...</div>[39m
[31m+           <div id="ai-nodes">0 Positionen</div>[39m
[31m+           <div id="ai-best-move"></div>[39m
[2m          </div>[22m
[31m+         <div class="progress-bar-container">[39m
[31m+           <div id="progress-fill"></div>[39m
[31m+         </div>[39m
[2m        </div>[22m
[31m+     </div>[39m

[32m-       <!-- Error Overlay -->[39m
[32m-       <div id="error-overlay" class="modal-overlay hidden">[39m
[32m-         <div class="critical-error-content">[39m
[32m-           <h2>Ein Fehler ist aufgetreten</h2>[39m
[32m-           <div id="error-message"></div>[39m
[32m-           <button class="btn-primary" onclick="location.reload()">Neustarten</button>[39m
[32m-         </div>[39m
[31m+     <!-- Error Overlay -->[39m
[31m+     <div id="error-overlay" class="modal-overlay hidden">[39m
[31m+       <div class="critical-error-content">[39m
[31m+         <h2>Ein Fehler ist aufgetreten</h2>[39m
[31m+         <div id="error-message"></div>[39m
[31m+         <button class="btn-primary" onclick="location.reload()">Neustarten</button>[39m
[2m        </div>[22m
[2m      </div>[22m
[31m+   </div>[39m

[32m-     <!-- GAME LAYER: Main board and game controls -->[39m
[32m-     <div id="game-layer">[39m
[32m-       <div id="app-container">[39m
[32m-         <!-- Minimal Header -->[39m
[32m-         <header class="minimal-header">[39m
[32m-           <div class="logo">[39m
[32m-             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px; vertical-align: bottom">[39m
[32m-               <rect width="18" height="18" x="3" y="3" rx="2"></rect>[39m
[32m-               <path d="M7 7h10"></path>[39m
[32m-               <path d="M7 12h10"></path>[39m
[32m-               <path d="M7 17h10"></path>[39m
[32m-               <path d="M12 3v18"></path>[39m
[32m-             </svg>[39m
[32m-             Schach 9x9[39m
[32m-           </div>[39m
[32m-           <div id="status-display" data-testid="status-display" class="status-pill">WeiÃŸ: WÃ¤hle einen Korridor fÃ¼r den KÃ¶nig</div>[39m
[32m-           <button id="menu-btn" class="icon-btn" aria-label="MenÃ¼ Ã¶ffnen">[39m
[32m-             <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">[39m
[32m-               <line x1="3" y1="12" x2="21" y2="12"></line>[39m
[32m-               <line x1="3" y1="6" x2="21" y2="6"></line>[39m
[32m-               <line x1="3" y1="18" x2="21" y2="18"></line>[39m
[32m-             </svg>[39m
[32m-           </button>[39m
[32m-         </header>[39m
[31m+   <!-- GAME LAYER: Main board and game controls -->[39m
[31m+   <div id="game-layer">[39m
[31m+     <div id="app-container">[39m
[31m+       <!-- Minimal Header -->[39m
[31m+       <header class="minimal-header">[39m
[31m+         <div class="logo">[39m
[31m+           <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px; vertical-align: bottom">[39m
[31m+             <rect width="18" height="18" x="3" y="3" rx="2"></rect>[39m
[31m+             <path d="M7 7h10"></path>[39m
[31m+             <path d="M7 12h10"></path>[39m
[31m+             <path d="M7 17h10"></path>[39m
[31m+             <path d="M12 3v18"></path>[39m
[31m+           </svg>[39m
[31m+           Schach 9x9[39m
[31m+         </div>[39m
[31m+         <div id="status-display" data-testid="status-display" class="status-pill">WeiÃŸ: WÃ¤hle einen Korridor fÃ¼r den KÃ¶nig</div>[39m
[31m+         <button id="menu-btn" class="icon-btn" aria-label="MenÃ¼ Ã¶ffnen">[39m
[31m+           <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">[39m
[31m+             <line x1="3" y1="12" x2="21" y2="12"></line>[39m
[31m+             <line x1="3" y1="6" x2="21" y2="6"></line>[39m
[31m+             <line x1="3" y1="18" x2="21" y2="18"></line>[39m
[31m+           </svg>[39m
[31m+         </button>[39m
[31m+       </header>[39m

[32m-         <!-- Main Game Area -->[39m
[32m-         <div class="game-area" role="main">[39m
[32m-           <!-- Opponent Info / Clock -->[39m
[32m-           <div class="player-info opponent">[39m
[32m-             <div class="player-details">[39m
[32m-               <div style="display: flex; align-items: center">[39m
[32m-                 <div class="player-avatar">[39m
[32m-                   <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[32m-                     <path d="M12 8V4H8"></path>[39m
[32m-                     <rect width="16" height="12" x="4" y="8" rx="2"></rect>[39m
[32m-                     <path d="M2 14h2"></path>[39m
[32m-                     <path d="M20 14h2"></path>[39m
[32m-                     <path d="M15 13v2"></path>[39m
[32m-                     <path d="M9 13v2"></path>[39m
[32m-                   </svg>[39m
[32m-                 </div>[39m
[32m-                 <div>[39m
[32m-                   <div class="player-name">Gegner</div>[39m
[32m-                   <div class="captured-pieces" id="captured-white"></div>[39m
[32m-                 </div>[39m
[31m+       <!-- Main Game Area -->[39m
[31m+       <div class="game-area" role="main">[39m
[31m+         <!-- Opponent Info / Clock -->[39m
[31m+         <div class="player-info opponent">[39m
[31m+           <div class="player-details">[39m
[31m+             <div style="display: flex; align-items: center">[39m
[31m+               <div class="player-avatar">[39m
[31m+                 <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[31m+                   <path d="M12 8V4H8"></path>[39m
[31m+                   <rect width="16" height="12" x="4" y="8" rx="2"></rect>[39m
[31m+                   <path d="M2 14h2"></path>[39m
[31m+                   <path d="M20 14h2"></path>[39m
[31m+                   <path d="M15 13v2"></path>[39m
[31m+                   <path d="M9 13v2"></path>[39m
[31m+                 </svg>[39m
[31m+               </div>[39m
[31m+               <div>[39m
[31m+                 <div class="player-name">Gegner</div>[39m
[31m+                 <div class="captured-pieces" id="captured-white"></div>[39m
[2m                </div>[22m
[2m              </div>[22m
[32m-             <div class="clock-display" id="clock-black">5:00</div>[39m
[2m            </div>[22m
[31m+           <div class="clock-display" id="clock-black">5:00</div>[39m
[31m+         </div>[39m

[32m-           <!-- Opening Name Display -->[39m
[32m-           <div id="opening-name-container" class="hidden">[39m
[32m-             ErÃ¶ffnung: <span id="opening-name">...</span>[39m
[32m-           </div>[39m
[31m+         <!-- Opening Name Display -->[39m
[31m+         <div id="opening-name-container" class="hidden">[39m
[31m+           ErÃ¶ffnung: <span id="opening-name">...</span>[39m
[31m+         </div>[39m
[31m+[39m
[31m+         <!-- Chess Board -->[39m
[31m+         <div id="board-container">[39m
[31m+[39m
[31m+[39m
[31m+           <!-- 3D Battle Chess Container -->[39m
[31m+           <div id="battle-chess-3d-container"></div>[39m
[31m+[39m
[31m+           <div id="board-wrapper" aria-label="Schachbrett" role="region">[39m
[31m+             <div id="board" data-testid="board" class="board-9x9" style="grid-template-columns: repeat(9, 1fr); grid-template-rows: repeat(9, 1fr);"><div class="cell light" data-r="0" data-c="0" draggable="true"></div><div class="cell dark" data-r="0" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="0" data-c="2" draggable="true"></div><div class="cell dark" data-r="0" data-c="3" draggable="true"></div><div class="cell light" data-r="0" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="0" data-c="5" draggable="true"></div><div class="cell light" data-r="0" data-c="6" draggable="true"></div><div class="cell dark" data-r="0" data-c="7" draggable="true"></div><div class="cell light" data-r="0" data-c="8" draggable="true"></div><div class="cell dark" data-r="1" data-c="0" draggable="true"></div><div class="cell light" data-r="1" data-c="1" draggable="true"></div><div class="cell dark border-right" data-r="1" data-c="2" draggable="true"></div><div class="cell light" data-r="1" data-c="3" draggable="true"></div><div class="cell dark" data-r="1" data-c="4" draggable="true"></div><div class="cell light border-right" data-r="1" data-c="5" draggable="true"></div><div class="cell dark" data-r="1" data-c="6" draggable="true"></div><div class="cell light" data-r="1" data-c="7" draggable="true"></div><div class="cell dark" data-r="1" data-c="8" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="0" draggable="true"></div><div class="cell dark border-bottom" data-r="2" data-c="1" draggable="true"></div><div class="cell light border-right border-bottom" data-r="2" data-c="2" draggable="true"></div><div class="cell dark border-bottom" data-r="2" data-c="3" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="4" draggable="true"></div><div class="cell dark border-right border-bottom" data-r="2" data-c="5" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="6" draggable="true"></div><div class="cell dark border-bottom" data-r="2" data-c="7" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="8" draggable="true"></div><div class="cell dark" data-r="3" data-c="0" draggable="true"></div><div class="cell light" data-r="3" data-c="1" draggable="true"></div><div class="cell dark border-right" data-r="3" data-c="2" draggable="true"></div><div class="cell light" data-r="3" data-c="3" draggable="true"></div><div class="cell dark" data-r="3" data-c="4" draggable="true"></div><div class="cell light border-right" data-r="3" data-c="5" draggable="true"></div><div class="cell dark" data-r="3" data-c="6" draggable="true"></div><div class="cell light" data-r="3" data-c="7" draggable="true"></div><div class="cell dark" data-r="3" data-c="8" draggable="true"></div><div class="cell light" data-r="4" data-c="0" draggable="true"></div><div class="cell dark" data-r="4" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="4" data-c="2" draggable="true"></div><div class="cell dark" data-r="4" data-c="3" draggable="true"></div><div class="cell light" data-r="4" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="4" data-c="5" draggable="true"></div><div class="cell light" data-r="4" data-c="6" draggable="true"></div><div class="cell dark" data-r="4" data-c="7" draggable="true"></div><div class="cell light" data-r="4" data-c="8" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="0" draggable="true"></div><div class="cell light border-bottom" data-r="5" data-c="1" draggable="true"></div><div class="cell dark border-right border-bottom" data-r="5" data-c="2" draggable="true"></div><div class="cell light border-bottom" data-r="5" data-c="3" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="4" draggable="true"></div><div class="cell light border-right border-bottom" data-r="5" data-c="5" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="6" draggable="true"></div><div class="cell light border-bottom" data-r="5" data-c="7" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="8" draggable="true"></div><div class="cell light" data-r="6" data-c="0" draggable="true"></div><div class="cell dark" data-r="6" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="6" data-c="2" draggable="true"></div><div class="cell dark" data-r="6" data-c="3" draggable="true"></div><div class="cell light" data-r="6" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="6" data-c="5" draggable="true"></div><div class="cell light" data-r="6" data-c="6" draggable="true"></div><div class="cell dark" data-r="6" data-c="7" draggable="true"></div><div class="cell light" data-r="6" data-c="8" draggable="true"></div><div class="cell dark" data-r="7" data-c="0" draggable="true"></div><div class="cell light" data-r="7" data-c="1" draggable="true"></div><div class="cell dark border-right" data-r="7" data-c="2" draggable="true"></div><div class="cell light" data-r="7" data-c="3" draggable="true"></div><div class="cell dark" data-r="7" data-c="4" draggable="true"></div><div class="cell light border-right" data-r="7" data-c="5" draggable="true"></div><div class="cell dark" data-r="7" data-c="6" draggable="true"></div><div class="cell light" data-r="7" data-c="7" draggable="true"></div><div class="cell dark" data-r="7" data-c="8" draggable="true"></div><div class="cell light" data-r="8" data-c="0" draggable="true"></div><div class="cell dark" data-r="8" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="8" data-c="2" draggable="true"></div><div class="cell dark" data-r="8" data-c="3" draggable="true"></div><div class="cell light" data-r="8" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="8" data-c="5" draggable="true"></div><div class="cell light" data-r="8" data-c="6" draggable="true"></div><div class="cell dark" data-r="8" data-c="7" draggable="true"></div><div class="cell light" data-r="8" data-c="8" draggable="true"></div></div>[39m
[31m+           <div class="col-labels" style="grid-template-columns: repeat(9, 1fr);"><span class="coord-label">a</span><span class="coord-label">b</span><span class="coord-label">c</span><span class="coord-label">d</span><span class="coord-label">e</span><span class="coord-label">f</span><span class="coord-label">g</span><span class="coord-label">h</span><span class="coord-label">i</span></div><div class="row-labels" style="grid-template-rows: repeat(9, 1fr);"><span class="coord-label">9</span><span class="coord-label">8</span><span class="coord-label">7</span><span class="coord-label">6</span><span class="coord-label">5</span><span class="coord-label">4</span><span class="coord-label">3</span><span class="coord-label">2</span><span class="coord-label">1</span></div></div>[39m
[31m+         </div>[39m
[31m+[39m
[31m+         <!-- Evaluation Graph -->[39m
[31m+         <div id="eval-graph-container" class="eval-graph-container hidden">[39m
[31m+           <svg id="eval-graph" preserveAspectRatio="none" viewBox="0 0 1000 100"></svg>[39m
[31m+         </div>[39m

[32m-           <!-- Chess Board -->[39m
[32m-           <div id="board-container">[39m
[32m-             <!-- Vertical Evaluation Bar -->[39m
[32m-             <div id="evaluation-bar" class="evaluation-bar hidden">[39m
[32m-               <div id="eval-fill"></div>[39m
[32m-               <div id="eval-text">0.0</div>[39m
[32m-               <div id="eval-marker"></div>[39m
[31m+         <!-- Player Info / Clock -->[39m
[31m+         <div class="player-info self">[39m
[31m+           <div class="player-details">[39m
[31m+             <div style="display: flex; align-items: center">[39m
[31m+               <div class="player-avatar">[39m
[31m+                 <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[31m+                   <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>[39m
[31m+                   <circle cx="12" cy="7" r="4"></circle>[39m
[31m+                 </svg>[39m
[31m+               </div>[39m
[31m+               <div>[39m
[31m+                 <div class="player-name">Du</div>[39m
[31m+                 <div class="captured-pieces" id="captured-black"></div>[39m
[31m+               </div>[39m
[2m              </div>[22m
[31m+           </div>[39m
[31m+           <div class="clock-display" id="clock-white">5:00</div>[39m
[31m+         </div>[39m

[32m-             <!-- 3D Battle Chess Container -->[39m
[32m-             <div id="battle-chess-3d-container"></div>[39m
[31m+         <!-- Action Bar -->[39m
[31m+         <div class="action-bar">[39m
[31m+           <button id="undo-btn" class="action-icon-btn" title="RÃ¼ckgÃ¤ngig (U)">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[31m+               <path d="M3 7v6h6"></path>[39m
[31m+               <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <button id="hint-btn" class="action-icon-btn" title="Tipps anzeigen (H)">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[31m+               <path d="M9.663 17h4.673M12 3v1M6.343 4.343l-.707-.707M17.657 4.343l.707-.707M4 12h1M19 12h1M12 21a9 9 0 0 0 9-9c0-4.97-4.03-9-9-9s-9 4.03-9 9a9 9 0 0 0 9 9z">[39m
[31m+               </path>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <button id="best-move-btn" class="action-icon-btn" title="Besten Zug anzeigen (B)">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="#22c55e" stroke-width="2" fill="none">[39m
[31m+               <polyline points="20 6 9 17 4 12"></polyline>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <button id="threats-btn" class="action-icon-btn" title="Drohungen visualisieren (T)">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="#ef4444" stroke-width="2" fill="none">[39m
[31m+               <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>[39m
[31m+               <line x1="12" y1="9" x2="12" y2="13"></line>[39m
[31m+               <line x1="12" y1="17" x2="12.01" y2="17"></line>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <button id="opportunities-btn" class="action-icon-btn" title="Chancen anzeigen (O)">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="#f59e0b" stroke-width="2" fill="none">[39m
[31m+               <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2">[39m
[31m+               </polygon>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <button id="toggle-analysis-btn" class="action-icon-btn" title="Engine Analyse (A)">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="var(--accent-primary)" stroke-width="2" fill="none">[39m
[31m+               <path d="M12 20v-8m-4 8v-4m8 4v-6m-12 6h16"></path>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <button id="toggle-3d-btn" class="action-icon-btn" title="3D Battle Modus (3)">[39m
[31m+             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[31m+               <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>[39m
[31m+               <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>[39m
[31m+               <line x1="12" y1="22.08" x2="12" y2="12"></line>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <select id="skin-selector" class="skin-selector" title="Figuren-Skin auswÃ¤hlen" aria-label="Figuren-Skin auswÃ¤hlen">[39m
[31m+             <option value="classic">Klassisch</option>[39m
[31m+             <option value="modern">Modern</option>[39m
[31m+             <option value="pixel">Pixel</option>[39m
[31m+             <option value="infernale">Infernale</option>[39m
[31m+             <option value="wood">Holz</option>[39m
[31m+             <option value="neon">Neon</option>[39m
[31m+             <option value="minimalist">Minimalistisch</option>[39m
[31m+           </select>[39m
[31m+           <button id="info-toggle-btn" class="action-icon-btn" title="Info / Log">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[31m+               <circle cx="12" cy="12" r="10"></circle>[39m
[31m+               <line x1="12" y1="16" x2="12" y2="12"></line>[39m
[31m+               <line x1="12" y1="8" x2="12.01" y2="8"></line>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+           <button id="fullscreen-btn" class="action-icon-btn" title="Vollbild (F)">[39m
[31m+             <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[31m+               <path d="M8 3H5a2 2 0 0 0-2 2v3"></path>[39m
[31m+               <path d="M21 8V5a2 2 0 0 0-2-2h-3"></path>[39m
[31m+               <path d="M3 16v3a2 2 0 0 0 2 2h3"></path>[39m
[31m+               <path d="M16 21h3a2 2 0 0 0 2-2v-3"></path>[39m
[31m+             </svg>[39m
[31m+           </button>[39m
[31m+         </div>[39m
[31m+       </div>[39m

[32m-             <div id="board-wrapper" aria-label="Schachbrett" role="region">[39m
[32m-               <div id="board" data-testid="board" class="board-9x9" style="grid-template-columns: repeat(9, 1fr); grid-template-rows: repeat(9, 1fr);"><div class="cell light" data-r="0" data-c="0" draggable="true"></div><div class="cell dark" data-r="0" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="0" data-c="2" draggable="true"></div><div class="cell dark" data-r="0" data-c="3" draggable="true"></div><div class="cell light" data-r="0" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="0" data-c="5" draggable="true"></div><div class="cell light" data-r="0" data-c="6" draggable="true"></div><div class="cell dark" data-r="0" data-c="7" draggable="true"></div><div class="cell light" data-r="0" data-c="8" draggable="true"></div><div class="cell dark" data-r="1" data-c="0" draggable="true"></div><div class="cell light" data-r="1" data-c="1" draggable="true"></div><div class="cell dark border-right" data-r="1" data-c="2" draggable="true"></div><div class="cell light" data-r="1" data-c="3" draggable="true"></div><div class="cell dark" data-r="1" data-c="4" draggable="true"></div><div class="cell light border-right" data-r="1" data-c="5" draggable="true"></div><div class="cell dark" data-r="1" data-c="6" draggable="true"></div><div class="cell light" data-r="1" data-c="7" draggable="true"></div><div class="cell dark" data-r="1" data-c="8" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="0" draggable="true"></div><div class="cell dark border-bottom" data-r="2" data-c="1" draggable="true"></div><div class="cell light border-right border-bottom" data-r="2" data-c="2" draggable="true"></div><div class="cell dark border-bottom" data-r="2" data-c="3" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="4" draggable="true"></div><div class="cell dark border-right border-bottom" data-r="2" data-c="5" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="6" draggable="true"></div><div class="cell dark border-bottom" data-r="2" data-c="7" draggable="true"></div><div class="cell light border-bottom" data-r="2" data-c="8" draggable="true"></div><div class="cell dark" data-r="3" data-c="0" draggable="true"></div><div class="cell light" data-r="3" data-c="1" draggable="true"></div><div class="cell dark border-right" data-r="3" data-c="2" draggable="true"></div><div class="cell light" data-r="3" data-c="3" draggable="true"></div><div class="cell dark" data-r="3" data-c="4" draggable="true"></div><div class="cell light border-right" data-r="3" data-c="5" draggable="true"></div><div class="cell dark" data-r="3" data-c="6" draggable="true"></div><div class="cell light" data-r="3" data-c="7" draggable="true"></div><div class="cell dark" data-r="3" data-c="8" draggable="true"></div><div class="cell light" data-r="4" data-c="0" draggable="true"></div><div class="cell dark" data-r="4" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="4" data-c="2" draggable="true"></div><div class="cell dark" data-r="4" data-c="3" draggable="true"></div><div class="cell light" data-r="4" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="4" data-c="5" draggable="true"></div><div class="cell light" data-r="4" data-c="6" draggable="true"></div><div class="cell dark" data-r="4" data-c="7" draggable="true"></div><div class="cell light" data-r="4" data-c="8" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="0" draggable="true"></div><div class="cell light border-bottom" data-r="5" data-c="1" draggable="true"></div><div class="cell dark border-right border-bottom" data-r="5" data-c="2" draggable="true"></div><div class="cell light border-bottom" data-r="5" data-c="3" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="4" draggable="true"></div><div class="cell light border-right border-bottom" data-r="5" data-c="5" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="6" draggable="true"></div><div class="cell light border-bottom" data-r="5" data-c="7" draggable="true"></div><div class="cell dark border-bottom" data-r="5" data-c="8" draggable="true"></div><div class="cell light" data-r="6" data-c="0" draggable="true"></div><div class="cell dark" data-r="6" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="6" data-c="2" draggable="true"></div><div class="cell dark" data-r="6" data-c="3" draggable="true"></div><div class="cell light" data-r="6" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="6" data-c="5" draggable="true"></div><div class="cell light" data-r="6" data-c="6" draggable="true"></div><div class="cell dark" data-r="6" data-c="7" draggable="true"></div><div class="cell light" data-r="6" data-c="8" draggable="true"></div><div class="cell dark" data-r="7" data-c="0" draggable="true"></div><div class="cell light" data-r="7" data-c="1" draggable="true"></div><div class="cell dark border-right" data-r="7" data-c="2" draggable="true"></div><div class="cell light" data-r="7" data-c="3" draggable="true"></div><div class="cell dark" data-r="7" data-c="4" draggable="true"></div><div class="cell light border-right" data-r="7" data-c="5" draggable="true"></div><div class="cell dark" data-r="7" data-c="6" draggable="true"></div><div class="cell light" data-r="7" data-c="7" draggable="true"></div><div class="cell dark" data-r="7" data-c="8" draggable="true"></div><div class="cell light" data-r="8" data-c="0" draggable="true"></div><div class="cell dark" data-r="8" data-c="1" draggable="true"></div><div class="cell light border-right" data-r="8" data-c="2" draggable="true"></div><div class="cell dark" data-r="8" data-c="3" draggable="true"></div><div class="cell light" data-r="8" data-c="4" draggable="true"></div><div class="cell dark border-right" data-r="8" data-c="5" draggable="true"></div><div class="cell light" data-r="8" data-c="6" draggable="true"></div><div class="cell dark" data-r="8" data-c="7" draggable="true"></div><div class="cell light" data-r="8" data-c="8" draggable="true"></div></div>[39m
[32m-             <div class="col-labels" style="grid-template-columns: repeat(9, 1fr);"><span class="coord-label">a</span><span class="coord-label">b</span><span class="coord-label">c</span><span class="coord-label">d</span><span class="coord-label">e</span><span class="coord-label">f</span><span class="coord-label">g</span><span class="coord-label">h</span><span class="coord-label">i</span></div><div class="row-labels" style="grid-template-rows: repeat(9, 1fr);"><span class="coord-label">9</span><span class="coord-label">8</span><span class="coord-label">7</span><span class="coord-label">6</span><span class="coord-label">5</span><span class="coord-label">4</span><span class="coord-label">3</span><span class="coord-label">2</span><span class="coord-label">1</span></div></div>[39m
[31m+       <!-- PANEL LAYER: Contextual side/top panels -->[39m
[31m+       <div id="panel-layer">[39m
[31m+         <!-- Analysis Panel (Deep Analysis) -->[39m
[31m+         <div id="analysis-panel" class="analysis-panel hidden">[39m
[31m+           <div class="analysis-header">[39m
[31m+             <h3>Deep Analysis</h3>[39m
[31m+             <button id="close-analysis-btn" class="close-icon-btn">Ã—</button>[39m
[31m+           </div>[39m
[31m+           <div class="analysis-body">[39m
[31m+             <div class="eval-section">[39m
[31m+               <div class="eval-bar-container">[39m
[31m+                 <div id="eval-bar" class="eval-bar"></div>[39m
[31m+               </div>[39m
[31m+               <div id="eval-score" class="eval-score">0.00</div>[39m
[31m+             </div>[39m
[31m+             <div class="top-moves-section">[39m
[31m+               <h4>Top ZÃ¼ge</h4>[39m
[31m+               <div id="top-moves-content" class="top-moves-list">[39m
[31m+                 <!-- Top moves injected by JS -->[39m
[31m+               </div>[39m
[31m+             </div>[39m
[31m+             <div class="analysis-controls">[39m
[31m+               <div class="analysis-info" id="analysis-engine-info">Tiefe: - | Knoten: -</div>[39m
[31m+               <button id="continuous-analysis-btn" class="btn-secondary small-btn">[39m
[31m+                 ðŸ”„ Kontinuierlich[39m
[31m+               </button>[39m
[31m+             </div>[39m
[2m            </div>[22m
[31m+         </div>[39m

[32m-           <!-- Evaluation Graph -->[39m
[32m-           <div id="eval-graph-container" class="eval-graph-container hidden">[39m
[32m-             <svg id="eval-graph" preserveAspectRatio="none" viewBox="0 0 1000 100"></svg>[39m
[31m+         <!-- Shop Panel (Contextual) -->[39m
[31m+         <div id="shop-panel" class="shop-panel hidden">[39m
[31m+           <div class="shop-header">[39m
[31m+             <h2>Truppen anheuern</h2>[39m
[31m+             <div class="shop-points">[39m
[31m+               <span id="points-display" data-testid="points-display">15</span> Pkt[39m
[31m+             </div>[39m
[2m            </div>[22m

[32m-           <!-- Player Info / Clock -->[39m
[32m-           <div class="player-info self">[39m
[32m-             <div class="player-details">[39m
[32m-               <div style="display: flex; align-items: center">[39m
[32m-                 <div class="player-avatar">[39m
[32m-                   <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[32m-                     <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>[39m
[32m-                     <circle cx="12" cy="7" r="4"></circle>[39m
[32m-                   </svg>[39m
[32m-                 </div>[39m
[32m-                 <div>[39m
[32m-                   <div class="player-name">Du</div>[39m
[32m-                   <div class="captured-pieces" id="captured-black"></div>[39m
[32m-                 </div>[39m
[32m-               </div>[39m
[31m+           <!-- Tutor Recommendations Section -->[39m
[31m+           <div id="tutor-recommendations-section" class="tutor-recommendations-section">[39m
[31m+             <button id="toggle-tutor-recommendations" class="btn-secondary full-width" style="padding: 8px; font-size: 0.9rem; margin-bottom: 1rem">[39m
[31m+               ðŸ’¡ KI-Vorlagen anzeigen[39m
[31m+             </button>[39m
[31m+             <div id="tutor-recommendations-container" class="tutor-recommendations-container hidden">[39m
[31m+               <!-- Templates will be injected here by JavaScript -->[39m
[2m              </div>[22m
[32m-             <div class="clock-display" id="clock-white">5:00</div>[39m
[2m            </div>[22m

[32m-           <!-- Action Bar -->[39m
[32m-           <div class="action-bar">[39m
[32m-             <button id="undo-btn" class="action-icon-btn" title="RÃ¼ckgÃ¤ngig (U)">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[32m-                 <path d="M3 7v6h6"></path>[39m
[32m-                 <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>[39m
[32m-               </svg>[39m
[31m+           <div id="shop-buttons" class="shop-grid">[39m
[31m+             <button class="shop-item" data-piece="p" data-cost="1" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">â™Ÿï¸</div>[39m
[31m+               <div class="shop-cost">1</div>[39m
[2m              </button>[22m
[32m-             <button id="hint-btn" class="action-icon-btn" title="Tipps anzeigen (H)">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[32m-                 <path d="M9.663 17h4.673M12 3v1M6.343 4.343l-.707-.707M17.657 4.343l.707-.707M4 12h1M19 12h1M12 21a9 9 0 0 0 9-9c0-4.97-4.03-9-9-9s-9 4.03-9 9a9 9 0 0 0 9 9z"></path>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="n" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">â™ž</div>[39m
[31m+               <div class="shop-cost">3</div>[39m
[2m              </button>[22m
[32m-             <button id="best-move-btn" class="action-icon-btn" title="Besten Zug anzeigen (B)">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="#22c55e" stroke-width="2" fill="none">[39m
[32m-                 <polyline points="20 6 9 17 4 12"></polyline>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="b" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">â™</div>[39m
[31m+               <div class="shop-cost">3</div>[39m
[2m              </button>[22m
[32m-             <button id="threats-btn" class="action-icon-btn" title="Drohungen visualisieren (T)">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="#ef4444" stroke-width="2" fill="none">[39m
[32m-                 <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>[39m
[32m-                 <line x1="12" y1="9" x2="12" y2="13"></line>[39m
[32m-                 <line x1="12" y1="17" x2="12.01" y2="17"></line>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="r" data-cost="5" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">â™œ</div>[39m
[31m+               <div class="shop-cost">5</div>[39m
[2m              </button>[22m
[32m-             <button id="opportunities-btn" class="action-icon-btn" title="Chancen anzeigen (O)">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="#f59e0b" stroke-width="2" fill="none">[39m
[32m-                 <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="j" data-cost="6" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">ðŸ¦„</div>[39m
[31m+               <div class="shop-cost">6</div>[39m
[2m              </button>[22m
[32m-             <button id="toggle-analysis-btn" class="action-icon-btn" title="Engine Analyse (A)">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="var(--accent-primary)" stroke-width="2" fill="none">[39m
[32m-                 <path d="M12 20v-8m-4 8v-4m8 4v-6m-12 6h16"></path>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="a" data-cost="7" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">ðŸ°</div>[39m
[31m+               <div class="shop-cost">7</div>[39m
[2m              </button>[22m
[32m-             <button id="toggle-3d-btn" class="action-icon-btn" title="3D Battle Modus (3)">[39m
[32m-               <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[32m-                 <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>[39m
[32m-                 <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>[39m
[32m-                 <line x1="12" y1="22.08" x2="12" y2="12"></line>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="c" data-cost="8" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">âš–ï¸</div>[39m
[31m+               <div class="shop-cost">8</div>[39m
[2m              </button>[22m
[32m-             <select id="skin-selector" class="skin-selector" title="Figuren-Skin auswÃ¤hlen" aria-label="Figuren-Skin auswÃ¤hlen">[39m
[32m-               <option value="classic">Klassisch</option>[39m
[32m-               <option value="modern">Modern</option>[39m
[32m-               <option value="pixel">Pixel</option>[39m
[32m-               <option value="infernale">Infernale</option>[39m
[32m-               <option value="wood">Holz</option>[39m
[32m-               <option value="neon">Neon</option>[39m
[32m-               <option value="minimalist">Minimalistisch</option>[39m
[32m-             </select>[39m
[32m-             <button id="info-toggle-btn" class="action-icon-btn" title="Info / Log">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[32m-                 <circle cx="12" cy="12" r="10"></circle>[39m
[32m-                 <line x1="12" y1="16" x2="12" y2="12"></line>[39m
[32m-                 <line x1="12" y1="8" x2="12.01" y2="8"></line>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="q" data-cost="9" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">â™›</div>[39m
[31m+               <div class="shop-cost">9</div>[39m
[2m              </button>[22m
[32m-             <button id="fullscreen-btn" class="action-icon-btn" title="Vollbild (F)">[39m
[32m-               <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">[39m
[32m-                 <path d="M8 3H5a2 2 0 0 0-2 2v3"></path>[39m
[32m-                 <path d="M21 8V5a2 2 0 0 0-2-2h-3"></path>[39m
[32m-                 <path d="M3 16v3a2 2 0 0 0 2 2h3"></path>[39m
[32m-                 <path d="M16 21h3a2 2 0 0 0 2-2v-3"></path>[39m
[32m-               </svg>[39m
[31m+             <button class="shop-item" data-piece="e" data-cost="12" style="opacity: 1; pointer-events: auto;">[39m
[31m+               <div class="shop-icon">ðŸ‘¼</div>[39m
[31m+               <div class="shop-cost">12</div>[39m
[2m              </button>[22m
[2m            </div>[22m
[32m-         </div>[39m
[31m+           <div id="selected-piece-display" class="shop-status">WÃ¤hle eine Figur zum Kaufen</div>[39m

[32m-         <!-- PANEL LAYER: Contextual side/top panels -->[39m
[32m-         <div id="panel-layer">[39m
[32m-           <!-- Analysis Panel (Deep Analysis) -->[39m
[32m-           <div id="analysis-panel" class="analysis-panel hidden">[39m
[32m-             <div class="analysis-header">[39m
[32m-               <h3>Deep Analysis</h3>[39m
[32m-               <button id="close-analysis-btn" class="close-icon-btn">Ã—</button>[39m
[32m-             </div>[39m
[32m-             <div class="analysis-body">[39m
[32m-               <div class="eval-section">[39m
[32m-                 <div class="eval-bar-container">[39m
[32m-                   <div id="eval-bar" class="eval-bar"></div>[39m
[32m-                 </div>[39m
[32m-                 <div id="eval-score" class="eval-score">0.00</div>[39m
[32m-               </div>[39m
[32m-               <div class="top-moves-section">[39m
[32m-                 <h4>Top ZÃ¼ge</h4>[39m
[32m-                 <div id="top-moves-content" class="top-moves-list">[39m
[32m-                   <!-- Top moves injected by JS -->[39m
[32m-                 </div>[39m
[32m-               </div>[39m
[32m-               <div class="analysis-controls">[39m
[32m-                 <div class="analysis-info" id="analysis-engine-info">Tiefe: - | Knoten: -</div>[39m
[32m-                 <button id="continuous-analysis-btn" class="btn-secondary small-btn">[39m
[32m-                   ðŸ”„ Kontinuierlich[39m
[32m-                 </button>[39m
[32m-               </div>[39m
[32m-             </div>[39m
[32m-           </div>[39m
[31m+           <button id="finish-setup-btn" class="btn-primary full-width">Fertig</button>[39m
[31m+         </div>[39m
[31m+       </div>[39m

[32m-           <!-- Shop Panel (Contextual) -->[39m
[32m-           <div id="shop-panel" class="shop-panel hidden">[39m
[32m-             <div class="shop-header">[39m
[32m-               <h2>Truppen anheuern</h2>[39m
[32m-               <div class="shop-points">[39m
[32m-                 <span id="points-display" data-testid="points-display">15</span> Pkt[39m
[32m-               </div>[39m
[31m+       <!-- OVERLAY LAYER: Fullscreen menus and modals -->[39m
[31m+       <div id="overlay-layer">[39m
[31m+         <!-- Menu Overlay -->[39m
[31m+         <div id="menu-overlay" class="fullscreen-overlay hidden">[39m
[31m+           <div class="menu-content">[39m
[31m+             <div class="menu-header">[39m
[31m+               <h2>MenÃ¼</h2>[39m
[31m+               <button id="menu-close-btn" class="close-icon-btn">Ã—</button>[39m
[2m              </div>[22m

[32m-             <!-- Tutor Recommendations Section -->[39m
[32m-             <div id="tutor-recommendations-section" class="tutor-recommendations-section">[39m
[32m-               <button id="toggle-tutor-recommendations" class="btn-secondary full-width" style="padding: 8px; font-size: 0.9rem; margin-bottom: 1rem">[39m
[32m-                 ðŸ’¡ KI-Vorlagen anzeigen[39m
[32m-               </button>[39m
[32m-               <div id="tutor-recommendations-container" class="tutor-recommendations-container hidden">[39m
[32m-                 <!-- Templates will be injected here by JavaScript -->[39m
[31m+             <div class="menu-grid">[39m
[31m+               <div class="menu-section">[39m
[31m+                 <h3>Spiel</h3>[39m
[31m+                 <button id="restart-btn" class="menu-item">ðŸ”„ Neues Spiel</button>[39m
[31m+                 <button id="puzzle-mode-btn" class="menu-item">ðŸ§© Puzzles</button>[39m
[31m+                 <button id="save-btn" class="menu-item">ðŸ’¾ Speichern</button>[39m
[31m+                 <button id="load-btn" class="menu-item">ðŸ“‚ Laden</button>[39m
[31m+                 <button id="analysis-mode-btn" class="menu-item">ðŸ” Analyse-Modus</button>[39m
[31m+                 <button id="resign-btn" class="menu-item danger">ðŸ³ï¸ Aufgeben</button>[39m
[31m+                 <button id="draw-offer-btn" class="menu-item warning">ðŸ¤ Remis anbieten</button>[39m
[31m+                 <button id="export-pgn-btn" class="menu-item">ðŸ“ PGN exportieren</button>[39m
[2m                </div>[22m
[32m-             </div>[39m

[32m-             <div id="shop-buttons" class="shop-grid">[39m
[32m-               <button class="shop-item" data-piece="p" data-cost="1" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">â™Ÿï¸</div>[39m
[32m-                 <div class="shop-cost">1</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="n" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">â™ž</div>[39m
[32m-                 <div class="shop-cost">3</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="b" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">â™</div>[39m
[32m-                 <div class="shop-cost">3</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="r" data-cost="5" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">â™œ</div>[39m
[32m-                 <div class="shop-cost">5</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="j" data-cost="6" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">ðŸ¦„</div>[39m
[32m-                 <div class="shop-cost">6</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="a" data-cost="7" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">ðŸ°</div>[39m
[32m-                 <div class="shop-cost">7</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="c" data-cost="8" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">âš–ï¸</div>[39m
[32m-                 <div class="shop-cost">8</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="q" data-cost="9" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">â™›</div>[39m
[32m-                 <div class="shop-cost">9</div>[39m
[32m-               </button>[39m
[32m-               <button class="shop-item" data-piece="e" data-cost="12" style="opacity: 1; pointer-events: auto;">[39m
[32m-                 <div class="shop-icon">ðŸ‘¼</div>[39m
[32m-                 <div class="shop-cost">12</div>[39m
[32m-               </button>[39m
[32m-             </div>[39m
[32m-             <div id="selected-piece-display" class="shop-status">WÃ¤hle eine Figur zum Kaufen</div>[39m
[32m-[39m
[32m-             <button id="finish-setup-btn" class="btn-primary full-width">Fertig</button>[39m
[32m-           </div>[39m
[32m-         </div>[39m
[32m-[39m
[32m-         <!-- OVERLAY LAYER: Fullscreen menus and modals -->[39m
[32m-         <div id="overlay-layer">[39m
[32m-           <!-- Menu Overlay -->[39m
[32m-           <div id="menu-overlay" class="fullscreen-overlay hidden">[39m
[32m-             <div class="menu-content">[39m
[32m-               <div class="menu-header">[39m
[32m-                 <h2>MenÃ¼</h2>[39m
[32m-                 <button id="menu-close-btn" class="close-icon-btn">Ã—</button>[39m
[32m-               </div>[39m
[31m+               <div class="menu-section">[39m
[31m+                 <h3>Einstellungen</h3>[39m

[32m-               <div class="menu-grid">[39m
[32m-                 <div class="menu-section">[39m
[32m-                   <h3>Spiel</h3>[39m
[32m-                   <button id="restart-btn" class="menu-item">ðŸ”„ Neues Spiel</button>[39m
[32m-                   <button id="puzzle-mode-btn" class="menu-item">ðŸ§© Puzzles</button>[39m
[32m-                   <button id="save-btn" class="menu-item">ðŸ’¾ Speichern</button>[39m
[32m-                   <button id="load-btn" class="menu-item">ðŸ“‚ Laden</button>[39m
[32m-                   <button id="analysis-mode-btn" class="menu-item">ðŸ” Analyse-Modus</button>[39m
[32m-                   <button id="resign-btn" class="menu-item danger">ðŸ³ï¸ Aufgeben</button>[39m
[32m-                   <button id="draw-offer-btn" class="menu-item warning">ðŸ¤ Remis anbieten</button>[39m
[32m-                   <button id="export-pgn-btn" class="menu-item">ðŸ“ PGN exportieren</button>[39m
[31m+                 <div class="setting-row">[39m
[31m+                   <label>Brett-Design</label>[39m
[31m+                   <select id="theme-select" class="menu-select">[39m
[31m+                     <option value="classic">Klassisch</option>[39m
[31m+                     <option value="blue">Blau</option>[39m
[31m+                     <option value="green">GrÃ¼n</option>[39m
[31m+                     <option value="dark">Dunkel</option>[39m
[31m+                     <option value="wood">Holz</option>[39m
[31m+                   </select>[39m
[2m                  </div>[22m
[32m-[39m
[32m-                 <div class="menu-section">[39m
[32m-                   <h3>Einstellungen</h3>[39m
[32m-[39m
[32m-                   <div class="setting-row">[39m
[32m-                     <label>Brett-Design</label>[39m
[32m-                     <select id="theme-select" class="menu-select">[39m
[32m-                       <option value="classic">Klassisch</option>[39m
[32m-                       <option value="blue">Blau</option>[39m
[32m-                       <option value="green">GrÃ¼n</option>[39m
[32m-                       <option value="dark">Dunkel</option>[39m
[32m-                       <option value="wood">Holz</option>[39m
[32m-                     </select>[39m
[32m-                   </div>[39m
[32m-                   <div class="setting-row">[39m
[32m-                     <label>Schwierigkeit</label>[39m
[32m-                     <select id="difficulty-select" class="menu-select">[39m
[32m-                       <option value="beginner">AnfÃ¤nger</option>[39m
[32m-                       <option value="easy">Einfach</option>[39m
[32m-                       <option value="medium">Mittel</option>[39m
[32m-                       <option value="hard">Schwer</option>[39m
[32m-                       <option value="expert">Experte</option>[39m
[32m-                     </select>[39m
[32m-                   </div>[39m
[32m-                   <div class="setting-row">[39m
[32m-                     <label>Zeit</label>[39m
[32m-                     <select id="time-control-select" class="menu-select">[39m
[32m-                       <option value="blitz3">Blitz 3+2</option>[39m
[32m-                       <option value="blitz5" selected="">Blitz 5+3</option>[39m
[32m-                       <option value="rapid10">Rapid 10+0</option>[39m
[32m-                       <option value="rapid15">Rapid 15+10</option>[39m
[32m-                       <option value="classical30">Klassisch 30+0</option>[39m
[32m-                     </select>[39m
[31m+                 <div class="setting-row">[39m
[31m+                   <label>Schwierigkeit</label>[39m
[31m+                   <select id="difficulty-select" class="menu-select">[39m
[31m+                     <option value="beginner">AnfÃ¤nger</option>[39m
[31m+                     <option value="easy">Einfach</option>[39m
[31m+                     <option value="medium">Mittel</option>[39m
[31m+                     <option value="hard">Schwer</option>[39m
[31m+                     <option value="expert">Experte</option>[39m
[31m+                   </select>[39m
[31m+                 </div>[39m
[31m+                 <div class="setting-row">[39m
[31m+                   <label>Zeit</label>[39m
[31m+                   <select id="time-control-select" class="menu-select">[39m
[31m+                     <option value="blitz3">Blitz 3+2</option>[39m
[31m+                     <option value="blitz5" selected="">Blitz 5+3</option>[39m
[31m+                     <option value="rapid10">Rapid 10+0</option>[39m
[31m+                     <option value="rapid15">Rapid 15+10</option>[39m
[31m+                     <option value="classical30">Klassisch 30+0</option>[39m
[31m+                   </select>[39m
[31m+                 </div>[39m
[31m+                 <div class="setting-row">[39m
[31m+                   <label>Sound</label>[39m
[31m+                   <div class="volume-control">[39m
[31m+                     <label class="toggle-switch">[39m
[31m+                       <input type="checkbox" id="sound-toggle" checked="">[39m
[31m+                       <span class="toggle-slider"></span>[39m
[31m+                     </label>[39m
[31m+                     <input type="range" id="volume-slider" min="0" max="100" value="30" class="volume-slider">[39m
[31m+                     <span id="volume-value">30%</span>[39m
[2m                    </div>[22m
[32m-                   <div class="setting-row">[39m
[32m-                     <label>Sound</label>[39m
[32m-                     <div class="volume-control">[39m
[32m-                       <label class="toggle-switch">[39m
[32m-                         <input type="checkbox" id="sound-toggle" checked="">[39m
[32m-                         <span class="toggle-slider"></span>[39m
[32m-                       </label>[39m
[32m-                       <input type="range" id="volume-slider" min="0" max="100" value="30" class="volume-slider">[39m
[32m-                       <span id="volume-value">30%</span>[39m
[32m-                     </div>[39m
[32m-                   </div>[39m
[31m+                 </div>[39m

[32m-                   <div class="setting-row">[39m
[32m-                     <label>Tutor-Modus</label>[39m
[32m-                     <select id="tutor-mode-select" class="menu-select">[39m
[32m-                       <option value="standard">Standard (Tipps)</option>[39m
[32m-                       <option value="guess_the_move">Rate den Zug!</option>[39m
[32m-                     </select>[39m
[32m-                   </div>[39m
[31m+                 <div class="setting-row">[39m
[31m+                   <label>Tutor-Modus</label>[39m
[31m+                   <select id="tutor-mode-select" class="menu-select">[39m
[31m+                     <option value="standard">Standard (Tipps)</option>[39m
[31m+                     <option value="guess_the_move">Rate den Zug!</option>[39m
[31m+                   </select>[39m
[31m+                 </div>[39m

[32m-                   <div class="setting-row">[39m
[32m-                     <label>KI-Mentor (Warnstufe)</label>[39m
[32m-                     <select id="ki-mentor-level-select" class="menu-select">[39m
[32m-                       <option value="OFF">Aus</option>[39m
[32m-                       <option value="STANDARD" selected="">Standard (Nur Patzer)</option>[39m
[32m-                       <option value="STRICT">Streng (Auch Fehler)</option>[39m
[32m-                     </select>[39m
[32m-                   </div>[39m
[31m+                 <div class="setting-row">[39m
[31m+                   <label>KI-Mentor (Warnstufe)</label>[39m
[31m+                   <select id="ki-mentor-level-select" class="menu-select">[39m
[31m+                     <option value="OFF">Aus</option>[39m
[31m+                     <option value="STANDARD" selected="">Standard (Nur Patzer)</option>[39m
[31m+                     <option value="STRICT">Streng (Auch Fehler)</option>[39m
[31m+                   </select>[39m
[31m+                 </div>[39m

[32m-                   <div class="setting-row" id="tutor-points-row">[39m
[32m-                     <label>Tutor-Punkte</label>[39m
[32m-                     <div id="tutor-points-display" class="stat-pill">0</div>[39m
[32m-                   </div>[39m
[32m-                   <div class="setting-row">[39m
[32m-                     <label>KI-PersÃ¶nlichkeit</label>[39m
[32m-                     <select id="ai-personality-select" class="menu-select">[39m
[32m-                       <option value="balanced">âš–ï¸ Ausgeglichen</option>[39m
[32m-                       <option value="aggressive">âš”ï¸ Aggressiv</option>[39m
[32m-                       <option value="defensive">ðŸ›¡ï¸ Defensiv</option>[39m
[32m-                       <option value="positional">â™Ÿï¸ Positionell</option>[39m
[32m-                     </select>[39m
[32m-                   </div>[39m
[31m+                 <div class="setting-row" id="tutor-points-row">[39m
[31m+                   <label>Tutor-Punkte</label>[39m
[31m+                   <div id="tutor-points-display" class="stat-pill">0</div>[39m
[31m+                 </div>[39m
[31m+                 <div class="setting-row">[39m
[31m+                   <label>KI-PersÃ¶nlichkeit</label>[39m
[31m+                   <select id="ai-personality-select" class="menu-select">[39m
[31m+                     <option value="balanced">âš–ï¸ Ausgeglichen</option>[39m
[31m+                     <option value="aggressive">âš”ï¸ Aggressiv</option>[39m
[31m+                     <option value="defensive">ðŸ›¡ï¸ Defensiv</option>[39m
[31m+                     <option value="positional">â™Ÿï¸ Positionell</option>[39m
[31m+                   </select>[39m
[2m                  </div>[22m
[31m+               </div>[39m

[32m-                 <div class="menu-section">[39m
[32m-                   <h3>Extras</h3>[39m
[32m-                   <button id="stats-btn" class="menu-item">ðŸ“Š Statistiken</button>[39m
[31m+               <div class="menu-section">[39m
[31m+                 <h3>Extras</h3>[39m
[31m+                 <button id="stats-btn" class="menu-item">ðŸ“Š Statistiken</button>[39m

[32m-                   <button id="help-btn" class="menu-item">ðŸ“– Hilfe / Tutorial</button>[39m
[32m-                 </div>[39m
[31m+                 <button id="help-btn" class="menu-item">ðŸ“– Hilfe / Tutorial</button>[39m
[2m                </div>[22m
[2m              </div>[22m
[2m            </div>[22m
[31m+         </div>[39m

[32m-           <!-- Info Overlay (Log, History) -->[39m
[32m-           <div id="info-overlay" class="fullscreen-overlay hidden">[39m
[32m-             <div class="info-content">[39m
[32m-               <div class="menu-header">[39m
[32m-                 <h2>Spielinfo</h2>[39m
[32m-                 <button id="info-close-btn" class="close-icon-btn">Ã—</button>[39m
[32m-               </div>[39m
[32m-               <div class="info-tabs">[39m
[32m-                 <button class="tab-btn active" data-tab="history">Historie</button>[39m
[32m-                 <button class="tab-btn" data-tab="log">Log</button>[39m
[32m-               </div>[39m
[32m-               <div id="tab-history" class="tab-pane active">[39m
[32m-                 <div id="move-history" class="history-list"></div>[39m
[32m-               </div>[39m
[32m-               <div id="tab-log" class="tab-pane">[39m
[32m-                 <div id="log-panel" class="log-list"></div>[39m
[32m-               </div>[39m
[31m+         <!-- Info Overlay (Log, History) -->[39m
[31m+         <div id="info-overlay" class="fullscreen-overlay hidden">[39m
[31m+           <div class="info-content">[39m
[31m+             <div class="menu-header">[39m
[31m+               <h2>Spielinfo</h2>[39m
[31m+               <button id="info-close-btn" class="close-icon-btn">Ã—</button>[39m
[31m+             </div>[39m
[31m+             <div class="info-tabs">[39m
[31m+               <button class="tab-btn active" data-tab="history">Historie</button>[39m
[31m+               <button class="tab-btn" data-tab="log">Log</button>[39m
[31m+             </div>[39m
[31m+             <div id="tab-history" class="tab-pane active">[39m
[31m+               <div id="move-history" class="history-list"></div>[39m
[31m+             </div>[39m
[31m+             <div id="tab-log" class="tab-pane">[39m
[31m+               <div id="log-panel" class="log-list"></div>[39m
[2m              </div>[22m
[2m            </div>[22m
[31m+         </div>[39m

[32m-           <!-- Overlays (Game Over, Promotion, etc.) -->[39m
[32m-           <div id="game-over-overlay" class="modal-overlay hidden">[39m
[32m-             <div class="modal-content">[39m
[32m-               <h2 id="winner-text">Spiel beendet</h2>[39m
[32m-               <button id="restart-btn-overlay" class="btn-primary">Neues Spiel</button>[39m
[32m-               <button id="close-game-over-btn" class="btn-secondary">SchlieÃŸen</button>[39m
[32m-             </div>[39m
[31m+         <!-- Overlays (Game Over, Promotion, etc.) -->[39m
[31m+         <div id="game-over-overlay" class="modal-overlay hidden">[39m
[31m+           <div class="modal-content">[39m
[31m+             <h2 id="winner-text">Spiel beendet</h2>[39m
[31m+             <button id="restart-btn-overlay" class="btn-primary">Neues Spiel</button>[39m
[31m+             <button id="close-game-over-btn" class="btn-secondary">SchlieÃŸen</button>[39m
[2m            </div>[22m
[31m+         </div>[39m

[32m-           <div id="promotion-overlay" class="modal-overlay hidden">[39m
[32m-             <div class="modal-content">[39m
[32m-               <h2>BefÃ¶rderung</h2>[39m
[32m-               <div id="promotion-options" class="promotion-grid"></div>[39m
[32m-             </div>[39m
[31m+         <div id="promotion-overlay" class="modal-overlay hidden">[39m
[31m+           <div class="modal-content">[39m
[31m+             <h2>BefÃ¶rderung</h2>[39m
[31m+             <div id="promotion-options" class="promotion-grid"></div>[39m
[2m            </div>[22m
[31m+         </div>[39m

[32m-           <!-- Puzzle Menu Overlay -->[39m
[32m-           <div id="puzzle-menu-overlay" class="fullscreen-overlay hidden">[39m
[32m-             <div class="menu-content puzzle-menu-container">[39m
[32m-               <div class="menu-header">[39m
[32m-                 <h2>Puzzles</h2>[39m
[32m-                 <button id="puzzle-menu-close-btn" class="close-icon-btn">Ã—</button>[39m
[32m-               </div>[39m
[32m-               <div id="puzzle-menu-list" class="puzzle-grid">[39m
[32m-                 <!-- Puzzles injected by JS -->[39m
[32m-               </div>[39m
[31m+         <!-- Puzzle Menu Overlay -->[39m
[31m+         <div id="puzzle-menu-overlay" class="fullscreen-overlay hidden">[39m
[31m+           <div class="menu-content puzzle-menu-container">[39m
[31m+             <div class="menu-header">[39m
[31m+               <h2>Puzzles</h2>[39m
[31m+               <button id="puzzle-menu-close-btn" class="close-icon-btn">Ã—</button>[39m
[31m+             </div>[39m
[31m+             <div id="puzzle-menu-list" class="puzzle-grid">[39m
[31m+               <!-- Puzzles injected by JS -->[39m
[2m              </div>[22m
[2m            </div>[22m
[31m+         </div>[39m

[32m-           <!-- Statistics Overlay -->[39m
[32m-           <div id="stats-overlay" class="fullscreen-overlay hidden">[39m
[32m-             <div class="stats-content">[39m
[32m-               <div class="stats-header">[39m
[32m-                 <h2>Statistiken</h2>[39m
[32m-                 <button id="stats-close-btn" class="close-icon-btn">Ã—</button>[39m
[31m+         <!-- Statistics Overlay -->[39m
[31m+         <div id="stats-overlay" class="fullscreen-overlay hidden">[39m
[31m+           <div class="stats-content">[39m
[31m+             <div class="stats-header">[39m
[31m+               <h2>Statistiken</h2>[39m
[31m+               <button id="stats-close-btn" class="close-icon-btn">Ã—</button>[39m
[31m+             </div>[39m
[31m+             <div class="stats-grid">[39m
[31m+               <div class="stat-card">[39m
[31m+                 <div class="stat-label">Genauigkeit</div>[39m
[31m+                 <div id="stat-accuracy" class="stat-value">--%</div>[39m
[31m+               </div>[39m
[31m+               <div class="stat-card">[39m
[31m+                 <div class="stat-label">Beste ZÃ¼ge</div>[39m
[31m+                 <div id="stat-best-moves" class="stat-value">0</div>[39m
[31m+               </div>[39m
[31m+               <div class="stat-card">[39m
[31m+                 <div class="stat-label">Material</div>[39m
[31m+                 <div id="stat-material" class="stat-value">0</div>[39m
[2m                </div>[22m
[32m-               <div class="stats-grid">[39m
[32m-                 <div class="stat-card">[39m
[32m-                   <div class="stat-label">Genauigkeit</div>[39m
[32m-                   <div id="stat-accuracy" class="stat-value">--%</div>[39m
[32m-                 </div>[39m
[32m-                 <div class="stat-card">[39m
[32m-                   <div class="stat-label">Beste ZÃ¼ge</div>[39m
[32m-                   <div id="stat-best-moves" class="stat-value">0</div>[39m
[32m-                 </div>[39m
[32m-                 <div class="stat-card">[39m
[32m-                   <div class="stat-label">Material</div>[39m
[32m-                   <div id="stat-material" class="stat-value">0</div>[39m
[32m-                 </div>[39m
[32m-                 <div class="stat-card">[39m
[32m-                   <div class="stat-label">GeschÃ¤tzte Elo</div>[39m
[32m-                   <div id="stat-elo" class="stat-value">600</div>[39m
[32m-                 </div>[39m
[31m+               <div class="stat-card">[39m
[31m+                 <div class="stat-label">GeschÃ¤tzte Elo</div>[39m
[31m+                 <div id="stat-elo" class="stat-value">600</div>[39m
[2m                </div>[22m
[2m              </div>[22m
[2m            </div>[22m
[31m+         </div>[39m

[32m-           <!-- Puzzle Panel -->[39m
[32m-           <div id="puzzle-overlay" class="puzzle-panel hidden">[39m
[32m-             <div class="puzzle-content">[39m
[32m-               <h2 id="puzzle-title">Puzzle Titel</h2>[39m
[32m-               <p id="puzzle-description">Beschreibung...</p>[39m
[32m-               <div class="puzzle-status" id="puzzle-status">WeiÃŸ am Zug</div>[39m
[32m-               <div class="puzzle-buttons">[39m
[32m-                 <button id="puzzle-next-btn" class="btn-primary hidden">NÃ¤chstes Puzzle</button>[39m
[32m-                 <button id="puzzle-exit-btn" class="btn-secondary">Beenden</button>[39m
[32m-               </div>[39m
[31m+         <!-- Puzzle Panel -->[39m
[31m+         <div id="puzzle-overlay" class="puzzle-panel hidden">[39m
[31m+           <div class="puzzle-content">[39m
[31m+             <h2 id="puzzle-title">Puzzle Titel</h2>[39m
[31m+             <p id="puzzle-description">Beschreibung...</p>[39m
[31m+             <div class="puzzle-status" id="puzzle-status">WeiÃŸ am Zug</div>[39m
[31m+             <div class="puzzle-buttons">[39m
[31m+               <button id="puzzle-next-btn" class="btn-primary hidden">NÃ¤chstes Puzzle</button>[39m
[31m+               <button id="puzzle-exit-btn" class="btn-secondary">Beenden</button>[39m
[2m              </div>[22m
[2m            </div>[22m
[2m          </div>[22m
[31m+       </div>[39m

[32m-         <!-- Help Overlay -->[39m
[32m-         <div id="help-overlay" class="fullscreen-overlay hidden">[39m
[32m-           <div class="info-content">[39m
[32m-             <div class="menu-header">[39m
[32m-               <h2>Hilfe &amp; Regeln</h2>[39m
[32m-               <button id="close-help-btn" class="close-icon-btn">Ã—</button>[39m
[32m-             </div>[39m
[32m-             <div class="help-body" style="padding: 20px; overflow-y: auto; max-height: 70vh">[39m
[32m-               <h3>Spielablauf</h3>[39m
[32m-               <p>Schach 9x9 ist eine Variante auf einem grÃ¶ÃŸeren Brett mit neuen Figuren.</p>[39m
[32m-               <h4>1. Setup-Phase</h4>[39m
[32m-               <ul>[39m
[32m-                 <li>[39m
[32m-                   <strong>KÃ¶nig platzieren:</strong> WÃ¤hle einen 3x3 Bereich fÃ¼r deinen KÃ¶nig.[39m
[32m-                 </li>[39m
[32m-                 <li><strong>Truppen kaufen:</strong> Nutze deine Punkte, um Figuren zu kaufen.</li>[39m
[32m-                 <li>[39m
[32m-                   <strong>Aufstellung:</strong> Platziere deine gekauften Figuren in deinem Bereich.[39m
[32m-                 </li>[39m
[32m-               </ul>[39m
[32m-               <h4>2. Neue Figuren</h4>[39m
[32m-               <ul>[39m
[32m-                 <li><strong>Kanzler (C):</strong> Zieht wie Turm + Springer.</li>[39m
[32m-                 <li><strong>Erzbischof (A):</strong> Zieht wie LÃ¤ufer + Springer.</li>[39m
[32m-               </ul>[39m
[32m-             </div>[39m
[31m+       <!-- Help Overlay -->[39m
[31m+       <div id="help-overlay" class="fullscreen-overlay hidden">[39m
[31m+         <div class="info-content">[39m
[31m+           <div class="menu-header">[39m
[31m+             <h2>Hilfe &amp; Regeln</h2>[39m
[31m+             <button id="close-help-btn" class="close-icon-btn">Ã—</button>[39m
[2m            </div>[22m
[31m+           <div class="help-body" style="padding: 20px; overflow-y: auto; max-height: 70vh">[39m
[31m+             <h3>Spielablauf</h3>[39m
[31m+             <p>Schach 9x9 ist eine Variante auf einem grÃ¶ÃŸeren Brett mit neuen Figuren.</p>[39m
[31m+             <h4>1. Setup-Phase</h4>[39m
[31m+             <ul>[39m
[31m+               <li>[39m
[31m+                 <strong>KÃ¶nig platzieren:</strong> WÃ¤hle einen 3x3 Bereich fÃ¼r deinen KÃ¶nig.[39m
[31m+               </li>[39m
[31m+               <li><strong>Truppen kaufen:</strong> Nutze deine Punkte, um Figuren zu kaufen.</li>[39m
[31m+               <li>[39m
[31m+                 <strong>Aufstellung:</strong> Platziere deine gekauften Figuren in deinem Bereich.[39m
[31m+               </li>[39m
[31m+             </ul>[39m
[31m+             <h4>2. Neue Figuren</h4>[39m
[31m+             <ul>[39m
[31m+               <li><strong>Kanzler (C):</strong> Zieht wie Turm + Springer.</li>[39m
[31m+               <li><strong>Erzbischof (A):</strong> Zieht wie LÃ¤ufer + Springer.</li>[39m
[31m+             </ul>[39m
[31m+           </div>[39m
[2m          </div>[22m
[31m+       </div>[39m

[32m-         <!-- Confirmation Overlay -->[39m
[32m-         <div id="confirmation-overlay" class="modal-overlay hidden">[39m
[32m-           <div class="modal-content">[39m
[32m-             <h2 id="confirmation-title">BestÃ¤tigung</h2>[39m
[32m-             <p id="confirmation-message">Bist du sicher?</p>[39m
[32m-             <div class="modal-buttons">[39m
[32m-               <button id="confirm-yes-btn" class="btn-primary">Ja</button>[39m
[32m-               <button id="confirm-no-btn" class="btn-secondary">Nein</button>[39m
[32m-             </div>[39m
[31m+       <!-- Confirmation Overlay -->[39m
[31m+       <div id="confirmation-overlay" class="modal-overlay hidden">[39m
[31m+         <div class="modal-content">[39m
[31m+           <h2 id="confirmation-title">BestÃ¤tigung</h2>[39m
[31m+           <p id="confirmation-message">Bist du sicher?</p>[39m
[31m+           <div class="modal-buttons">[39m
[31m+             <button id="confirm-yes-btn" class="btn-primary">Ja</button>[39m
[31m+             <button id="confirm-no-btn" class="btn-secondary">Nein</button>[39m
[2m            </div>[22m
[2m          </div>[22m
[31m+       </div>[39m

[32m-         <!-- Draw Offer Overlay -->[39m
[32m-         <div id="draw-offer-overlay" class="modal-overlay hidden">[39m
[32m-           <div class="modal-content">[39m
[32m-             <h2>Remis angeboten</h2>[39m
[32m-             <p id="draw-offer-message">Dein Gegner bietet ein Unentschieden an.</p>[39m
[32m-             <div class="modal-buttons">[39m
[32m-               <button id="accept-draw-btn" class="btn-primary">Annehmen</button>[39m
[32m-               <button id="decline-draw-btn" class="btn-secondary">Ablehnen</button>[39m
[32m-             </div>[39m
[31m+       <!-- Draw Offer Overlay -->[39m
[31m+       <div id="draw-offer-overlay" class="modal-overlay hidden">[39m
[31m+         <div class="modal-content">[39m
[31m+           <h2>Remis angeboten</h2>[39m
[31m+           <p id="draw-offer-message">Dein Gegner bietet ein Unentschieden an.</p>[39m
[31m+           <div class="modal-buttons">[39m
[31m+             <button id="accept-draw-btn" class="btn-primary">Annehmen</button>[39m
[31m+             <button id="decline-draw-btn" class="btn-secondary">Ablehnen</button>[39m
[2m            </div>[22m
[2m          </div>[22m
[31m+       </div>[39m

[32m-         <!-- Tutorial Overlay -->[39m
[32m-         <div id="tutorial-overlay" class="fullscreen-overlay hidden">[39m
[32m-           <div class="tutorial-content">[39m
[32m-             <div class="menu-header">[39m
[32m-               <h2>Tutorial</h2>[39m
[32m-               <button id="tutorial-close" class="close-icon-btn">Ã—</button>[39m
[31m+       <!-- Tutorial Overlay -->[39m
[31m+       <div id="tutorial-overlay" class="fullscreen-overlay hidden">[39m
[31m+         <div class="tutorial-content">[39m
[31m+           <div class="menu-header">[39m
[31m+             <h2>Tutorial</h2>[39m
[31m+             <button id="tutorial-close" class="close-icon-btn">Ã—</button>[39m
[31m+           </div>[39m
[31m+           <div id="tutorial-steps" class="tutorial-body">[39m
[31m+             <!-- Steps injected by JS -->[39m
[31m+           </div>[39m
[31m+           <div class="tutorial-footer">[39m
[31m+             <div class="step-indicator">[39m
[31m+               Schritt <span id="tutorial-current-step">1</span> von[39m
[31m+               <span id="tutorial-total-steps">8</span>[39m
[2m              </div>[22m
[32m-             <div id="tutorial-steps" class="tutorial-body">[39m
[32m-               <!-- Steps injected by JS -->[39m
[32m-             </div>[39m
[32m-             <div class="tutorial-footer">[39m
[32m-               <div class="step-indicator">[39m
[32m-                 Schritt <span id="tutorial-current-step">1</span> von[39m
[32m-                 <span id="tutorial-total-steps">8</span>[39m
[32m-               </div>[39m
[32m-               <div class="tutorial-controls">[39m
[32m-                 <button id="tutorial-prev" class="btn-secondary">ZurÃ¼ck</button>[39m
[32m-                 <button id="tutorial-next" class="btn-primary">Weiter â–¶</button>[39m
[32m-               </div>[39m
[31m+             <div class="tutorial-controls">[39m
[31m+               <button id="tutorial-prev" class="btn-secondary">ZurÃ¼ck</button>[39m
[31m+               <button id="tutorial-next" class="btn-primary">Weiter â–¶</button>[39m
[2m              </div>[22m
[2m            </div>[22m
[2m          </div>[22m
[31m+       </div>[39m

[32m-         <!-- Generic Modal (used by OverlayManager) -->[39m
[32m-         <div id="generic-modal" class="modal-overlay hidden">[39m
[32m-           <div class="modal-content">[39m
[32m-             <h2 id="modal-title">Titel</h2>[39m
[32m-             <div id="modal-message">Nachricht</div>[39m
[32m-             <div id="modal-actions" class="modal-buttons"></div>[39m
[32m-           </div>[39m
[31m+       <!-- Generic Modal (used by OverlayManager) -->[39m
[31m+       <div id="generic-modal" class="modal-overlay hidden">[39m
[31m+         <div class="modal-content">[39m
[31m+           <h2 id="modal-title">Titel</h2>[39m
[31m+           <div id="modal-message">Nachricht</div>[39m
[31m+           <div id="modal-actions" class="modal-buttons"></div>[39m
[2m          </div>[22m
[31m+       </div>[39m

[32m-         <!-- Premium Main Menu -->[39m
[32m-         <div id="main-menu" class="active">[39m
[32m-           <div class="menu-container">[39m
[32m-             <!-- Sidebar -->[39m
[32m-             <nav class="menu-sidebar">[39m
[32m-               <div class="menu-logo">[39m
[32m-                 <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[32m-                   <rect width="18" height="18" x="3" y="3" rx="2"></rect>[39m
[32m-                   <path d="M7 7h10"></path>[39m
[32m-                   <path d="M7 12h10"></path>[39m
[32m-                   <path d="M7 17h10"></path>[39m
[32m-                   <path d="M12 3v18"></path>[39m
[32m-                 </svg>[39m
[32m-                 Schach 9x9[39m
[32m-               </div>[39m
[32m-               <div class="menu-nav">[39m
[32m-                 <button class="menu-tab-btn active" data-tab="play">[39m
[32m-                   <span class="icon">ðŸŽ®</span> Spielen[39m
[32m-                 </button>[39m
[32m-                 <button class="menu-tab-btn" data-tab="learn">[39m
[32m-                   <span class="icon">ðŸŽ“</span> Lernen[39m
[32m-                 </button>[39m
[32m-                 <button class="menu-tab-btn" data-tab="settings">[39m
[32m-                   <span class="icon">âš™ï¸</span> Einstellungen[39m
[32m-                 </button>[39m
[32m-                 <button class="menu-tab-btn" data-tab="credits">[39m
[32m-                   <span class="icon">â¤ï¸</span> Credits[39m
[32m-                 </button>[39m
[32m-                 <div style="flex: 1"></div>[39m
[32m-                 <button id="resume-game-btn" class="menu-tab-btn hidden" style="color: #4ade80">[39m
[32m-                   <span class="icon">â–¶ï¸</span> Fortsetzen[39m
[32m-                 </button>[39m
[32m-               </div>[39m
[32m-             </nav>[39m
[31m+       <!-- Premium Main Menu -->[39m
[31m+       <div id="main-menu" class="active">[39m
[31m+         <div class="menu-container">[39m
[31m+           <!-- Sidebar -->[39m
[31m+           <nav class="menu-sidebar">[39m
[31m+             <div class="menu-logo">[39m
[31m+               <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">[39m
[31m+                 <rect width="18" height="18" x="3" y="3" rx="2"></rect>[39m
[31m+                 <path d="M7 7h10"></path>[39m
[31m+                 <path d="M7 12h10"></path>[39m
[31m+                 <path d="M7 17h10"></path>[39m
[31m+                 <path d="M12 3v18"></path>[39m
[31m+               </svg>[39m
[31m+               Schach 9x9[39m
[31m+             </div>[39m
[31m+             <div class="menu-nav">[39m
[31m+               <button class="menu-tab-btn active" data-tab="play">[39m
[31m+                 <span class="icon">ðŸŽ®</span> Spielen[39m
[31m+               </button>[39m
[31m+               <button class="menu-tab-btn" data-tab="learn">[39m
[31m+                 <span class="icon">ðŸŽ“</span> Lernen[39m
[31m+               </button>[39m
[31m+               <button class="menu-tab-btn" data-tab="settings">[39m
[31m+                 <span class="icon">âš™ï¸</span> Einstellungen[39m
[31m+               </button>[39m
[31m+               <button class="menu-tab-btn" data-tab="credits">[39m
[31m+                 <span class="icon">â¤ï¸</span> Credits[39m
[31m+               </button>[39m
[31m+               <div style="flex: 1"></div>[39m
[31m+               <button id="resume-game-btn" class="menu-tab-btn hidden" style="color: #4ade80">[39m
[31m+                 <span class="icon">â–¶ï¸</span> Fortsetzen[39m
[31m+               </button>[39m
[31m+             </div>[39m
[31m+           </nav>[39m

[32m-             <!-- Content Area -->[39m
[32m-             <main class="menu-content-area">[39m
[32m-               <!-- Play View -->[39m
[32m-               <div id="view-play" class="menu-view active">[39m
[32m-                 <h2 class="section-title">Neues Spiel</h2>[39m
[32m-                 <p class="section-subtitle">WÃ¤hle deinen Modus und beginne das Abenteuer.</p>[39m
[31m+           <!-- Content Area -->[39m
[31m+           <main class="menu-content-area">[39m
[31m+             <!-- Play View -->[39m
[31m+             <div id="view-play" class="menu-view active">[39m
[31m+               <h2 class="section-title">Neues Spiel</h2>[39m
[31m+               <p class="section-subtitle">WÃ¤hle deinen Modus und beginne das Abenteuer.</p>[39m

[32m-                 <div class="gamemode-grid">[39m
[32m-                   <!-- Continue Last Game (New) -->[39m
[32m-                   <div class="gamemode-card hidden" id="main-menu-continue-btn">[39m
[32m-                     <div class="card-icon">ðŸ“‚</div>[39m
[32m-                     <div class="card-title">Fortsetzen</div>[39m
[32m-                     <div class="card-desc">Setze dein zuletzt gespeichertes Spiel fort.</div>[39m
[32m-                   </div>[39m
[31m+               <div class="gamemode-grid">[39m
[31m+                 <!-- Continue Last Game (New) -->[39m
[31m+                 <div class="gamemode-card hidden" id="main-menu-continue-btn">[39m
[31m+                   <div class="card-icon">ðŸ“‚</div>[39m
[31m+                   <div class="card-title">Fortsetzen</div>[39m
[31m+                   <div class="card-desc">Setze dein zuletzt gespeichertes Spiel fort.</div>[39m
[31m+                 </div>[39m

[32m-                   <!-- Campaign -->[39m
[32m-                   <div class="gamemode-card" id="campaign-start-btn">[39m
[32m-                     <span class="card-tag tag-new">Neu</span>[39m
[32m-                     <div class="card-icon">âš”ï¸</div>[39m
[32m-                     <div class="card-title">Kampagne</div>[39m
[32m-                     <div class="card-desc">[39m
[32m-                       Erlebe eine epische Geschichte und kÃ¤mpfe gegen immer stÃ¤rkere Gegner.[39m
[32m-                     </div>[39m
[31m+                 <!-- Campaign -->[39m
[31m+                 <div class="gamemode-card" id="campaign-start-btn">[39m
[31m+                   <span class="card-tag tag-new">Neu</span>[39m
[31m+                   <div class="card-icon">âš”ï¸</div>[39m
[31m+                   <div class="card-title">Kampagne</div>[39m
[31m+                   <div class="card-desc">[39m
[31m+                     Erlebe eine epische Geschichte und kÃ¤mpfe gegen immer stÃ¤rkere Gegner.[39m
[2m                    </div>[22m
[31m+                 </div>[39m

[32m-                   <!-- 9x9 Classic -->[39m
[32m-                   <div class="gamemode-card" data-mode="classic" onclick="window.app.init(0, 'classic'); document.getElementById('main-menu').classList.remove('active');">[39m
[32m-                     <div class="card-icon">ðŸ°</div>[39m
[32m-                     <div class="card-title">Klassisch 9x9</div>[39m
[32m-                     <div class="card-desc">[39m
[32m-                       Das volle Erlebnis mit Erzbischof, Kanzler und 3 Korridoren.[39m
[32m-                     </div>[39m
[31m+                 <!-- 9x9 Classic -->[39m
[31m+                 <div class="gamemode-card" data-mode="classic" onclick="window.app.init(0, 'classic'); document.getElementById('main-menu').classList.remove('active');">[39m
[31m+                   <div class="card-icon">ðŸ°</div>[39m
[31m+                   <div class="card-title">Klassisch 9x9</div>[39m
[31m+                   <div class="card-desc">[39m
[31m+                     Das volle Erlebnis mit Erzbischof, Kanzler und 3 Korridoren.[39m
[2m                    </div>[22m
[31m+                 </div>[39m

[32m-                   <!-- Truppen anheuern aka Upgrade Mode 9x9 -->[39m
[32m-                   <div class="gamemode-card" data-mode="setup" onclick="window.app.init(25, 'setup'); document.getElementById('main-menu').classList.remove('active');">[39m
[32m-                     <div class="card-icon">ðŸ’°</div>[39m
[32m-                     <div class="card-title">Truppen anheuern (9x9)</div>[39m
[32m-                     <div class="card-desc">[39m
[32m-                       Stelle deine eigene 9x9 Armee mit 25 Punkten zusammen.[39m
[32m-                     </div>[39m
[31m+                 <!-- Truppen anheuern aka Upgrade Mode 9x9 -->[39m
[31m+                 <div class="gamemode-card" data-mode="setup" onclick="window.app.init(25, 'setup'); document.getElementById('main-menu').classList.remove('active');">[39m
[31m+                   <div class="card-icon">ðŸ’°</div>[39m
[31m+                   <div class="card-title">Truppen anheuern (9x9)</div>[39m
[31m+                   <div class="card-desc">[39m
[31m+                     Stelle deine eigene 9x9 Armee mit 25 Punkten zusammen.[39m
[2m                    </div>[22m
[31m+                 </div>[39m

[32m-                   <!-- 9x9 Classic Upgrade -->[39m
[32m-                   <div class="gamemode-card" data-mode="upgrade" onclick="window.app.init(25, 'upgrade'); document.getElementById('main-menu').classList.remove('active');">[39m
[32m-                     <span class="card-tag tag-hot">Neu</span>[39m
[32m-                     <div class="card-icon">ðŸ‘‘</div>[39m
[32m-                     <div class="card-title">Klassisch 9x9 + Upgrades</div>[39m
[32m-                     <div class="card-desc">[39m
[32m-                       Starte mit dem klassichen Layout und 25 Punkten fÃ¼r Truppen-Verbesserungen.[39m
[32m-                     </div>[39m
[31m+                 <!-- 9x9 Classic Upgrade -->[39m
[31m+                 <div class="gamemode-card" data-mode="upgrade" onclick="window.app.init(25, 'upgrade'); document.getElementById('main-menu').classList.remove('active');">[39m
[31m+                   <span class="card-tag tag-hot">Neu</span>[39m
[31m+                   <div class="card-icon">ðŸ‘‘</div>[39m
[31m+                   <div class="card-title">Klassisch 9x9 + Upgrades</div>[39m
[31m+                   <div class="card-desc">[39m
[31m+                     Starte mit dem klassichen Layout und 25 Punkten fÃ¼r Truppen-Verbesserungen.[39m
[2m                    </div>[22m
[31m+                 </div>[39m

[32m-                   <!-- 8x8 Upgrades -->[39m
[32m-                   <div class="gamemode-card" onclick="window.app.init(15, 'upgrade8x8'); document.getElementById('main-menu').classList.remove('active');">[39m
[32m-                     <span class="card-tag tag-hot">Beliebt</span>[39m
[32m-                     <div class="card-icon">ðŸ’Ž</div>[39m
[32m-                     <div class="card-title">8x8 + Upgrades</div>[39m
[32m-                     <div class="card-desc">[39m
[32m-                       Starte mit 15 Punkten auf einem Standard-Brett und verbessere deine Armee.[39m
[32m-                     </div>[39m
[31m+                 <!-- 8x8 Upgrades -->[39m
[31m+                 <div class="gamemode-card" onclick="window.app.init(15, 'upgrade8x8'); document.getElementById('main-menu').classList.remove('active');">[39m
[31m+                   <span class="card-tag tag-hot">Beliebt</span>[39m
[31m+                   <div class="card-icon">ðŸ’Ž</div>[39m
[31m+                   <div class="card-title">8x8 + Upgrades</div>[39m
[31m+                   <div class="card-desc">[39m
[31m+                     Starte mit 15 Punkten auf einem Standard-Brett und verbessere deine Armee.[39m
[2m                    </div>[22m
[31m+                 </div>[39m

[32m-                   <!-- 8x8 Standard -->[39m
[32m-                   <div class="gamemode-card" data-mode="standard8x8" onclick="window.app.init(0, 'standard8x8'); document.getElementById('main-menu').classList.remove('active');">[39m
[32m-                     <div class="card-icon">â™Ÿï¸</div>[39m
[32m-                     <div class="card-title">Standard 8x8</div>[39m
[32m-                     <div class="card-desc">Klassisches Schachbrett, aber mit 9x9 Regeln.</div>[39m
[32m-                   </div>[39m
[31m+                 <!-- 8x8 Standard -->[39m
[31m+                 <div class="gamemode-card" data-mode="standard8x8" onclick="window.app.init(0, 'standard8x8'); document.getElementById('main-menu').classList.remove('active');">[39m
[31m+                   <div class="card-icon">â™Ÿï¸</div>[39m
[31m+                   <div class="card-title">Standard 8x8</div>[39m
[31m+                   <div class="card-desc">Klassisches Schachbrett, aber mit 9x9 Regeln.</div>[39m
[31m+                 </div>[39m

[32m-                   <!-- Puzzle -->[39m
[32m-                   <div class="gamemode-card" data-mode="puzzle" onclick="window.app.init(0, 'puzzle'); document.getElementById('main-menu').classList.remove('active');">[39m
[32m-                     <span class="card-tag tag-pro">Training</span>[39m
[32m-                     <div class="card-icon">ðŸ§©</div>[39m
[32m-                     <div class="card-title">Puzzle-Modus</div>[39m
[32m-                     <div class="card-desc">LÃ¶se taktische Aufgaben und verbessere dein Spiel.</div>[39m
[32m-                   </div>[39m
[31m+                 <!-- Puzzle -->[39m
[31m+                 <div class="gamemode-card" data-mode="puzzle" onclick="window.app.init(0, 'puzzle'); document.getElementById('main-menu').classList.remove('active');">[39m
[31m+                   <span class="card-tag tag-pro">Training</span>[39m
[31m+                   <div class="card-icon">ðŸ§©</div>[39m
[31m+                   <div class="card-title">Puzzle-Modus</div>[39m
[31m+                   <div class="card-desc">LÃ¶se taktische Aufgaben und verbessere dein Spiel.</div>[39m
[2m                  </div>[22m
[2m                </div>[22m
[31m+             </div>[39m

[32m-               <!-- Learn View -->[39m
[32m-               <div id="view-learn" class="menu-view">[39m
[32m-                 <h2 class="section-title">Lernen &amp; Regeln</h2>[39m
[32m-                 <div class="gamemode-grid">[39m
[32m-                   <div class="gamemode-card" id="start-tutorial-btn">[39m
[32m-                     <div class="card-icon">ðŸŽ“</div>[39m
[32m-                     <div class="card-title">Interaktives Tutorial</div>[39m
[32m-                     <div class="card-desc">[39m
[32m-                       Lerne die Regeln, Figuren und Special Moves in einer gefÃ¼hrten Tour.[39m
[32m-                     </div>[39m
[31m+             <!-- Learn View -->[39m
[31m+             <div id="view-learn" class="menu-view">[39m
[31m+               <h2 class="section-title">Lernen &amp; Regeln</h2>[39m
[31m+               <div class="gamemode-grid">[39m
[31m+                 <div class="gamemode-card" id="start-tutorial-btn">[39m
[31m+                   <div class="card-icon">ðŸŽ“</div>[39m
[31m+                   <div class="card-title">Interaktives Tutorial</div>[39m
[31m+                   <div class="card-desc">[39m
[31m+                     Lerne die Regeln, Figuren und Special Moves in einer gefÃ¼hrten Tour.[39m
[2m                    </div>[22m
[2m                  </div>[22m
[2m                </div>[22m
[31m+             </div>[39m

[32m-               <!-- Settings View -->[39m
[32m-               <div id="view-settings" class="menu-view">[39m
[32m-                 <h2 class="section-title">Einstellungen</h2>[39m
[32m-                 <div class="settings-grid">[39m
[32m-                   <div class="setting-group">[39m
[32m-                     <h3>Darstellung</h3>[39m
[32m-                     <div class="setting-row">[39m
[32m-                       <label>Brett-Design</label>[39m
[32m-                       <select id="theme-select" class="menu-select">[39m
[32m-                         <option value="classic">Klassisch</option>[39m
[32m-                         <option value="blue">Blau</option>[39m
[32m-                         <option value="green">GrÃ¼n</option>[39m
[32m-                         <option value="dark">Dunkel</option>[39m
[32m-                         <option value="wood">Holz</option>[39m
[32m-                       </select>[39m
[32m-                     </div>[39m
[32m-                     <div class="setting-row" style="margin-top: 10px">[39m
[32m-                       <label>Figuren-Skin</label>[39m
[32m-                       <select id="skin-selector-menu" class="menu-select" onchange="document.getElementById('skin-selector').value = this.value; document.getElementById('skin-selector').dispatchEvent(new Event('change'));">[39m
[32m-                         <option value="classic">Klassisch</option>[39m
[32m-                         <option value="modern">Modern</option>[39m
[32m-                         <option value="pixel">Pixel</option>[39m
[32m-                         <option value="infernale">Infernale</option>[39m
[32m-                         <option value="wood">Holz</option>[39m
[32m-                         <option value="neon">Neon</option>[39m
[32m-                         <option value="minimalist">Minimalistisch</option>[39m
[32m-                       </select>[39m
[32m-                     </div>[39m
[31m+             <!-- Settings View -->[39m
[31m+             <div id="view-settings" class="menu-view">[39m
[31m+               <h2 class="section-title">Einstellungen</h2>[39m
[31m+               <div class="settings-grid">[39m
[31m+                 <div class="setting-group">[39m
[31m+                   <h3>Darstellung</h3>[39m
[31m+                   <div class="setting-row">[39m
[31m+                     <label>Brett-Design</label>[39m
[31m+                     <select id="theme-select" class="menu-select">[39m
[31m+                       <option value="classic">Klassisch</option>[39m
[31m+                       <option value="blue">Blau</option>[39m
[31m+                       <option value="green">GrÃ¼n</option>[39m
[31m+                       <option value="dark">Dunkel</option>[39m
[31m+                       <option value="wood">Holz</option>[39m
[31m+                     </select>[39m
[31m+                   </div>[39m
[31m+                   <div class="setting-row" style="margin-top: 10px">[39m
[31m+                     <label>Figuren-Skin</label>[39m
[31m+                     <select id="skin-selector-menu" class="menu-select" onchange="document.getElementById('skin-selector').value = this.value; document.getElementById('skin-selector').dispatchEvent(new Event('change'));">[39m
[31m+                       <option value="classic">Klassisch</option>[39m
[31m+                       <option value="modern">Modern</option>[39m
[31m+                       <option value="pixel">Pixel</option>[39m
[31m+                       <option value="infernale">Infernale</option>[39m
[31m+                       <option value="wood">Holz</option>[39m
[31m+                       <option value="neon">Neon</option>[39m
[31m+                       <option value="minimalist">Minimalistisch</option>[39m
[31m+                     </select>[39m
[2m                    </div>[22m
[31m+                 </div>[39m

[32m-                   <div class="setting-group">[39m
[32m-                     <h3>Spiel &amp; Sound</h3>[39m
[32m-                     <div class="setting-row">[39m
[32m-                       <label>Sound</label>[39m
[32m-                       <div class="volume-control">[39m
[32m-                         <label class="toggle-switch">[39m
[32m-                           <input type="checkbox" id="sound-toggle" checked="">[39m
[32m-                           <span class="toggle-slider"></span>[39m
[32m-                         </label>[39m
[32m-                       </div>[39m
[31m+                 <div class="setting-group">[39m
[31m+                   <h3>Spiel &amp; Sound</h3>[39m
[31m+                   <div class="setting-row">[39m
[31m+                     <label>Sound</label>[39m
[31m+                     <div class="volume-control">[39m
[31m+                       <label class="toggle-switch">[39m
[31m+                         <input type="checkbox" id="sound-toggle" checked="">[39m
[31m+                         <span class="toggle-slider"></span>[39m
[31m+                       </label>[39m
[2m                      </div>[22m
[32m-                     <div class="setting-row" style="margin-top: 10px">[39m
[32m-                       <label>LautstÃ¤rke</label>[39m
[32m-                       <input type="range" id="volume-slider" min="0" max="100" value="30" class="volume-slider">[39m
[32m-                     </div>[39m
[32m-                     <div class="setting-row" style="margin-top: 10px">[39m
[32m-                       <label>Schwierigkeit</label>[39m
[32m-                       <select id="difficulty-select" class="menu-select">[39m
[32m-                         <option value="beginner">AnfÃ¤nger</option>[39m
[32m-                         <option value="easy">Einfach</option>[39m
[32m-                         <option value="medium">Mittel</option>[39m
[32m-                         <option value="hard">Schwer</option>[39m
[32m-                         <option value="expert">Experte</option>[39m
[32m-                       </select>[39m
[32m-                     </div>[39m
[31m+                   </div>[39m
[31m+                   <div class="setting-row" style="margin-top: 10px">[39m
[31m+                     <label>LautstÃ¤rke</label>[39m
[31m+                     <input type="range" id="volume-slider" min="0" max="100" value="30" class="volume-slider">[39m
[31m+                   </div>[39m
[31m+                   <div class="setting-row" style="margin-top: 10px">[39m
[31m+                     <label>Schwierigkeit</label>[39m
[31m+                     <select id="difficulty-select" class="menu-select">[39m
[31m+                       <option value="beginner">AnfÃ¤nger</option>[39m
[31m+                       <option value="easy">Einfach</option>[39m
[31m+                       <option value="medium">Mittel</option>[39m
[31m+                       <option value="hard">Schwer</option>[39m
[31m+                       <option value="expert">Experte</option>[39m
[31m+                     </select>[39m
[2m                    </div>[22m
[31m+                 </div>[39m

[32m-                   <div class="setting-group">[39m
[32m-                     <h3>KI &amp; Hilfe</h3>[39m
[32m-                     <div class="setting-row">[39m
[32m-                       <label>KI-PersÃ¶nlichkeit</label>[39m
[32m-                       <select id="ai-personality-select" class="menu-select">[39m
[32m-                         <option value="balanced">âš–ï¸ Ausgeglichen</option>[39m
[32m-                         <option value="aggressive">âš”ï¸ Aggressiv</option>[39m
[32m-                         <option value="defensive">ðŸ›¡ï¸ Defensiv</option>[39m
[32m-                         <option value="positional">â™Ÿï¸ Positionell</option>[39m
[32m-                       </select>[39m
[32m-                     </div>[39m
[32m-                     <div class="setting-row" style="margin-top: 10px">[39m
[32m-                       <label>KI-Mentor</label>[39m
[32m-                       <select id="ki-mentor-level-select" class="menu-select">[39m
[32m-                         <option value="OFF">Aus</option>[39m
[32m-                         <option value="STANDARD" selected="">Standard (Nur Patzer)</option>[39m
[32m-                         <option value="STRICT">Streng (Auch Fehler)</option>[39m
[32m-                       </select>[39m
[32m-                     </div>[39m
[31m+                 <div class="setting-group">[39m
[31m+                   <h3>KI &amp; Hilfe</h3>[39m
[31m+                   <div class="setting-row">[39m
[31m+                     <label>KI-PersÃ¶nlichkeit</label>[39m
[31m+                     <select id="ai-personality-select" class="menu-select">[39m
[31m+                       <option value="balanced">âš–ï¸ Ausgeglichen</option>[39m
[31m+                       <option value="aggressive">âš”ï¸ Aggressiv</option>[39m
[31m+                       <option value="defensive">ðŸ›¡ï¸ Defensiv</option>[39m
[31m+                       <option value="positional">â™Ÿï¸ Positionell</option>[39m
[31m+                     </select>[39m
[31m+                   </div>[39m
[31m+                   <div class="setting-row" style="margin-top: 10px">[39m
[31m+                     <label>KI-Mentor</label>[39m
[31m+                     <select id="ki-mentor-level-select" class="menu-select">[39m
[31m+                       <option value="OFF">Aus</option>[39m
[31m+                       <option value="STANDARD" selected="">Standard (Nur Patzer)</option>[39m
[31m+                       <option value="STRICT">Streng (Auch Fehler)</option>[39m
[31m+                     </select>[39m
[2m                    </div>[22m
[2m                  </div>[22m
[2m                </div>[22m
[31m+             </div>[39m

[32m-               <!-- Credits View -->[39m
[32m-               <div id="view-credits" class="menu-view">[39m
[32m-                 <h2 class="section-title">Credits</h2>[39m
[32m-                 <p>Entwickelt mit â¤ï¸ vom Google Deepmind Team</p>[39m
[32m-               </div>[39m
[32m-             </main>[39m
[32m-           </div>[39m
[31m+             <!-- Credits View -->[39m
[31m+             <div id="view-credits" class="menu-view">[39m
[31m+               <h2 class="section-title">Credits</h2>[39m
[31m+               <p>Entwickelt mit â¤ï¸ vom Google Deepmind Team</p>[39m
[31m+             </div>[39m
[31m+           </main>[39m
[2m          </div>[22m
[32m-[39m
[32m-         <!-- Hidden elements for compatibility if needed -->[39m
[32m-         <div id="controls-wrapper" class="hidden"></div>[39m
[32m-         <div id="quick-actions" class="hidden"></div>[39m
[32m-         <div id="info-tabs-container" class="hidden"></div>[39m
[2m        </div>[22m

[32m-       <script type="module" src="js/debug.ts"></script>[39m
[32m-       <script type="module" src="js/main.ts"></script>[39m
[31m+       <!-- Hidden elements for compatibility if needed -->[39m
[31m+       <div id="controls-wrapper" class="hidden"></div>[39m
[31m+       <div id="quick-actions" class="hidden"></div>[39m
[31m+       <div id="info-tabs-container" class="hidden"></div>[39m
[2m      </div>[22m
[32m-   [39m
[31m+[39m
[31m+     <script type="module" src="js/debug.ts"></script>[39m
[31m+     <script type="module" src="js/main.ts"></script>[39m
[31m+   </div>[39m
[31m+[39m

[2m  "[22m

[36m [2mâ¯[22m tests/snapshots.test.js:[2m34:33[22m[39m
    [90m 32| [39m    [35mconst[39m container [33m=[39m document[33m.[39mbody[33m;[39m
    [90m 33| [39m    // Clean up some dynamic things like timestamps if necessary, but â€¦
    [90m 34| [39m    [34mexpect[39m(container[33m.[39minnerHTML)[33m.[39m[34mtoMatchSnapshot[39m()[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m 35| [39m  })[33m;[39m
    [90m 36| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/8]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m tests/snapshots.test.js[2m > [22mVisual DOM Snapshot Tests[2m > [22mGame over overlay snapshot
[31m[1mError[22m: Snapshot `Visual DOM Snapshot Tests > Game over overlay snapshot 1` mismatched[39m

[32m- Expected[39m
[31m+ Received[39m

[2m  "[22m
[32m-           [7m  [27m<div class="modal-content">[39m
[31m+           <div class="modal-content">[39m
[32m- [7m  [27m            <h2 id="winner-text">WeiÃŸ gewinnt!</h2>[39m
[31m+             <h2 id="winner-text">WeiÃŸ gewinnt!</h2>[39m
[32m- [7m  [27m            <button id="restart-btn-overlay" class="btn-primary">Neues Spiel</button>[39m
[31m+             <button id="restart-btn-overlay" class="btn-primary">Neues Spiel</button>[39m
[32m-             [7m [27m[7m [27m<button id="close-game-over-btn" class="btn-secondary">SchlieÃŸen</button>[39m
[31m+             <button id="close-game-over-btn" class="btn-secondary">SchlieÃŸen</button>[39m
[32m-           [7m [27m[7m [27m</div>[39m
[31m+           </div>[39m
[32m- [7m  [27m        "[39m
[31m+         "[39m

[36m [2mâ¯[22m tests/snapshots.test.js:[2m59:31[22m[39m
    [90m 57| [39m    overlay[33m.[39mclassList[33m.[39m[34mremove[39m([32m'hidden'[39m)[33m;[39m
    [90m 58| [39m
    [90m 59| [39m    [34mexpect[39m(overlay[33m.[39minnerHTML)[33m.[39m[34mtoMatchSnapshot[39m()[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m 60| [39m  })[33m;[39m
    [90m 61| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/8]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m tests/snapshots.test.js[2m > [22mVisual DOM Snapshot Tests[2m > [22mShop panel snapshot
[31m[1mError[22m: Snapshot `Visual DOM Snapshot Tests > Shop panel snapshot 1` mismatched[39m

[32m- Expected[39m
[31m+ Received[39m

[2m  "[22m
[32m-           [7m  [27m<div class="shop-header">[39m
[31m+           <div class="shop-header">[39m
[32m-             [7m [27m[7m [27m<h2>Truppen anheuern</h2>[39m
[31m+             <h2>Truppen anheuern</h2>[39m
[32m-             [7m  [27m<div class="shop-points">[39m
[31m+             <div class="shop-points">[39m
[32m- [7m  [27m              <span id="points-display" data-testid="points-display">15</span> Pkt[39m
[31m+               <span id="points-display" data-testid="points-display">15</span> Pkt[39m
[32m-             [7m  [27m</div>[39m
[31m+             </div>[39m
[32m- [7m  [27m          </div>[39m
[31m+           </div>[39m

[32m- [7m  [27m          <!-- Tutor Recommendations Section -->[39m
[31m+           <!-- Tutor Recommendations Section -->[39m
[32m-           [7m [27m[7m [27m<div id="tutor-recommendations-section" class="tutor-recommendations-section">[39m
[31m+           <div id="tutor-recommendations-section" class="tutor-recommendations-section">[39m
[32m- [7m  [27m            <button id="toggle-tutor-recommendations" class="btn-secondary full-width" style="padding: 8px; font-size: 0.9rem; margin-bottom: 1rem">[39m
[31m+             <button id="toggle-tutor-recommendations" class="btn-secondary full-width" style="padding: 8px; font-size: 0.9rem; margin-bottom: 1rem">[39m
[32m-               [7m [27m[7m [27mðŸ’¡ KI-Vorlagen anzeigen[39m
[31m+               ðŸ’¡ KI-Vorlagen anzeigen[39m
[32m-             [7m [27m[7m [27m</button>[39m
[31m+             </button>[39m
[32m-             [7m  [27m<div id="tutor-recommendations-container" class="tutor-recommendations-container hidden">[39m
[31m+             <div id="tutor-recommendations-container" class="tutor-recommendations-container hidden">[39m
[32m- [7m  [27m              <!-- Templates will be injected here by JavaScript -->[39m
[31m+               <!-- Templates will be injected here by JavaScript -->[39m
[32m- [7m  [27m            </div>[39m
[31m+             </div>[39m
[32m-           [7m [27m[7m [27m</div>[39m
[31m+           </div>[39m

[32m- [7m  [27m          <div id="shop-buttons" class="shop-grid">[39m
[31m+           <div id="shop-buttons" class="shop-grid">[39m
[32m-             [7m [27m[7m [27m<button class="shop-item" data-piece="p" data-cost="1" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="p" data-cost="1" style="opacity: 1; pointer-events: auto;">[39m
[32m-               [7m [27m[7m [27m<div class="shop-icon">â™Ÿï¸</div>[39m
[31m+               <div class="shop-icon">â™Ÿï¸</div>[39m
[32m-               [7m  [27m<div class="shop-cost">1</div>[39m
[31m+               <div class="shop-cost">1</div>[39m
[32m- [7m  [27m            </button>[39m
[31m+             </button>[39m
[32m- [7m  [27m            <button class="shop-item" data-piece="n" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="n" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[32m-               [7m  [27m<div class="shop-icon">â™ž</div>[39m
[31m+               <div class="shop-icon">â™ž</div>[39m
[32m- [7m  [27m              <div class="shop-cost">3</div>[39m
[31m+               <div class="shop-cost">3</div>[39m
[32m-             [7m [27m[7m [27m</button>[39m
[31m+             </button>[39m
[32m-             [7m [27m[7m [27m<button class="shop-item" data-piece="b" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="b" data-cost="3" style="opacity: 1; pointer-events: auto;">[39m
[32m-               [7m  [27m<div class="shop-icon">â™</div>[39m
[31m+               <div class="shop-icon">â™</div>[39m
[32m- [7m  [27m              <div class="shop-cost">3</div>[39m
[31m+               <div class="shop-cost">3</div>[39m
[32m- [7m  [27m            </button>[39m
[31m+             </button>[39m
[32m-             [7m [27m[7m [27m<button class="shop-item" data-piece="r" data-cost="5" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="r" data-cost="5" style="opacity: 1; pointer-events: auto;">[39m
[32m- [7m  [27m              <div class="shop-icon">â™œ</div>[39m
[31m+               <div class="shop-icon">â™œ</div>[39m
[32m-               [7m [27m[7m [27m<div class="shop-cost">5</div>[39m
[31m+               <div class="shop-cost">5</div>[39m
[32m-             [7m [27m[7m [27m</button>[39m
[31m+             </button>[39m
[32m-             [7m  [27m<button class="shop-item" data-piece="j" data-cost="6" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="j" data-cost="6" style="opacity: 1; pointer-events: auto;">[39m
[32m- [7m  [27m              <div class="shop-icon">ðŸ¦„</div>[39m
[31m+               <div class="shop-icon">ðŸ¦„</div>[39m
[32m- [7m  [27m              <div class="shop-cost">6</div>[39m
[31m+               <div class="shop-cost">6</div>[39m
[32m-             [7m  [27m</button>[39m
[31m+             </button>[39m
[32m- [7m  [27m            <button class="shop-item" data-piece="a" data-cost="7" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="a" data-cost="7" style="opacity: 1; pointer-events: auto;">[39m
[32m-               [7m [27m[7m [27m<div class="shop-icon">ðŸ°</div>[39m
[31m+               <div class="shop-icon">ðŸ°</div>[39m
[32m-               [7m [27m[7m [27m<div class="shop-cost">7</div>[39m
[31m+               <div class="shop-cost">7</div>[39m
[32m-             [7m  [27m</button>[39m
[31m+             </button>[39m
[32m- [7m  [27m            <button class="shop-item" data-piece="c" data-cost="8" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="c" data-cost="8" style="opacity: 1; pointer-events: auto;">[39m
[32m- [7m  [27m              <div class="shop-icon">âš–ï¸</div>[39m
[31m+               <div class="shop-icon">âš–ï¸</div>[39m
[32m-               [7m  [27m<div class="shop-cost">8</div>[39m
[31m+               <div class="shop-cost">8</div>[39m
[32m- [7m  [27m            </button>[39m
[31m+             </button>[39m
[32m-             [7m [27m[7m [27m<button class="shop-item" data-piece="q" data-cost="9" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="q" data-cost="9" style="opacity: 1; pointer-events: auto;">[39m
[32m-               [7m [27m[7m [27m<div class="shop-icon">â™›</div>[39m
[31m+               <div class="shop-icon">â™›</div>[39m
[32m-               [7m  [27m<div class="shop-cost">9</div>[39m
[31m+               <div class="shop-cost">9</div>[39m
[32m- [7m  [27m            </button>[39m
[31m+             </button>[39m
[32m- [7m  [27m            <button class="shop-item" data-piece="e" data-cost="12" style="opacity: 1; pointer-events: auto;">[39m
[31m+             <button class="shop-item" data-piece="e" data-cost="12" style="opacity: 1; pointer-events: auto;">[39m
[32m-               [7m  [27m<div class="shop-icon">ðŸ‘¼</div>[39m
[31m+               <div class="shop-icon">ðŸ‘¼</div>[39m
[32m- [7m  [27m              <div class="shop-cost">12</div>[39m
[31m+               <div class="shop-cost">12</div>[39m
[32m-             [7m [27m[7m [27m</button>[39m
[31m+             </button>[39m
[32m-           [7m [27m[7m [27m</div>[39m
[31m+           </div>[39m
[32m-           [7m  [27m<div id="selected-piece-display" class="shop-status">WÃ¤hle eine Figur zum Kaufen</div>[39m
[31m+           <div id="selected-piece-display" class="shop-status">WÃ¤hle eine Figur zum Kaufen</div>[39m

[32m- [7m  [27m          <button id="finish-setup-btn" class="btn-primary full-width">Fertig</button>[39m
[31m+           <button id="finish-setup-btn" class="btn-primary full-width">Fertig</button>[39m
[32m- [7m  [27m        "[39m
[31m+         "[39m

[36m [2mâ¯[22m tests/snapshots.test.js:[2m68:28[22m[39m
    [90m 66| [39m
    [90m 67| [39m    [35mconst[39m shop [33m=[39m document[33m.[39m[34mgetElementById[39m([32m'shop-panel'[39m)[33m;[39m
    [90m 68| [39m    [34mexpect[39m(shop[33m.[39minnerHTML)[33m.[39m[34mtoMatchSnapshot[39m()[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 69| [39m  })[33m;[39m
    [90m 70| [39m})[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/8]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m tests/ai/AIController_coverage.test.ts[2m > [22mAIController Coverage Boost[2m > [22maiMove - handles successful worker results
[31m[1mError[22m: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".[39m
[36m [2mâ¯[22m tests/ai/AIController_coverage.test.ts:[2m199:3[22m[39m
    [90m197| [39m  })[33m;[39m
    [90m198| [39m
    [90m199| [39m  [34mtest[39m([32m'aiMove - handles successful worker results'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m200| [39m    controller[33m.[39m[34minitWorkerPool[39m()[33m;[39m
    [90m201| [39m    [35mconst[39m worker [33m=[39m controller[33m.[39maiWorkers[[34m0[39m] [35mas[39m any[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/8]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m tests/modes/campaignMode.test.ts[2m > [22mCampaignModeStrategy[2m > [22mstartLevel()[2m > [22mshould setup level_1 with fixed board
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m tests/modes/campaignMode.test.ts:[2m171:46[22m[39m
    [90m170| [39m    })[33m;[39m
    [90m171| [39m
    [90m172| [39m    [34mtest[39m([32m'should setup level_2 with fixed board'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m   | [39m                                            [31m^[39m
    [90m173| [39m      const { BoardFactory } = await import('../../js/campaign/BoardFaâ€¦
    [90m174| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/8]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m tests/modes/campaignMode.test.ts[2m > [22mCampaignModeStrategy[2m > [22mstartLevel()[2m > [22mshould setup level_2 with fixed board
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m tests/modes/campaignMode.test.ts:[2m184:46[22m[39m
    [90m182| [39m    })[33m;[39m
    [90m183| [39m
    [90m184| [39m    [34mtest[39m([32m'should setup budget level with setup phase'[39m[33m,[39m () [33m=>[39m {
    [90m   | [39m                                             [31m^[39m
    [90m185| [39m      strategy[33m.[39m[34mstartLevel[39m(mockGame[33m,[39m mockController[33m,[39m [32m'level_budget'[39m)[33m;[39m
    [90m186| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/8]âŽ¯[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Unhandled Errors [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m
[31m[1m
Vitest caught 1 unhandled error during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Unhandled Error [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m
[31m[1mError[22m: [vitest-pool]: Worker forks emitted error.[39m
[90m [2mâ¯[22m EventEmitter.<anonymous> node_modules/vitest/dist/chunks/cli-api.Cx2DW4Bc.js:[2m8043:22[22m[39m
[90m [2mâ¯[22m EventEmitter.emit node:events:[2m508:28[22m[39m
[90m [2mâ¯[22m ChildProcess.emitUnexpectedExit node_modules/vitest/dist/chunks/cli-api.Cx2DW4Bc.js:[2m7610:22[22m[39m
[90m [2mâ¯[22m ChildProcess.emit node:events:[2m508:28[22m[39m
[90m [2mâ¯[22m Process.ChildProcess._handle.onexit node:internal/child_process:[2m294:12[22m[39m

[31m[1mCaused by: Error[22m: Worker exited unexpectedly[39m
[90m [2mâ¯[22m ChildProcess.emitUnexpectedExit node_modules/vitest/dist/chunks/cli-api.Cx2DW4Bc.js:[2m7609:33[22m[39m
[90m [2mâ¯[22m ChildProcess.emit node:events:[2m508:28[22m[39m
[90m [2mâ¯[22m Process.ChildProcess._handle.onexit node:internal/child_process:[2m294:12[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m


[2m  Snapshots [22m [1m[31m3 failed[39m[22m
[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m119 passed[39m[22m[90m (123)[39m
[2m      Tests [22m [1m[31m8 failed[39m[22m[2m | [22m[1m[32m1252 passed[39m[22m[90m (1271)[39m
[2m     Errors [22m [1m[31m1 error[39m[22m
[2m   Start at [22m 18:59:33
[2m   Duration [22m 61.99s[2m (transform 4.88s, setup 2.24s, import 10.61s, tests 35.17s, environment 126.17s)[22m

[vitest-pool]: Timeout terminating forks worker for test files /home/tobber/.gemini/antigravity/scratch/schach/tests/ai/AIController_coverage.test.ts.
